<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Manual Conversores Novo Modelo</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="../../css/w3.css">
		<style>
			body,h1,h2,h3,h4,h5 {font-family: "Verdana", sans-serif}
			.w3-third img{margin-bottom: -6px; opacity: 0.8; cursor: pointer}
			.w3-third img:hover{opacity: 1}
		</style>
		<style>
			ol > li {
			counter-increment: item;
			}
			ol > li:first-child {
			counter-reset: item;
			}
			ol ol > li {
			display: block;
			}
			ol ol > li:before {
			content: counters(item, ".") ". ";
			margin-left: -20px;
			}
		</style>
	</head>
	<body class="w3-light-grey w3-content" style="max-width:1600px">

<!-- !PAGE CONTENT! -->
<div class="w3-main" style="margin-left:50px">
  <div class="w3-container w3-light-grey w3-padding-32 w3-padding-large" id="contact">
	<div class="w3-content" style="max-width:100%">
		<h2 class="w3-center" id="INTRO"><b>Protheus</b></h2>
		<br>
		<h4><b>Base de dados concorrente</b></h4>
			<p>Para essa conversão é necessário o backup completo do banco de dados no seguinte formato: arquivo ".bak" para bases SQL Server, tanto para versão mono empresa quanto para multi empresa.</p>
		<h4><b>Programas necessários</b></h4>
			<li>Strawberry Perl</li>
			<li>Microsoft Excel, versão 97/2003 ou superior</li>
			<li>Acesso à Internet</li>
			<li>Python 3.11 (64 bits)</li>
				<div class="w3-panel w3-pale-red w3-border">
				<span>&#9888; <b>IMPORTANTE:</b> É necessário que a máquina tenha acesso à internet, pois o Python faz o download de algumas bibliotecas na primeira vez em que é utilizado. A versão 3.9.5 do Python funciona somente no Windows 10 ou posterior.
				</div>
			<li>Microsoft SQL Server 2019 + SQL Management Studio
			<p>Com exceção do Microsoft Excel, todos os demais programas podem ser baixados no FTP:<br>/unidades/Pub/Conversores/[Conversor Thomson Reuters]/[Instaladores]</p>
		<h4><b>Treinamento</b></h4>
			<p>O treinamento está disponível no FTP (por enquanto, apenas o treinamento para versão Multi empresa):<br>/unidades/Pub/Conversores/[Conversor Thomson Reuters]/[ Treinamentos ]</p>
		<br>
		<h4><b>Conversão</b></h4>
			<ol>
				<li>Acessar a pasta "Dados_Concorrente" na raiz do conversor;</li>
				<ol>
					<li>Colar o arquivo de backup do concorrente nessa pasta(arquivo ".BAK");</li>
				</ol>
				<li>Executar o arquivo "Conversão.bat" na pasta raiz;</li>
				<ol>
					<li>Informe um número para controle do atendimento;</li>
				</ol>
				<li>Na lista de conversores, informe a opção “Protheus”, e pressione “Enter”;</li>
				<li>Informe a opção “1 - Gerar planilha de empresas”;</li>
				<li>Informe a opção “1” para exportar os dados (caso já tenha exportado, informe “2”);</li>
				<ol>
					<li>Caso a conexão automática com o SQL Server falhe, será solicitado informar manualmente o nome do servidor;</li>
						<li>Para identificar o nome do servidor você deve abrir o "Microsoft SQL Server Management Studio 18", instalado na máquina.
							Ao abrir o Management Studio, avaliar o campo "Nome do servidor" (geralmente é o nome da máquina) e insira na tela do conversor.
							<br/>
							<div><img src="..\..\images\2_conversores\alterdata_004.png" class="w3-border w3-padding"></div>
							<br/>
						</li>
					</ol>
				<li>Informe a opção “1” para restaurar o banco de dados (caso já tenha restaurado, informe “2”), o processo de restauração pode ser demorado caso o banco seja muito grande. Caso já exista um banco para essa conversão, será apresentado uma mensagem questionando se deseja substitui-lo;</li>
				<li>O conversor seguirá com a exportação, serão apresentadas algumas mensagens de verificações necessárias. Ao término de todo o processo tecle “Enter” para continuar.</li>
				<li>O conversor irá identificar qual o tipo de conversão será realizado, “Multi Empresa” ou “Mono Empresa”;</li>
				<ol>
					<li>Multi Empresa: a conversão seguirá sem necessidade de intervenção, acompanhe e siga as próximas etapas na tela do Conversor;</li>
					<li>Mono Empresa: para esse caso, no sistema concorrente não há divisão de “Empresas”, todos os registros da folha são referentes a uma única empresa e não existe vínculo via banco de dados. Será convertida apenas uma empresa com todos os dados do concorrente;</li>
					<ol>
						<li>Será exibida uma mensagem para que possa listar as empresas cadastradas no concorrente, informe a opção “1” para visualizar e gerar um arquivo TXT com os dados ou “2” caso já saiba o código da empresa a ser utilizado (caso tenha dúvidas em qual empresa utilizar, questione ao cliente);</li>
						<li>Informe o código da empresa e pressione “Enter”;</li>
					</ol>
				</ol>
				<li>Siga as instruções até que o processo seja finalizado;</li>
				<li>Após isso, avaliar a seção “Verificador” deste manual.</li>
			</ol>
			<br>
			<h4><b>Exclusão da base no SQL Server</b></h4>
			<p>Após a extração dos dados, poderá realizar a exclusão da base do SQL Server.</p>
			<p>Para excluir a base no SQL Server:</p>
			<ol>
				<li>No "Microsoft SQL Server Management Studio 18", acessar o menu lateral esquerdo, clicando no sinal de “+” da pasta “Databases”;</li>
				<li>Clicar com o botão direito do mouse na base “Protheus_+ número de controle informado no item 2.1” e selecionar a opção “Delete”;</li>
				<li>Na tela “Delete Object”, marcar as opções conforme imagem abaixo e clicar em OK;</li>
				<li>Aguarde até que o processo seja finalizado.</li>
			</ol>
			<div><img src="..\..\images\2_conversores\protheus_sqlserver_drop_database_1.png" class="w3-border w3-padding"></div>
			<div><img src="..\..\images\2_conversores\protheus_sqlserver_drop_database_2.png" class="w3-border w3-padding"></div>
	</div>
  </div>
<!-- End page content -->
</div>
