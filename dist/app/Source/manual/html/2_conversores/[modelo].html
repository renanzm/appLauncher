<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Manual Conversores Novo Modelo</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="../../css/w3.css">
		<style>
			body,h1,h2,h3,h4,h5 {font-family: "Verdana", sans-serif}
			.w3-third img{margin-bottom: -6px; opacity: 0.8; cursor: pointer}
			.w3-third img:hover{opacity: 1}
		</style>
		<style>
			ol > li {
			counter-increment: item;
			}
			ol > li:first-child {
			counter-reset: item;
			}
			ol ol > li {
			display: block;
			}
			ol ol > li:before {
			content: counters(item, ".") ". ";
			margin-left: -20px;
			}
		</style>
	</head>
	<body class="w3-light-grey w3-content" style="max-width:1600px">

<!-- !PAGE CONTENT! -->
<div class="w3-main" style="margin-left:50px">
  <div class="w3-container w3-light-grey w3-padding-32 w3-padding-large" id="contact">
	<div class="w3-content" style="max-width:100%">
		<h2 class="w3-center" id="INTRO"><b>Conversor ABC</b></h2>
		<br>
		<h4><b>Base de dados concorrente</b></h4>
			<!-- Se for somente texto, usar o texto do FTP. Se tiver utilitário, usar a segunda linha  -->
			<p>Para essa conversão é necessário o backup completo do banco de dados nos seguintes formatos: arquivo ".backup" para bases PostgreSQL ou arquivo ".bak" para bases SQL Server.</p>
			<p>Para esta conversão serão necessários os arquivos gerados pelo Utilitário disponibilizado no FTP: /unidades/Pub/Conversores/[Conversor Thomson Reuters]/[ Utilitarios ]</p>


		<h4><b>Programas necessários</b></h4>
			<!-- Os três primeiros abaixo, manter em todos os manuais -->
			<li>Strawberry Perl</li>
			<li>Microsoft Excel, versão 97/2003 ou superior</li>
			<li>Acesso à Internet</li>
			<li>Python 3.11 (64 bits)</li>
				<div class="w3-panel w3-pale-red w3-border">
				<span>&#9888; <b>IMPORTANTE:</b> É necessário que a máquina tenha acesso à internet, pois o Python faz o download de algumas bibliotecas na primeira vez em que é utilizado. A versão 3.9.5 do Python funciona somente no Windows 10 ou posterior.
				</div>
			<li>PostgreSQL 17.2</li>
				<div class="w3-panel w3-pale-red w3-border">
				<span>&#9888; <b>IMPORTANTE:</b> Após instalar o PostgreSQL, acessar a variável Path do Windows e confirmar se foi adicionado o caminho da pasta “bin” do Postgre. Caso não, deve-se adicionar manualmente, pois o Conversor faz a chamada do executável pela Path do Windows.</span>
				</div>
			<li>Microsoft SQL Server 2019 + SQL Management Studio
			<li>MySQL Community 5.7</li>			
			<li> <a href="../13_firebird/firebird.html">Firebird </a> </li>
			<li>Java 8.291</li>
			<li>Pervasive</li>
			
			<p>Com exceção do Microsoft Excel, todos os demais programas podem ser baixados no FTP:<br>/unidades/Pub/Conversores/[Conversor Thomson Reuters]/[Instaladores]</p>
			<div class="w3-panel w3-pale-red w3-border">
				<span>&#9888; <b>IMPORTANTE:</b> É necessário realizar o procedimento em uma Máquina Virtual(VM) onde recomendamos o Windows 7 de 32 bits.
			</div>

		<h4><b>Treinamento</b></h4>
			<p>O treinamento está disponível no FTP (por enquanto, apenas o treinamento para PostgreSQL):<br>/unidades/Pub/Conversores/[Conversor Thomson Reuters]/[ Treinamentos ]</p>
			<p>O treinamento para esse conversor ainda não está disponível.</p>
		<br>
		<h4><b>Conversão de base tipo PostgreSQL</b></h4>
			<p>O banco de dados do concorrente deve estar no formato “.backup”.<br>O programa pgAdmin III deve estar fechado durante a realização do processo.</p>
			<ol>
				<li>Alocar o backup do sistema concorrente dentro da pasta "Dados_Concorrente";</li>
				<li>Executar o arquivo "Conversao.bat" na pasta raiz;
					<ol>
						<li>Informe um número para controle do atendimento;</li>
					</ol>
				</li>
				<li>Na lista de conversores, informe a opção “Alterdata”, e pressione “Enter”;</li>
				<li>Informe a opção “1 - Gerar planilha de empresas”;</li>
				<li>Informe a opção “1” para realizar a exportação dos dados;</li>
					<ol>
						<li>Caso seja informado a opção “N”, é necessário que exista uma base já restaurada no pgAdmin com o nome “alterdata_000” (onde 000 é o número informado no item 2.1);</li>
					</ol>
				<li>Informe a opção “S” para realizar a restauração do backup Alterdata;</li>
				<li>Informe “1” caso deseje converter dados da Escrita (Clientes e Fornecedores);</li>
				<li>Informe “1” caso deseje converter dados da Contabilidade (Contas e Históricos);</li>
				<li>Informe “1” para conversão de base tipo “PostgreSQL”;</li>
				<li>Informe “1” para realizar a restauração do backup Alterdata;</li>
				<li>Na mensagem “Informe a porta que foi cadastrada no PostgreSQL”, informar a porta configurada no pgAdmin III, conforme imagem exemplo abaixo:</li>
				<div><img src="..\..\images\2_conversores\alterdata_001.png" class="w3-border w3-padding"></div>
					<br>
					<ol>
						<li>Caso já exista uma base de mesmo nome no pgAdmin, o conversor irá solicitar se você deseja apagar essa base e restaurar a base da conversão atual, conforme imagem abaixo:</li>
					</ol>
					<div><img src="..\..\images\2_conversores\alterdata_002.png" class="w3-border w3-padding"></div>
					<br>
				<li>O processo de restauração da base será iniciado no pgAdmin III, criando uma base com o nome “alterdata_000” (onde 000 é o número informado no item 2.1);</li>
				<li>Após a restauração da base, tecle “Enter” para continuar o processo;</li>
				<li>Tecle “Enter” para iniciar o processo de exportação dos dados, podendo levar vários minutos ou horas, dependendo do tamanho da base e da máquina utilizada;</li>
				<li>Aguarde até que o processo seja finalizado;</li>
				<li>Em seguida, avaliar a seção “Verificador” deste manual.</li>
			</ol>
			<br>
		<h4><b>Exclusão da base no pgAdmin III</b></h4>
			<p>Após a conversão definitiva (entrega do banco ao cliente), você pode excluir a base no pgAdmin para liberar espaço em sua máquina, seguindo os passos abaixo:</p>
			<ol>
				<li>Primeiramente, abrir o programa pgAdmin;</li>
				<li>Clicar no sinal de “>” em “Databases” para expandir as bases existentes;</li>
				<li>Clicar com o botão direito do mouse na database desejada e selecionar “Delete/Drop...”;</li>
				<li>Clicar em “Sim” na tela de confirmação e aguardar o processo finalizar.</li>
			</ol>
			<div><img src="..\..\images\2_conversores\alterdata_003.png" class="w3-border w3-padding"></div>
<br><br><br>
		<h4><b>Conversão de base tipo SQL Server</b></h4>
			<p>O banco de dados do concorrente deve estar no formato “.bak”.</p>
			<p>O backup do concorrente deve ser restaurado no aplicativo SQL Server Management Studio, e pode estar em qualquer local na máquina, não é necessário copiar para a pasta “Dados_Concorrente”.</p>
			<p>Os detalhes de como restaurar podem ser avaliados nas imagens abaixo.</p>
			
			<!-- !SLIDESHOW SQL RESTORE! -->
			<style>
			.sqlserverSlides {display:none;}
			</style>

			<div class="w3-content w3-display-container">

			<div class="w3-display-container sqlserverSlides">
			  <img src="..\..\images\2_conversores\alterdata_sqlserver_restore_1.png" style="width:100%">
			  <div class="w3-black">
			  </div>
			</div>

			<div class="w3-display-container sqlserverSlides">
			  <img src="..\..\images\2_conversores\alterdata_sqlserver_restore_2.png" style="width:100%">
			  <div class="w3-black">
			  </div>
			</div>

			<div class="w3-display-container sqlserverSlides">
			  <img src="..\..\images\2_conversores\alterdata_sqlserver_restore_3.png" style="width:100%">
			  <div class="w3-black">
			  </div>
			</div>

			<div class="w3-display-container sqlserverSlides">
			  <img src="..\..\images\2_conversores\alterdata_sqlserver_restore_4.png" style="width:100%">
			  <div class="w3-black">
			  </div>
			</div>

			<div class="w3-display-container sqlserverSlides">
			  <img src="..\..\images\2_conversores\alterdata_sqlserver_restore_5.png" style="width:100%">
			  <div class="w3-black">
			  </div>
			</div>

			<div class="w3-display-container sqlserverSlides">
			  <img src="..\..\images\2_conversores\alterdata_sqlserver_restore_6.png" style="width:100%">
			  <div class="w3-black">
			  </div>
			</div>

			<div class="w3-display-container sqlserverSlides">
			  <img src="..\..\images\2_conversores\alterdata_sqlserver_restore_7.png" style="width:100%">
			  <div class="w3-black">
			  </div>
			</div>

			<div class="w3-display-container sqlserverSlides">
			  <img src="..\..\images\2_conversores\alterdata_sqlserver_restore_8.png" style="width:100%">
			  <div class="w3-black">
			  </div>
			</div>

			<div class="w3-display-container sqlserverSlides">
			  <img src="..\..\images\2_conversores\alterdata_sqlserver_restore_9.png" style="width:100%">
			  <div class="w3-black">
			  </div>
			</div>


			<button class="w3-button w3-display-left w3-black" onclick="plusDivs(-1)">&#10094;</button>
			<button class="w3-button w3-display-right w3-black" onclick="plusDivs(1)">&#10095;</button>

			</div>

			<script>
			var slideIndex = 1;
			showDivs(slideIndex);

			function plusDivs(n) {
			  showDivs(slideIndex += n);
			}

			function showDivs(n) {
			  var i;
			  var x = document.getElementsByClassName("sqlserverSlides");
			  if (n > x.length) {slideIndex = 1}
			  if (n < 1) {slideIndex = x.length}
			  for (i = 0; i < x.length; i++) {
				 x[i].style.display = "none";  
			  }
			  x[slideIndex-1].style.display = "block";  
			}
			</script>
			<!-- !end SLIDESHOW SQL RESTORE! -->
			<br>
			<ol>
				<li>Após restaurada a base, executar o arquivo "Conversao.bat" na pasta raiz;</li>
				<ol>
					<li>Informe um número para controle do atendimento;</li>
				</ol>
				<li>Na lista de conversores, informe a opção “1- Alterdata”, e pressione “Enter”;</li>
				<li>Informe a opção “1 – Apenas Converter” para realizar a preparação dos dados, “2 – Apenas Verificar”, para realizar a Verificação (caso já tenha realizado a opção 1 anteriormente, poderá ir para a seção Verificador), ou, “3 – Converter e Verificar” para realizar ambos os processos;</li>
				<li>Informe a opção “1- Sim” para exportar os dados (caso já tenha realizado anteriormente, informe “2- Não”);</li>
				<li>Informe “1” caso deseje converter dados da Escrita (Clientes e Fornecedores);</li>
				<li>Informe “1” caso deseje converter dados da Contabilidade (Contas e Históricos);</li>
				<li>Informe “2” para base SQL Server;</li>
				<li>Informe o nome do servidor conforme consta no SQL Server Management Studio (geralmente é o nome da máquina);</li>
				<div><img src="..\..\images\2_conversores\alterdata_004.png" class="w3-border w3-padding"></div>
				<br>
				<li>Aguarde os procedimentos em tela, o tempo varia conforme o tamanho da base concorrente;</li>
				<li>Após isso, avaliar a seção “Verificador” deste manual.</li>
				</ol>
			<br>
	</div>
  </div>
<!-- End page content -->
</div>
