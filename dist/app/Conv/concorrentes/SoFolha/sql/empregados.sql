SELECT (SELECT CD_EMPRESA FROM CAD_EMPRESACONFIG WHERE CAD_EMPRESACONFIG.ID_EMPRESA = CAD_FUNCIONARIO.ID_EMPRESA ) AS CD_EMPRESA,
	CAD_FUNCIONARIO.CD_FUNCIONARIO,
	CAD_FUNCIONARIO.ID_EMPRESA,
	CAD_FUNCIONARIO.DS_NOME,
	CAD_FUNCIONARIO.FG_SEXO,
	CAD_FUNCIONARIO.DS_ESTADOCIVIL,
	CAD_FUNCIONARIO.DS_NOMEMAE,
	CAD_FUNCIONARIO.DS_NOMEPAI,
	CAD_FUNCIONARIO.FG_DEFICIENTEFISICO,
	CAD_FUNCIONARIO.CD_DEFICIENCIA,
	CAD_FUNCIONARIO.CD_RACACOR,
	CAD_FUNCIONARIO.CD_GRAUINSTRUCAO,
	CAD_FUNCIONARIO.DS_LOGRADOURO,
	CAD_FUNCIONARIO.NR_NUMERO,
	CAD_FUNCIONARIO.DS_COMPLEMENTO,
	CAD_FUNCIONARIO.DS_BAIRRO,
	CAD_FUNCIONARIO.CD_UF,
	(SELECT DS_MUNICIPIO FROM CAD_MUNICIPIO WHERE CAD_MUNICIPIO.CD_MUNICIPIO = CAD_FUNCIONARIO.CD_MUNICIPIO ) AS MUNICIPIO,
	CAD_FUNCIONARIO.NR_CEP,
	CAD_FUNCIONARIO.NR_TELEFONE,
	CAD_FUNCIONARIO.NR_TELEFONECELULAR,
	CAD_FUNCIONARIO.DS_EMAIL,
	CAD_FUNCIONARIO.NR_PISPASEPCI,
	CAD_FUNCIONARIO.DT_CADASTROINSCRICAO,
	CAD_FUNCIONARIO.NR_CTPS,
	CAD_FUNCIONARIO.NR_SERIECTPS,
	CAD_FUNCIONARIO.DS_UFCTPS,
	CAD_FUNCIONARIO.DT_EMISSAOCTPS,
	CAD_FUNCIONARIO.NR_CPF,
	CAD_FUNCIONARIO.NR_RESERVISTA,
	CAD_FUNCIONARIO.NR_RG,
	CAD_FUNCIONARIO.NR_COMPLEMENTORG,
	CAD_FUNCIONARIO.DS_EMISSORRG,
	CAD_FUNCIONARIO.DT_EMISSAORG,
	CAD_FUNCIONARIO.NR_RIC,
	CAD_FUNCIONARIO.DS_RICEMISSOR,
	CAD_FUNCIONARIO.NR_RICUF,
	CAD_FUNCIONARIO.NR_RICMUNICIPIO,
	CAD_FUNCIONARIO.DT_RICEXPEDICAO,
	CAD_FUNCIONARIO.NR_TITULOELEITOR,
	CAD_FUNCIONARIO.NR_ZONAELEITORAL,
	CAD_FUNCIONARIO.NR_SECAOELEITORAL,
	CAD_FUNCIONARIO.NR_CNH,
	CAD_FUNCIONARIO.DT_VALIDADECNH,
	CAD_FUNCIONARIO.DS_CATEGORIAHABILITACAO,
	CAD_FUNCIONARIO.NR_PASSAPORTE,
	CAD_FUNCIONARIO.DS_PASSAPORTEEMISSOR,
	CAD_FUNCIONARIO.NR_PASSAPORTEUF,
	CAD_FUNCIONARIO.CD_PASSAPORTEPAISEMISSAO,
	CAD_FUNCIONARIO.DT_PASSAPORTEEMISSAO,
	CAD_FUNCIONARIO.DT_PASSAPORTEVALIDADE,
	CAD_FUNCIONARIO.NR_NATURALIZACAO,
	CAD_FUNCIONARIO.DT_NATURALIZACAO,
	CAD_FUNCIONARIO.CD_SINDICATOEMPREGADO,
	CAD_FUNCIONARIO.CD_QUADROHORARIO,
	CAD_FUNCIONARIO.CD_CENTROCUSTO,
	CAD_FUNCIONARIO.CD_CATEGORIA,
	CAD_FUNCIONARIO.CD_VINCULOEMPREGATICIO,
	CAD_FUNCIONARIO.CD_TIPOADMISSAO,
	CAD_FUNCIONARIO.CD_OCORRENCIA,
	CAD_FUNCIONARIO.CD_ADMISSAOFGTS,
	CAD_FUNCIONARIOCONFIG.CD_NACIONALIDADE,
	CAD_FUNCIONARIOCONFIG.CD_PAIS,
	CAD_FUNCIONARIO.NR_CONTADEPOSITOFGTS,
	CAD_FUNCIONARIO.FG_OPTANTERECOLHIMENTOFGTS,
	CAD_FUNCIONARIO.DT_OPCAOFGTS,
	CAD_FUNCIONARIO.FG_POSSUIRALVARA,
	CAD_FUNCIONARIOCONFIG.DT_NASCIMENTO,
	CAD_FUNCIONARIOCONFIG.DT_ADMISSAO,
	CAD_FUNCIONARIOCONFIG.DT_DEMISSAO,
	CAD_FUNCIONARIOCONFIG.CD_UFNATURAL,
	(SELECT DS_MUNICIPIO FROM CAD_MUNICIPIO WHERE CAD_MUNICIPIO.CD_MUNICIPIO = CAD_FUNCIONARIOCONFIG.CD_MUNICIPIONATURAL ) AS MUNICIPIO_NATURAL,
	CAD_FUNCIONARIOCONFIG.NR_CONTACORRENTE,
	CAD_FUNCIONARIOCONFIG.FG_CONTRATOEXPERIENCIA,
	CAD_FUNCIONARIOCONFIG.NR_DIASCONTRATOEXPERIENCIA,
	CAD_FUNCIONARIOCONFIG.NR_PERIODOINICIALDIAS,
	CAD_FUNCIONARIOCONFIG.NR_PRORROGACAODIAS,
	CAD_FUNCIONARIOCONFIG.NR_PRORROGACAOCONTRATOEXPERIENC,
	(SELECT DT_PERIODOAQUISITIVOFIM FROM CAD_FERIAS WHERE CAD_FERIAS.ID_EMPRESA = CAD_FUNCIONARIO.ID_EMPRESA AND
														  CAD_FERIAS.CD_FUNCIONARIO = CAD_FUNCIONARIO.CD_FUNCIONARIO AND
														  CAD_FERIAS.ID_FERIAS = (SELECT MAX(F.ID_FERIAS)                                                                                                                                          
																				  FROM CAD_FERIAS AS F
                                                                                  WHERE F.ID_EMPRESA = CAD_FERIAS.ID_EMPRESA AND
                                                                                        F.CD_FUNCIONARIO = CAD_FERIAS.CD_FUNCIONARIO)) AS VENC_FERIAS,
																						
	(SELECT VR_SALARIOBASE FROM CAD_ALTERACAOCARGOSALARIO WHERE CAD_ALTERACAOCARGOSALARIO.ID_EMPRESA = CAD_FUNCIONARIO.ID_EMPRESA AND
														  CAD_ALTERACAOCARGOSALARIO.CD_FUNCIONARIO = CAD_FUNCIONARIO.CD_FUNCIONARIO AND
														  CAD_ALTERACAOCARGOSALARIO.DT_VIGENCIAINICIO = (SELECT MAX(ALT_SAL.DT_VIGENCIAINICIO)                                                                                                                                          
																				  FROM CAD_ALTERACAOCARGOSALARIO AS ALT_SAL
                                                                                  WHERE ALT_SAL.ID_EMPRESA = CAD_ALTERACAOCARGOSALARIO.ID_EMPRESA AND
                                                                                        ALT_SAL.CD_FUNCIONARIO = CAD_ALTERACAOCARGOSALARIO.CD_FUNCIONARIO)) AS SALARIO,
																						
	(SELECT DS_PROFISSAO FROM CAD_ALTERACAOCARGOSALARIO WHERE CAD_ALTERACAOCARGOSALARIO.ID_EMPRESA = CAD_FUNCIONARIO.ID_EMPRESA AND
														  CAD_ALTERACAOCARGOSALARIO.CD_FUNCIONARIO = CAD_FUNCIONARIO.CD_FUNCIONARIO AND
														  CAD_ALTERACAOCARGOSALARIO.DT_VIGENCIAINICIO = (SELECT MIN(ALT_CAR.DT_VIGENCIAINICIO)                                                                                                                                          
																				  FROM CAD_ALTERACAOCARGOSALARIO AS ALT_CAR
                                                                                  WHERE ALT_CAR.ID_EMPRESA = CAD_ALTERACAOCARGOSALARIO.ID_EMPRESA AND
                                                                                        ALT_CAR.CD_FUNCIONARIO = CAD_ALTERACAOCARGOSALARIO.CD_FUNCIONARIO)) AS CARGO,
                                                                                        
    (SELECT HR_SEMANAL FROM CAD_ALTERACAOCARGOSALARIO WHERE CAD_ALTERACAOCARGOSALARIO.ID_EMPRESA = CAD_FUNCIONARIO.ID_EMPRESA AND
														  CAD_ALTERACAOCARGOSALARIO.CD_FUNCIONARIO = CAD_FUNCIONARIO.CD_FUNCIONARIO AND
														  CAD_ALTERACAOCARGOSALARIO.DT_VIGENCIAINICIO = (SELECT MAX(ALT_CAR.DT_VIGENCIAINICIO)                                                                                                                                          
																				  FROM CAD_ALTERACAOCARGOSALARIO AS ALT_CAR
                                                                                  WHERE ALT_CAR.ID_EMPRESA = CAD_ALTERACAOCARGOSALARIO.ID_EMPRESA AND
                                                                                        ALT_CAR.CD_FUNCIONARIO = CAD_ALTERACAOCARGOSALARIO.CD_FUNCIONARIO)) AS HR_SEMANAL,
                                                                                        
    (SELECT HR_MENSAL FROM CAD_ALTERACAOCARGOSALARIO WHERE CAD_ALTERACAOCARGOSALARIO.ID_EMPRESA = CAD_FUNCIONARIO.ID_EMPRESA AND
														  CAD_ALTERACAOCARGOSALARIO.CD_FUNCIONARIO = CAD_FUNCIONARIO.CD_FUNCIONARIO AND
														  CAD_ALTERACAOCARGOSALARIO.DT_VIGENCIAINICIO = (SELECT MAX(ALT_CAR.DT_VIGENCIAINICIO)                                                                                                                                          
																				  FROM CAD_ALTERACAOCARGOSALARIO AS ALT_CAR
                                                                                  WHERE ALT_CAR.ID_EMPRESA = CAD_ALTERACAOCARGOSALARIO.ID_EMPRESA AND
                                                                                        ALT_CAR.CD_FUNCIONARIO = CAD_ALTERACAOCARGOSALARIO.CD_FUNCIONARIO)) AS HR_MENSAL,
                                                                                        
	CAD_FUNCIONARIO.HR_TRABALHOENTRADA,
	CAD_FUNCIONARIO.HR_TRABALHOSAIDAINTERVALO,
	CAD_FUNCIONARIO.HR_TRABALHOENTRADAINTERVALO,
	CAD_FUNCIONARIO.HR_TRABALHOSAIDA,
	CAD_FUNCIONARIO.DS_DIAREPOUSO,
	(SELECT CD_FILIAL FROM CAD_EMPRESACONFIG WHERE CAD_EMPRESACONFIG.ID_EMPRESA = CAD_FUNCIONARIO.ID_EMPRESA ) AS COD_FILIAL, CD_MATRICULA, CD_CATEGORIAESOCIAL
FROM CAD_FUNCIONARIO
INNER JOIN CAD_FUNCIONARIOCONFIG ON CAD_FUNCIONARIOCONFIG.ID_EMPRESA = CAD_FUNCIONARIO.ID_EMPRESA AND
                                    CAD_FUNCIONARIOCONFIG.CD_FUNCIONARIO = CAD_FUNCIONARIO.CD_FUNCIONARIO AND
									CAD_FUNCIONARIO.DT_VIGENCIAINICIO = (SELECT MAX(FUN2.DT_VIGENCIAINICIO)                                                                                                                                          
																		 FROM CAD_FUNCIONARIO AS FUN2
                                                                         WHERE FUN2.ID_EMPRESA = CAD_FUNCIONARIO.ID_EMPRESA AND
                                                                               FUN2.CD_FUNCIONARIO = CAD_FUNCIONARIO.CD_FUNCIONARIO)
ORDER BY 1,2,3