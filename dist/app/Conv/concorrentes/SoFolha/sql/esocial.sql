SELECT emp.CD_EMPRESA AS CODI_EMP,
	   emp.ID_EMPRESA,
       '1' AS CODIGO,
       '1000' AS EVENTO,
       det.NR_RECIBO,
       '' AS DATA
  FROM CAD_REGISTROESOCIALS1000DETALHE det
  LEFT OUTER JOIN CAD_REGISTROESOCIALS1000 esc
    ON det.ID_REGISTROESOCIALS1000 = esc.ID_REGISTROESOCIALS1000
  LEFT JOIN CAD_EMPRESACONFIG emp
    ON esc.ID_EMPRESA = emp.ID_EMPRESA
 WHERE det.NR_RECIBO IS NOT NULL
 UNION
SELECT emp.CD_EMPRESA AS CODI_EMP,
	   emp.ID_EMPRESA,
       esc.CD_CARGO AS CODIGO,
       '1030' AS EVENTO,
       det.NR_RECIBO,
       '' AS DATA
  FROM CAD_REGISTROESOCIALS1030DETALHE det
  LEFT OUTER JOIN CAD_REGISTROESOCIALS1030 esc
    ON det.ID_REGISTROESOCIALS1030 = esc.ID_REGISTROESOCIALS1030
  LEFT JOIN CAD_EMPRESACONFIG emp
    ON esc.ID_EMPRESA = emp.ID_EMPRESA
 WHERE det.NR_RECIBO IS NOT NULL
 UNION
SELECT emp.CD_EMPRESA AS CODI_EMP,
       emp.ID_EMPRESA,
       hor_det.CD_HORARIOTRABALHOESOCIAL AS CODIGO,
       '1050' AS EVENTO,
       det.NR_RECIBO,
       '' AS DATA
  FROM CAD_REGISTROESOCIALS1050DETALHE det
  LEFT OUTER JOIN CAD_REGISTROESOCIALS1050 esc
    ON det.ID_REGISTROESOCIALS1050 = esc.ID_REGISTROESOCIALS1050
  LEFT OUTER JOIN CAD_QUADROHORARIOEMPRESADETALHE hor_det
    ON hor_det.ID_EMPRESA = esc.ID_EMPRESA
   AND hor_det.CD_QUADROHORARIO = esc.CD_QUADROHORARIO
   AND hor_det.CD_QUADROHORARIODETALHE = esc.CD_QUADROHORARIODETALHE
   AND hor_det.ID_DIASEMANA = esc.ID_DIASEMANA
  LEFT JOIN CAD_EMPRESACONFIG emp
    ON esc.ID_EMPRESA = emp.ID_EMPRESA
 WHERE det.NR_RECIBO IS NOT NULL
 UNION
SELECT emp.CD_EMPRESA AS CODI_EMP,
	   emp.ID_EMPRESA,
       esc.CD_FUNCIONARIO AS CODIGO,
       '2200' AS EVENTO,
       det.NR_RECIBO,
       '' AS DATA
  FROM CAD_REGISTROESOCIALS2200DETALHE det
  LEFT OUTER JOIN CAD_REGISTROESOCIALS2200 esc
    ON det.ID_REGISTROESOCIALS2200 = esc.ID_REGISTROESOCIALS2200
  LEFT JOIN CAD_EMPRESACONFIG emp
    ON esc.ID_EMPRESA = emp.ID_EMPRESA
 WHERE det.NR_RECIBO IS NOT NULL
 UNION
SELECT emp.CD_EMPRESA AS CODI_EMP,
	   emp.ID_EMPRESA,
       esc.CD_SOCIO AS CODIGO,
       '2300' AS EVENTO,
       det.NR_RECIBO,
       '' AS DATA
  FROM CAD_REGISTROESOCIALS2300DETALHE det
  LEFT OUTER JOIN CAD_REGISTROESOCIALS2300 esc
    ON det.ID_REGISTROESOCIALS2300 = esc.ID_REGISTROESOCIALS2300
  LEFT JOIN CAD_EMPRESACONFIG emp
    ON esc.ID_EMPRESASOCIO = emp.ID_EMPRESA    
 WHERE det.NR_RECIBO IS NOT NULL
   AND esc.ID_EMPRESASOCIO IS NOT NULL
   AND esc.CD_SOCIO IS NOT NULL 
 UNION
SELECT emp.CD_EMPRESA AS CODI_EMP,
 	   emp.ID_EMPRESA,
       esc.CD_AUTONOMO AS CODIGO,
       '2300-autonomo' AS EVENTO,
       det.NR_RECIBO,
       '' AS DATA
  FROM CAD_REGISTROESOCIALS2300DETALHE det
  LEFT OUTER JOIN CAD_REGISTROESOCIALS2300 esc
    ON det.ID_REGISTROESOCIALS2300 = esc.ID_REGISTROESOCIALS2300
  LEFT JOIN CAD_EMPRESACONFIG emp
    ON esc.ID_EMPRESAAUTONOMO = emp.ID_EMPRESA
 WHERE det.NR_RECIBO IS NOT NULL
   AND esc.ID_EMPRESAAUTONOMO IS NOT NULL
   AND esc.CD_AUTONOMO IS NOT NULL
 UNION
SELECT emp.CD_EMPRESA AS CODI_EMP,
	   emp.ID_EMPRESA,
       esc.CD_FUNCIONARIO AS CODIGO,
       '2205' AS EVENTO,
       det.NR_RECIBO,
       esc.DT_VIGENCIAINICIO AS DATA
  FROM CAD_REGISTROESOCIALS2205DETALHE det
  LEFT OUTER JOIN CAD_REGISTROESOCIALS2205 esc
    ON det.ID_REGISTROESOCIALS2205 = esc.ID_REGISTROESOCIALS2205
  LEFT JOIN CAD_EMPRESACONFIG emp
    ON esc.ID_EMPRESA = emp.ID_EMPRESA
 WHERE det.NR_RECIBO IS NOT NULL
   AND esc.ID_EMPRESA IS NOT NULL
   AND esc.CD_FUNCIONARIO IS NOT NULL 
 UNION
SELECT emp.CD_EMPRESA AS CODI_EMP,
	   emp.ID_EMPRESA,
       esc.CD_FUNCIONARIO AS CODIGO,
       '2206' AS EVENTO,
       det.NR_RECIBO,
       esc.DT_VIGENCIAINICIO AS DATA
  FROM CAD_REGISTROESOCIALS2206DETALHE det
  LEFT OUTER JOIN CAD_REGISTROESOCIALS2206 esc
    ON det.ID_REGISTROESOCIALS2206 = esc.ID_REGISTROESOCIALS2206
  LEFT JOIN CAD_EMPRESACONFIG emp
    ON esc.ID_EMPRESA = emp.ID_EMPRESA
 WHERE det.NR_RECIBO IS NOT NULL
   AND esc.ID_EMPRESA IS NOT NULL
   AND esc.CD_FUNCIONARIO IS NOT NULL 
 ORDER BY 1,2,4,3
