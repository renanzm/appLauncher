SELECT (SELECT CD_EMPRESA FROM CAD_EMPRESACONFIG WHERE CAD_EMPRESACONFIG.ID_EMPRESA = CAD_AUTONOMO.ID_EMPRESA ) AS CD_EMPRESA,
	CAD_AUTONOMO.CD_AUTONOMO,
	CAD_AUTONOMO.ID_EMPRESA,
	CAD_AUTONOMO.DS_NOME,	
	CAD_AUTONOMO.FG_SEXO,
	CAD_AUTONOMO.DS_LOGRADOURO,
	CAD_AUTONOMO.NR_NUMERO,
	CAD_AUTONOMO.DS_COMPLEMENTO,
	CAD_AUTONOMO.DS_BAIRRO,
	CAD_AUTONOMO.CD_UF,
	(SELECT DS_MUNICIPIO FROM CAD_MUNICIPIO WHERE CAD_MUNICIPIO.CD_MUNICIPIO = CAD_AUTONOMO.CD_MUNICIPIO ) AS MUNICIPIO,
	CAD_AUTONOMO.NR_CEP,
	CAD_AUTONOMO.NR_TELEFONE,
	CAD_AUTONOMO.NR_TELEFONECELULAR,
	CAD_AUTONOMO.DS_EMAIL,
	CAD_AUTONOMO.NR_PISPASEP,
	CAD_AUTONOMO.DT_CADASTROINSCRICAO,
	CAD_AUTONOMO.NR_CPF,
	CAD_AUTONOMO.NR_RG,
	CAD_AUTONOMO.DS_EMISSORRG,
	CAD_AUTONOMO.DT_EMISSAORG,
	CAD_AUTONOMO.NR_RIC,
	CAD_AUTONOMO.DS_RICEMISSOR,
	CAD_AUTONOMO.NR_RICUF,
	CAD_AUTONOMO.NR_RICMUNICIPIO,
	CAD_AUTONOMO.DT_RICEXPEDICAO,
	CAD_AUTONOMO.NR_TITULOELEITOR,
	CAD_AUTONOMO.NR_ZONAELEITORAL,
	CAD_AUTONOMO.NR_SECAOELEITORAL,
	CAD_AUTONOMO.NR_CNH,
	CAD_AUTONOMO.DT_VALIDADECNH,
	CAD_AUTONOMO.DS_CATEGORIAHABILITACAO,
	CAD_AUTONOMO.CD_CATEGORIA,
	CAD_AUTONOMO.CD_OCORRENCIA,
	CAD_AUTONOMO.CD_CENTROCUSTO,
	CAD_AUTONOMO.CD_FPAS,
	CAD_AUTONOMO.CD_TERCEIRO,
	CAD_AUTONOMOCONFIG.DT_NASCIMENTO,
	CAD_AUTONOMOCONFIG.NR_CONTACORRENTE,
	CAD_AUTONOMOCONFIG.DT_ENTRADA,
	CAD_AUTONOMOCONFIG.DT_SAIDA,
	(SELECT VR_REMUNERACAOBASE FROM CAD_ALTERACAOCARGOSERVICO WHERE CAD_ALTERACAOCARGOSERVICO.ID_EMPRESA = CAD_AUTONOMO.ID_EMPRESA AND
														  CAD_ALTERACAOCARGOSERVICO.CD_AUTONOMO = CAD_AUTONOMO.CD_AUTONOMO AND
														  CAD_ALTERACAOCARGOSERVICO.DT_VIGENCIAINICIO = (SELECT MIN(ALT_SAL.DT_VIGENCIAINICIO)                                                                                                                                          
																				  FROM CAD_ALTERACAOCARGOSERVICO AS ALT_SAL
                                                                                  WHERE ALT_SAL.ID_EMPRESA = CAD_ALTERACAOCARGOSERVICO.ID_EMPRESA AND
                                                                                        ALT_SAL.CD_AUTONOMO = CAD_ALTERACAOCARGOSERVICO.CD_AUTONOMO)) AS SALARIO,
																						
	(SELECT DS_PROFISSAO FROM CAD_ALTERACAOCARGOSERVICO WHERE CAD_ALTERACAOCARGOSERVICO.ID_EMPRESA = CAD_AUTONOMO.ID_EMPRESA AND
														  CAD_ALTERACAOCARGOSERVICO.CD_AUTONOMO = CAD_AUTONOMO.CD_AUTONOMO AND
														  CAD_ALTERACAOCARGOSERVICO.DT_VIGENCIAINICIO = (SELECT MIN(ALT_CAR.DT_VIGENCIAINICIO)                                                                                                                                          
																				  FROM CAD_ALTERACAOCARGOSERVICO AS ALT_CAR
                                                                                  WHERE ALT_CAR.ID_EMPRESA = CAD_ALTERACAOCARGOSERVICO.ID_EMPRESA AND
                                                                                        ALT_CAR.CD_AUTONOMO = CAD_ALTERACAOCARGOSERVICO.CD_AUTONOMO)) AS CARGO,
	(SELECT CD_FILIAL FROM CAD_EMPRESACONFIG WHERE CAD_EMPRESACONFIG.ID_EMPRESA = CAD_AUTONOMO.ID_EMPRESA ) AS COD_FILIAL, CD_MATRICULA, CD_CATEGORIAESOCIAL
																						
FROM CAD_AUTONOMO
INNER JOIN CAD_AUTONOMOCONFIG ON CAD_AUTONOMOCONFIG.ID_EMPRESA = CAD_AUTONOMO.ID_EMPRESA AND
								 CAD_AUTONOMOCONFIG.CD_AUTONOMO = CAD_AUTONOMO.CD_AUTONOMO AND
								 CAD_AUTONOMO.DT_VIGENCIAINICIO = (SELECT MAX(AUT2.DT_VIGENCIAINICIO)
																   FROM CAD_AUTONOMO AS AUT2
																   WHERE AUT2.ID_EMPRESA = CAD_AUTONOMO.ID_EMPRESA AND
																		 AUT2.CD_AUTONOMO = CAD_AUTONOMO.CD_AUTONOMO)
ORDER BY 1,2,3