SELECT (SELECT CD_EMPRESA FROM CAD_EMPRESACONFIG WHERE CAD_EMPRESACONFIG.ID_EMPRESA = CAD_SOCIO.ID_EMPRESA ) AS CD_EMPRESA,
	CAD_SOCIO.CD_SOCIO,
	CAD_SOCIO.ID_EMPRESA,
	CAD_SOCIO.DS_NOME,
	CAD_SOCIO.FG_SEXO,
	CAD_SOCIO.NR_CPF,
	CAD_SOCIO.FG_RESPONSAVELCNPJ,
	CAD_SOCIO.NR_PISPASEPCI,
	CAD_SOCIO.DT_CADASTROINSCRICAO,
	CAD_SOCIO.NR_RG,
	CAD_SOCIO.DS_EMISSORRG,
	CAD_SOCIO.DT_EMISSAORG,
	CAD_SOCIO.NR_RIC,
	CAD_SOCIO.DS_RICEMISSOR,
	CAD_SOCIO.NR_RICUF,
	CAD_SOCIO.NR_RICMUNICIPIO,
	CAD_SOCIO.DT_RICEXPEDICAO,
	CAD_SOCIO.DS_LOGRADOURO,
	CAD_SOCIO.NR_NUMERO,
	CAD_SOCIO.DS_COMPLEMENTO,
	CAD_SOCIO.DS_BAIRRO,
	CAD_SOCIO.CD_UF,
	(SELECT DS_MUNICIPIO FROM CAD_MUNICIPIO WHERE CAD_MUNICIPIO.CD_MUNICIPIO = CAD_SOCIO.CD_MUNICIPIO ) AS MUNICIPIO,
	CAD_SOCIO.NR_CEP,
	CAD_SOCIO.NR_TELEFONE,
	CAD_SOCIO.DS_EMAIL,
	CAD_SOCIO.CD_CENTROCUSTO,
	CAD_SOCIO.CD_OCORRENCIA,
	CAD_SOCIO.CD_CATEGORIA,
	CAD_SOCIO.DT_OPCAOFGTS,
	CAD_SOCIO.NR_CONTADEPOSITOFGTS,
	CAD_SOCIO.CD_VINCULOEMPREGATICIO,
	CAD_SOCIO.CD_TIPOADMISSAO,
	CAD_SOCIO.CD_SINDICATOEMPREGADO,
	CAD_SOCIO.CD_RACACOR,
	CAD_SOCIO.FG_DEFICIENTEFISICO,
	CAD_SOCIO.CD_DEFICIENCIA,
	CAD_SOCIO.CD_GRAUINSTRUCAO,
	CAD_SOCIO.CD_MUNICIPIOLOCALTRABALHO,
	CAD_SOCIO.CD_UFLOCALTRABALHO,
	CAD_SOCIO.HR_SEMANAL,
	CAD_SOCIO.HR_MENSAL,
	CAD_SOCIO.DS_ESTADOCIVIL,
	CAD_SOCIO.DS_NOMEMAE,
	CAD_SOCIO.DS_NOMEPAI,
	CAD_SOCIO.NR_TELEFONECELULAR,
	CAD_SOCIO.NR_TITULOELEITOR,
	CAD_SOCIO.NR_ZONAELEITORAL,
	CAD_SOCIO.NR_SECAOELEITORAL,
	CAD_SOCIO.ID_CONSELHOREGIONAL,
	CAD_SOCIO.CD_ADMISSAOFGTS,
	CAD_SOCIOCONFIG.CD_NACIONALIDADE,
	CAD_SOCIOCONFIG.DT_NASCIMENTO,
	CAD_SOCIOCONFIG.DT_ENTRADA, /* ADMISSAO */
	CAD_SOCIOCONFIG.DT_SAIDA, /* DEMISSAO */
	CAD_SOCIOCONFIG.CD_UFNATURAL,
    CAD_SOCIOCONFIG.CD_MUNICIPIONATURAL,
	(SELECT DS_PROFISSAO FROM CAD_ALTERACAOCARGOREMUNERACAO WHERE CAD_ALTERACAOCARGOREMUNERACAO.ID_EMPRESA = CAD_SOCIO.ID_EMPRESA AND
														  CAD_ALTERACAOCARGOREMUNERACAO.CD_SOCIO = CAD_SOCIO.CD_SOCIO AND
														  CAD_ALTERACAOCARGOREMUNERACAO.DT_VIGENCIAINICIO = (SELECT MIN(ALT_CAR.DT_VIGENCIAINICIO)                                                                                                                                          
																				  FROM CAD_ALTERACAOCARGOREMUNERACAO AS ALT_CAR
                                                                                  WHERE ALT_CAR.ID_EMPRESA = CAD_ALTERACAOCARGOREMUNERACAO.ID_EMPRESA AND
                                                                                        ALT_CAR.CD_SOCIO = CAD_ALTERACAOCARGOREMUNERACAO.CD_SOCIO)) AS CARGO,
																						
	(SELECT VR_REMUNERACAOBASE FROM CAD_ALTERACAOCARGOREMUNERACAO WHERE CAD_ALTERACAOCARGOREMUNERACAO.ID_EMPRESA = CAD_SOCIO.ID_EMPRESA AND
														  CAD_ALTERACAOCARGOREMUNERACAO.CD_SOCIO = CAD_SOCIO.CD_SOCIO AND
														  CAD_ALTERACAOCARGOREMUNERACAO.DT_VIGENCIAINICIO = (SELECT MIN(ALT_SAL.DT_VIGENCIAINICIO)                                                                                                                                          
																				  FROM CAD_ALTERACAOCARGOREMUNERACAO AS ALT_SAL
                                                                                  WHERE ALT_SAL.ID_EMPRESA = CAD_ALTERACAOCARGOREMUNERACAO.ID_EMPRESA AND
                                                                                        ALT_SAL.CD_SOCIO = CAD_ALTERACAOCARGOREMUNERACAO.CD_SOCIO)) AS SALARIO,
	(SELECT CD_FILIAL FROM CAD_EMPRESACONFIG WHERE CAD_EMPRESACONFIG.ID_EMPRESA = CAD_SOCIO.ID_EMPRESA ) AS COD_FILIAL, CD_MATRICULA, CD_CATEGORIAESOCIAL																				
	
FROM CAD_SOCIO
INNER JOIN CAD_SOCIOCONFIG ON  CAD_SOCIOCONFIG.ID_EMPRESA = CAD_SOCIO.ID_EMPRESA AND 
                               CAD_SOCIOCONFIG.CD_SOCIO = CAD_SOCIO.CD_SOCIO AND
							   CAD_SOCIO.DT_VIGENCIAINICIO = (SELECT MAX(SOC2.DT_VIGENCIAINICIO)
															  FROM CAD_SOCIO AS SOC2
															  WHERE SOC2.ID_EMPRESA = CAD_SOCIO.ID_EMPRESA AND
																	SOC2.CD_SOCIO = CAD_SOCIO.CD_SOCIO)
ORDER BY 1,2,3


