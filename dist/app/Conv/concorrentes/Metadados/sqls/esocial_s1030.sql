    SELECT RHESOCIALEVENTOS1030.EMPRESA,
		   RHESOCIALEVENTOS1030.CARGO AS CODIGO,
           RHESOCIALEVENTOS1030.NRRECIBOESOCIAL,
		   RHESOCIALEVENTOS1030.CARGOESOCIAL AS CODIGO_ESOCIAL,
		   RHESOCIALEVENTOS1030.TIPOEVENTOESOCIAL
      FROM RHESOCIALEVENTOS1030 
     WHERE EVENTOESOCIAL = (select max(t2.EVENTOESOCIAL)
							 from dbo.RHESOCIALEVENTOS1030 as t2
							where  t2.EMPRESA = RHESOCIALEVENTOS1030.EMPRESA
							  and t2.CARGO = RHESOCIALEVENTOS1030.CARGO
							  and t2.REGISTROEXCLUIDOESOCIAL = 0
							  AND SITUACAOESOCIAL = 3
							  AND NRRECIBOESOCIAL <> ('') 
							  and TIPOOPERACAOESOCIAL = 1)
  ORDER BY 1