SELECT RHESCALASSEMANAIS.*,
       RHHORARIOS.DESCRICAO40,
	   (SELECT HORAMARCACAO FROM RHHORARIOSMARCACOES WHERE RHHORARIOSMARCACOES.HORARIO = RHESCALASSEMANAIS.HORARIO AND HORARIOALTERNATIVO = '01' AND RHHORARIOSMARCACOES.CLASSEMARCACAO = '01') AS ENTRADA,
	   (SELECT HORAMARCACAO FROM RHHORARIOSMARCACOES WHERE RHHORARIOSMARCACOES.HORARIO = RHESCALASSEMANAIS.HORARIO AND HORARIOALTERNATIVO = '01' AND RHHORARIOSMARCACOES.CLASSEMARCACAO = '03') AS SAIDA_INTERVALO,
	   (SELECT HORAMARCACAO FROM RHHORARIOSMARCACOES WHERE RHHORARIOSMARCACOES.HORARIO = RHESCALASSEMANAIS.HORARIO AND HORARIOALTERNATIVO = '01' AND RHHORARIOSMARCACOES.CLASSEMARCACAO = '04') AS ENTRADA_INTERVALO,
	   (SELECT HORAMARCACAO FROM RHHORARIOSMARCACOES WHERE RHHORARIOSMARCACOES.HORARIO = RHESCALASSEMANAIS.HORARIO AND HORARIOALTERNATIVO = '01' AND RHHORARIOSMARCACOES.CLASSEMARCACAO = '99') AS SAIDA
FROM RHESCALASSEMANAIS
INNER JOIN RHHORARIOS
ON RHESCALASSEMANAIS.HORARIO = RHHORARIOS.HORARIO

UNION

SELECT RHESCALASREVEZAMENTO.*,
       RHHORARIOS.DESCRICAO40,
	   (SELECT HORAMARCACAO FROM RHHORARIOSMARCACOES WHERE RHHORARIOSMARCACOES.HORARIO = RHESCALASREVEZAMENTO.HORARIO AND HORARIOALTERNATIVO = '01' AND RHHORARIOSMARCACOES.CLASSEMARCACAO = '01') AS ENTRADA,
	   (SELECT HORAMARCACAO FROM RHHORARIOSMARCACOES WHERE RHHORARIOSMARCACOES.HORARIO = RHESCALASREVEZAMENTO.HORARIO AND HORARIOALTERNATIVO = '01' AND RHHORARIOSMARCACOES.CLASSEMARCACAO = '03') AS SAIDA_INTERVALO,
	   (SELECT HORAMARCACAO FROM RHHORARIOSMARCACOES WHERE RHHORARIOSMARCACOES.HORARIO = RHESCALASREVEZAMENTO.HORARIO AND HORARIOALTERNATIVO = '01' AND RHHORARIOSMARCACOES.CLASSEMARCACAO = '04') AS ENTRADA_INTERVALO,
	   (SELECT HORAMARCACAO FROM RHHORARIOSMARCACOES WHERE RHHORARIOSMARCACOES.HORARIO = RHESCALASREVEZAMENTO.HORARIO AND HORARIOALTERNATIVO = '01' AND RHHORARIOSMARCACOES.CLASSEMARCACAO = '99') AS SAIDA
FROM dbo.RHESCALASREVEZAMENTO
INNER JOIN RHHORARIOS
ON RHESCALASREVEZAMENTO.HORARIO = RHHORARIOS.HORARIO