  SELECT distinct RHESOCIALEVENTOS1000.EMPRESA,
         RHESOCIALEVENTOS1000.NRRECIBOESOCIAL,
		 RHESOCIALEVENTOS1000.TIPOEVENTOESOCIAL
    FROM RHESOCIALEVENTOS1000
   WHERE EVENTOESOCIAL = (select max(t2.EVENTOESOCIAL)
							 from dbo.RHESOCIALEVENTOS1000 as t2
							where  t2.EMPRESA = RHESOCIALEVENTOS1000.EMPRESA
							  and t2.REGISTROEXCLUIDOESOCIAL = 0
							  AND SITUACAOESOCIAL = 3
							  AND NRRECIBOESOCIAL <> ('') 
							  and TIPOOPERACAOESOCIAL = 1)
ORDER BY 1