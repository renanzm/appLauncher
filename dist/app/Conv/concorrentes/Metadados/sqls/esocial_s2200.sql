      SELECT distinct dbo.RHESOCIALEVENTOS2200.EMPRESA,
		   dbo.RHCONTRATOS.CONTRATO AS CODIGO,
           dbo.RHESOCIALEVENTOS2200.NRRECIBOESOCIAL,
		   dbo.RHESOCIALEVENTOS2200.MATRICULAESOCIAL AS CODIGO_ESOCIAL,
		   dbo.RHESOCIALEVENTOS2200.TIPOEVENTOESOCIAL
      FROM dbo.RHESOCIALEVENTOS2200
LEFT OUTER JOIN dbo.RHPESSOAS ON dbo.RHESOCIALEVENTOS2200.CPF = dbo.RHPESSOAS.CPF
						      and RHESOCIALEVENTOS2200.EMPRESA = dbo.RHPESSOAS.EMPRESA
LEFT OUTER JOIN dbo.RHCONTRATOS ON  dbo.RHCONTRATOS.PESSOA = dbo.RHPESSOAS.PESSOA
                                   and dbo.RHCONTRATOS.EMPRESA = dbo.RHPESSOAS.EMPRESA
	 WHERE EVENTOESOCIAL = (select max(t2.EVENTOESOCIAL)
							 from dbo.RHESOCIALEVENTOS2200 as t2
							where t2.CPF = RHESOCIALEVENTOS2200.cpf
						      and t2.EMPRESA = RHESOCIALEVENTOS2200.EMPRESA
							  and t2.REGISTROEXCLUIDOESOCIAL = 0
							  and NRRECIBOESOCIAL <> ('')
							  and SITUACAOESOCIAL = 3)
  ORDER BY 1, 2