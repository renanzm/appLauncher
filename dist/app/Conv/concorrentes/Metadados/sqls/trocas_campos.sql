SELECT RHCONTRATOS.UNIDADE,
       RHCONTRATOS.CONTRATO,
	   DATAHORAALTERACAO,
	   CODIGOANTERIOR,
	   CODIGOATUAL,
	   VARIAVEL
FROM RHALTERACOESCONTRATO
LEFT JOIN RHCONTRATOS
ON RHCONTRATOS.UNIDADE = RHALTERACOESCONTRATO.UNIDADE
AND RHCONTRATOS.CONTRATO = RHALTERACOESCONTRATO.CONTRATO
WHERE VARIAVEL IN ('TSAL', 'AGEN') AND CODIGOATUAL != ''
ORDER BY RHCONTRATOS.EMPRESA, RHCONTRATOS.CONTRATO, RHALTERACOESCONTRATO.DATAHORAALTERACAO