SELECT FUNCIONA.* ,
       MUNICIP.MUDESMUNIC AS MUNICIPIO,
       MUNICIP.MUUF AS UF,
       MUNICIP.MUCODMUNIC AS CODIGO_ENDERECO,
       nasc.MUDESMUNIC AS MUNICIPIO_NASCIMENTO,
       nasc.MUUF AS UF_NASCIMENTO,
       nasc.MUCODMUNIC AS CODIGO_NASCIMENTO,
       OCORFUNC.OFCODEMP,
       OCORFUNC.OFMATFUNC,
       OCORFUNC.OFDTFINOCO AS DATA_TRANSF,
       OCORFUNC.OFCODLTANT,
	   OCORFUNC_AUX.OFCODLTANT AS SALARIO_INICIAL,
	   OCORFUNC_CARGO.OFCODCGANT AS CARGO_INICIAL,
       LOTACOES.LOCGCCEI,
	   LOTACOES.LOIDCGCCEI,
	   EVEFUNC.EFVALEVENT as SALARIO
  FROM dbo.FUNCIONA
  LEFT JOIN dbo.EVEFUNC EVEFUNC
  ON EVEFUNC.EFCODEMP = FUNCIONA.FUCODEMP
  AND EVEFUNC.EFMATFUNC = FUNCIONA.FUMATFUNC
  AND EVEFUNC.EFCODEVENT = 10050
  LEFT JOIN dbo.MUNICIP MUNICIP
    ON MUNICIP.MUCODMUNIC = FUNCIONA.FUCODMUNIC
  LEFT JOIN dbo.MUNICIP nasc
    ON nasc.MUCODMUNIC = FUNCIONA.FUCODMUNNC
  LEFT JOIN dbo.OCORFUNC
    ON OCORFUNC.OFCODEMP = FUNCIONA.FUCODEMP
   AND OCORFUNC.OFMATFUNC = FUNCIONA.FUMATFUNC
   AND OCORFUNC.OFCODOCORR = 1003
  LEFT JOIN dbo.OCORFUNC AS OCORFUNC_AUX
    ON OCORFUNC_AUX.OFCODEMP = FUNCIONA.FUCODEMP
   AND OCORFUNC_AUX.OFMATFUNC = FUNCIONA.FUMATFUNC
   AND OCORFUNC_AUX.OFCODOCORR = 1009
   AND OCORFUNC_AUX.OFDTINIOCO = (SELECT MIN(OFDTINIOCO)
                                  FROM dbo.OCORFUNC
                                  WHERE OFCODOCORR = 1009
                                    AND OFCODEMP = FUNCIONA.FUCODEMP
                                    AND OFMATFUNC = FUNCIONA.FUMATFUNC)
  LEFT JOIN dbo.OCORFUNC AS OCORFUNC_CARGO
    ON OCORFUNC_CARGO.OFCODEMP = FUNCIONA.FUCODEMP
   AND OCORFUNC_CARGO.OFMATFUNC = FUNCIONA.FUMATFUNC
   AND OCORFUNC_CARGO.OFCODOCORR = 1006
   AND OCORFUNC_CARGO.OFDTINIOCO = (SELECT MIN(OFDTINIOCO)
                                  FROM dbo.OCORFUNC
                                  WHERE OFCODOCORR = 1006
                                    AND OFCODEMP = FUNCIONA.FUCODEMP
                                    AND OFMATFUNC = FUNCIONA.FUMATFUNC)
  LEFT JOIN dbo.LOTACOES
    ON LOTACOES.LOCODLOT = LEFT(OCORFUNC.OFCODLTANT, 1) + '000000'
   AND LOTACOES.LOCODEMP = OCORFUNC.OFCODEMP
ORDER BY FUNCIONA.FUCODEMP, FUNCIONA.FUMATFUNC, OCORFUNC.OFDTFINOCO;
