WITH CcustoHistorico AS (
    SELECT 
        FUHISTCODEMP,
        FUHISTMATFUNC,
        FUHISTDATAINI,
        FUHISTCENTRCUS,
        LAG(FUHISTCENTRCUS) OVER (
            PARTITION BY FUHISTCODEMP, FUHISTMATFUNC 
            ORDER BY FUHISTDATAINI
        ) AS CcustoAnterior
    FROM FUNCIONAHIST
)
SELECT 
    FUHISTCODEMP,
    FUHISTMATFUNC,
    FUHISTDATAINI,
    FUHISTCENTRCUS
FROM CcustoHistorico
WHERE CcustoAnterior IS NULL OR CcustoAnterior <> FUHISTCENTRCUS
ORDER BY FUHISTCODEMP, FUHISTMATFUNC, FUHISTDATAINI;
