WITH PARAMETRO AS (
	SELECT ABREV,
	       MAX(ANOPARAM || MESPARAM) AS COMPETENCIA
	FROM PARAMLF
	GROUP BY ABREV
)
SELECT EMPRESAS.ABREV,
       EMPRESAS.RAZAO,
       EMPRESAS.RAZAOEXT,
       EMPRESAS.NUMERO,
       EMPRESAS.ENDER,
       EMPRESAS.COMPLEMENTO,
       EMPRESAS.BAIRRO,
       EMPRESAS.CIDADE,
       EMPRESAS.EST,
       EMPRESAS.CEP,
       EMPRESAS.FONE,
       EMPRESAS.FAX,
       EMPRESAS.IE,
       EMPRESAS.CONTATO,
       EMPRESAS.HOMEPAGE,
       EMPRESAS.EMAIL,
       EMPRESAS.TIPOESTABELECIMENTO,
       EMPRESAS.NUMLOCAL,
       EMPRESAS.CODCIDADE,
	   PARAMFP.CODFPAS,
	   PARAMFP.CODGPS,
	   PARAMFP.CODTERC,
	   PARAMFP.CODFGTSEMPR,
	   PARAMFP.CODNACATEC,
	   PARAMFP.CNAECAGED,
	   PARAMFP.CEI,
	   PARAMFP.DTINICIO,
	   PARAMFP.NATJURIDICA,
	   PARAMFP.CPFRESPONSAVEL,
	   PARAMFP.NOMERESPONSAVEL,
	   PARAMFP.RGRESPONSAVEL,
	   EMPRESAS.TIPOLOGR,
	   PARAMLF.NUMREGJUNTA,
	   PARAMLF.DTREGISTRO,
	   ''
FROM EMPRESAS
LEFT JOIN PARAMFP
	ON PARAMFP.ABREV = EMPRESAS.ABREV
LEFT JOIN PARAMETRO
	ON PARAMETRO.ABREV = EMPRESAS.ABREV
LEFT JOIN PARAMLF
	ON PARAMLF.ABREV = PARAMETRO.ABREV
	AND (PARAMLF.ANOPARAM || PARAMLF.MESPARAM) = PARAMETRO.COMPETENCIA
ORDER BY 1, 2