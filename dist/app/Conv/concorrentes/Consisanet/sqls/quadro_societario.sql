SELECT e1.CD_EMPRESA,
       e1.DT_ENTRADA AS DT_INICIOVIGENCIA,
       (SELECT SUM(e2.NR_COTACAPITAL)
          FROM EMPQUADROSOCIO e2
         WHERE e2.CD_EMPRESA = e1.CD_EMPRESA
           AND e2.DT_ENTRADA <= e1.DT_ENTRADA) AS VL_CAPITALSOCIAL
  FROM EMPQUADROSOCIO e1
 GROUP BY CD_EMPRESA,
          DT_INICIOVIGENCIA
 ORDER BY CD_EMPRESA;