WITH PRIMEIRO_LANCAMENTO AS (SELECT CD_EMPRESA,
       CD_EMPREGADO,
       MIN(DT_INICIAL) AS DT_INICIAL,
       CD_SINDI,
       CD_SINDIANT
  FROM HISTORICOPOSICAO
 WHERE CD_SINDIANT IS NOT NULL
 GROUP BY 1, 2, 4, 5
 ORDER BY 1, 2, 3)
SELECT PRIMEIRO_LANCAMENTO.CD_EMPRESA,
       PRIMEIRO_LANCAMENTO.CD_EMPREGADO,
       EMPREGADO.DT_ADMISSAO AS DT_INICIAL,
       CASE
        WHEN PRIMEIRO_LANCAMENTO.DT_INICIAL = EMPREGADO.DT_ADMISSAO THEN PRIMEIRO_LANCAMENTO.CD_SINDI
        ELSE PRIMEIRO_LANCAMENTO.CD_SINDIANT
       END AS CD_SINDI
  FROM PRIMEIRO_LANCAMENTO
  LEFT JOIN EMPREGADO
    ON EMPREGADO.CD_EMPRESA = PRIMEIRO_LANCAMENTO.CD_EMPRESA
   AND EMPREGADO.CD_EMPREGADO = PRIMEIRO_LANCAMENTO.CD_EMPREGADO
UNION
SELECT CD_EMPRESA,
       CD_EMPREGADO,
       DT_INICIAL,
       CD_SINDI
  FROM HISTORICOPOSICAO
 WHERE CD_SINDI IS NOT NULL
 ORDER BY 1, 2, 3;