SELECT c.CD_EMPRESA,
       c.CD_FILIAL,
       c.DS_FILIAL,
       c.DS_FANTASIA,
       c.DS_ENDERECO,
       c.DS_BAIRRO,
       (SELECT DS_MUNICIPIO
          FROM MUNICIPIO
         WHERE MUNICIPIO.CD_MUNICIPIO = c.CD_MUNICIPIO) AS CIDADE,
       (SELECT CD_MUNICIPIOIBGE
          FROM MUNICIPIO
         WHERE MUNICIPIO.CD_MUNICIPIO = c.CD_MUNICIPIO) AS CIDADE_IBGE,
       c.NR_CEP,
       c.NR_TELEFONE,
       c.NR_REGISTRO,
       c.TP_REGISTRO,
       c.NR_INSCRICAOESTADUAL,
       c.DS_EMAIL,
       LPAD(c.CD_CNAE1, 7, '0') AS CD_CNAE1,
       c.NM_RESPONSAVELRH,
       c.NR_CPFRESPONRH,
       c.DT_INICIOATIV,
       c.NR_ENDERECO,
       c.DS_COMPLEMENTO,
       c.NR_FAX,
       c.NR_REGISTROJUNTACOM,
       c.DT_REGISTROJUNTACOM,
       c.CD_FPAS,
       c.CD_TERCFPAS,
       COALESCE(c.CD_NATUREZA, (SELECT MAX(f.CD_LEGAL)
                                FROM NATUREZAJURECF AS f, EMPRESA AS e
                               WHERE f.CD_NATUREZAJURECF = e.CD_NATUREZAJURECF
                                 AND e.CD_EMPRESA = c.CD_EMPRESA)) AS CD_NATUREZA,
       c.NR_INSCRICAOMUNICIPAL,
       (SELECT SG_ESTADO
          FROM ESTADO
         WHERE ESTADO.CD_ESTADO = (SELECT CD_ESTADO
                                     FROM MUNICIPIO
                                    WHERE MUNICIPIO.CD_MUNICIPIO = c.CD_MUNICIPIO)) AS ESTADO,
       LPAD((SELECT CD_SUBCLASSE
               FROM CNAE
              WHERE CNAE.CD_CNAE = c.CD_CNAE), 7, '0') AS CNAE,
       a.NM_ADMCONT AS NM_ADMCONT_LEG,
       a.NR_CNPJCPF AS NR_CNPJCPF_LEG,
       a.DS_ENDERECO AS DS_ENDERECO_LEG,
       a.NR_ENDERECO AS NR_ENDERECO_LEG,
       a.DS_BAIRRO AS DS_BAIRRO_LEG,
       a.NR_CEP AS NR_CEP_LEG,
       (SELECT DS_MUNICIPIO
          FROM MUNICIPIO
         WHERE MUNICIPIO.CD_MUNICIPIO = a.CD_MUNICIPIO) AS MUNICIPIO_LEG,
       (SELECT CD_MUNICIPIOIBGE
          FROM MUNICIPIO
         WHERE MUNICIPIO.CD_MUNICIPIO = a.CD_MUNICIPIO) AS MUNICIPIO_IBGE_LEG,
       (SELECT SG_ESTADO
          FROM ESTADO
         WHERE ESTADO.CD_ESTADO = (SELECT CD_ESTADO
                                     FROM MUNICIPIO
                                    WHERE MUNICIPIO.CD_MUNICIPIO = a.CD_MUNICIPIO)) AS ESTADO_LEG,
       a.NR_TELEFONE AS NR_TELEFONE_LEG,
       a.DS_EMAIL AS DS_EMAIL_LEG,
       a.NR_RG AS NR_RG_LEG,
       a.DS_ORGAOEXPRG AS DS_ORGAOEXPRG_LEG,
       a.TP_PROFISSIONAL,
       (SELECT SG_ESTADO
          FROM ESTADO
         WHERE ESTADO.CD_ESTADO = a.CD_ESTADORG) AS ESTADO_LEG_RG,
       c.CD_CONTADOR,
	   (SELECT MAX(EMP.TP_GRUPOENQESOCIAL) FROM EMPRESA AS EMP WHERE EMP.CD_EMPRESA = c.CD_EMPRESA ) AS FASEAMENTO
  FROM CADFILFOLHAATRIB c
  LEFT JOIN ADMCONT a
    ON c.CD_ADMINISTRADOR = a.CD_ADMCONT
 ORDER BY c.CD_EMPRESA, c.CD_FILIAL;