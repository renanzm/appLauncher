SELECT DISTINCT
       emp.CD_EMPRESA,
       jorhor.CD_HORARIO,
       jorhor.NR_DIASEMANA,
       jorhor.CD_HORARIODC
  FROM EMPREGADO emp
  LEFT JOIN HISTORICOHORARIO his
    ON his.CD_EMPRESA = emp.CD_EMPRESA
   AND his.CD_EMPREGADO = emp.CD_EMPREGADO
  LEFT JOIN HORARIOI jorhor
    ON jorhor.CD_HORARIO IN (his.CD_HORARIOANTERIOR, his.CD_HORARIO)
    OR jorhor.CD_HORARIO IN (emp.CD_HORARIO)
 ORDER BY CD_EMPRESA, CD_HORARIO, NR_DIASEMANA;