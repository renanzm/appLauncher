SELECT CAST(aqui.COD_EMPRESA AS INTEGER) AS COD_EMPRESA,
       CAST(aqui.COD_EMPREGADO AS INTEGER) AS COD_EMPREGADO,
       CAST(aqui.AQUIS_INICIO AS DATE) AS AQUIS_INICIO,
       CAST(aqui.AQUIS_FIM AS DATE) AS AQUIS_FIM,
       CAST(gozo.DATA_INICIO AS DATE) AS GOZO_INICIO,
       CAST(gozo.DATA_FIM AS DATE) AS GOZO_FIM,
       CAST(gozo.DATA_PAGTO AS DATE) AS DATA_PAGTO,
       CAST(abono.DATA_INICIO AS DATE) AS ABONO_INICIO,
       CAST(abono.DATA_FIM AS DATE) AS ABONO_FIM,
       gozo.TIPO
  FROM FERIAS_QUITACAO gozo
  LEFT JOIN FERIAS_AVOS avos
    ON avos.IDFERIAS_AVOS = gozo.IDFERIAS_AVOS
  LEFT JOIN FERIAS_QUITACAO abono
    ON abono.IDFERIAS_AVOS = gozo.IDFERIAS_AVOS
   AND abono.TIPO = 4
  LEFT JOIN FERIAS_AQUISITIVO aqui
    ON aqui.IDFERIAS_AQUISITIVO = avos.IDFERIAS_AQUISITIVO
 WHERE aqui.AQUIS_INICIO IS NOT NULL
   AND aqui.AQUIS_FIM IS NOT NULL
   AND gozo.TIPO IN (1, 2, 3) -- 1 Ferias / (2, 3) Ferias Coletiva
 ORDER BY 1, 2, 3, 4;