SELECT CODIGO AS CODI_EMP, 
       '' AS CODIGO,
       RECIBOESOCIAL AS NUMERO_RECIBO,
       '' AS CODIGO_ESOCIAL,
       '1000' AS TIPO_EVENTO,
       '' AS AFASTAMENTO,
       '' AS DATA_TIPO_RESCISAO
  FROM EMPRESA
 WHERE RECIBOESOCIAL IS NOT NULL
   AND RECIBOESOCIAL <> '1'

UNION ALL

SELECT EMPRESA AS CODI_EMP,
       CAST(CODIGO AS VARCHAR(50)) AS CODIGO,
       RECIBOESOCIAL AS NUMERO_RECIBO,
       '' AS CODIGO_ESOCIAL,
       '1020' AS TIPO_EVENTO,
       '' AS AFASTAMENTO,
       '' AS DATA_TIPO_RESCISAO
  FROM ESTABELECIMENTO
 WHERE RECIBOESOCIAL <> ''
   AND RECIBOESOCIAL <> '1'

UNION ALL

SELECT EMPRESA AS CODI_EMP,
CODIGO,
RECIBOESOCIAL AS NUMERO_RECIBO,
CODIGO AS CODIGO_ESOCIAL,
'1030' AS TIPO_EVENTO,
'' AS AFASTAMENTO,
'' AS DATA_TIPO_RESCISAO
FROM CARGO
WHERE RECIBOESOCIAL <> ''
AND RECIBOESOCIAL <> '1'

UNION ALL

SELECT EMPRESA AS CODI_EMP,
CODIGO,
RECIBOESOCIAL AS NUMERO_RECIBO,
CODIGO AS CODIGO_ESOCIAL,
'1050' AS TIPO_EVENTO,
'' AS AFASTAMENTO,
'' AS DATA_TIPO_RESCISAO
FROM HORARIOTRABALHO
WHERE RECIBOESOCIAL <> ''
AND RECIBOESOCIAL <> '1'

UNION ALL

SELECT EMPRESA AS CODI_EMP,
CODIGO,
RECIBOESOCIAL AS NUMERO_RECIBO,
MATRICULA AS CODIGO_ESOCIAL,
'2200' AS TIPO_EVENTO,
'' AS AFASTAMENTO,
'' AS DATA_TIPO_RESCISAO
FROM FUNCIONARIO
WHERE CAST(VINCULOEMPREGATICIO AS VARCHAR(2)) IN ('10','15','20','25','30','40','50','60','65','70','88','90','95','96','97','98')
AND RECIBOESOCIAL <> ''
AND RECIBOESOCIAL <> '1'
AND MATRICULA <> ''
AND MATRICULA <> '0'

UNION ALL

SELECT EMPRESA AS CODI_EMP,
CODIGO,
RECIBOESOCIAL AS NUMERO_RECIBO,
MATRICULA AS CODIGO_ESOCIAL,
'2300' AS TIPO_EVENTO,
'' AS AFASTAMENTO,
'' AS DATA_TIPO_RESCISAO
FROM FUNCIONARIO
WHERE CATEGORIA IN (5,11,15,16,17,18,22,23,24,25)
AND RECIBOESOCIAL <> ''
AND RECIBOESOCIAL <> '1'
AND MATRICULA <> ''
AND MATRICULA <> '0'

UNION ALL

SELECT EMPRESA AS CODI_EMP,
AFASTAMENTO.FUNCIONARIO AS CODIGO,
AFASTAMENTO.RECIBOESOCIAL AS NUMERO_RECIBO,
AFASTAMENTO.FUNCIONARIO AS CODIGO_ESOCIAL,
'2230' AS TIPO_EVENTO,
DTSAIDAESOCIAL AS AFASTAMENTO,
'' AS DATA_TIPO_RESCISAO
FROM AFASTAMENTO
LEFT JOIN FUNCIONARIO
ON FUNCIONARIO.CODIGO = AFASTAMENTO.FUNCIONARIO
WHERE AFASTAMENTO.RECIBOESOCIAL <> ''
AND AFASTAMENTO.RECIBOESOCIAL <> '1'

UNION ALL

SELECT EMPRESA AS CODI_EMP,
CODIGO,
RECIBOESOCIAL AS NUMERO_RECIBO,
CODIGO AS CODIGO_ESOCIAL,
'1020' AS TIPO_EVENTO,
'' AS AFASTAMENTO,
'' AS DATA_TIPO_RESCISAO
FROM LOTACAO
WHERE RECIBOESOCIAL <> ''
AND RECIBOESOCIAL <> '1'

UNION ALL

SELECT S2205.EMPRESA AS CODI_EMP,
FUNCIONARIO AS CODIGO,
S2205.RECIBOESOCIAL AS NUMERO_RECIBO,
MATRICULA AS CODIGO_ESOCIAL,
'2205' AS TIPO_EVENTO,
'' AS AFASTAMENTO,
DTALTERACAO AS DATA_TIPO_RESCISAO
FROM S2205
LEFT JOIN FUNCIONARIO
ON FUNCIONARIO.CODIGO = S2205.FUNCIONARIO
WHERE S2205.RECIBOESOCIAL <> ''
AND S2205.RECIBOESOCIAL <> '1'

UNION ALL

SELECT S2206.EMPRESA AS CODI_EMP,
FUNCIONARIO AS CODIGO,
S2206.RECIBOESOCIAL AS NUMERO_RECIBO,
MATRICULA AS CODIGO_ESOCIAL,
'2206' AS TIPO_EVENTO,
'' AS AFASTAMENTO,
DTALTERACAO AS DATA_TIPO_RESCISAO
FROM S2206
LEFT JOIN FUNCIONARIO
ON FUNCIONARIO.CODIGO = S2206.FUNCIONARIO
WHERE S2206.RECIBOESOCIAL <> ''
AND S2206.RECIBOESOCIAL <> '1'
ORDER BY 1,2,5