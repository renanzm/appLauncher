SELECT EMP.CODIGO_EXTERNO AS EMPRESA,
       FUNC.CODIGO AS EMPREGADO,
       "WP-PESSOAL_TEMPO".DATA_TEMPO AS DATA_INICIAL,
       'I' AS TIPO_CADASTRO,
       NULL AS SERVICO,
       FIL.CODIGO_EXTERNO AS FILIAL
  FROM "WP-PESSOAL_TEMPO"
  LEFT JOIN "WP-PESSOAL_CONTRATOS" CONT
    ON CONT.PESSOAL_CONTRATOS_ID = "WP-PESSOAL_TEMPO".PESSOAL_CONTRATOS_ID
  LEFT JOIN "WP-PESSOAL" FUNC
    ON FUNC.PESSOAL_ID = CONT.PESSOAL_ID
  LEFT JOIN "G-EMPRESAS" EMP
    ON FUNC.EMPRESA_ID = EMP.CODIGO
  LEFT JOIN "G-FILIAIS" FIL
    ON FIL.CODIGO = "WP-PESSOAL_TEMPO".FILIAIS_ID
 WHERE "WP-PESSOAL_TEMPO".DATA_TEMPO = (SELECT MIN(x.DATA_TEMPO)
                                          FROM "WP-PESSOAL_TEMPO" x
                                         WHERE x.PESSOAL_CONTRATOS_ID = "WP-PESSOAL_TEMPO".PESSOAL_CONTRATOS_ID)
UNION ALL
SELECT EMP.CODIGO_EXTERNO AS EMPRESA,
       FUNC.CODIGO AS EMPREGADO,
       TRANSF.DATA_INICIAL,
       TOM.TIPO_LOCAL_LOTACAO AS TIPO_CADASTRO,
       TOM.CODIGO_EXTERNO AS SERVICO,
       FIL.CODIGO_EXTERNO AS FILIAL
  FROM "WP_CONTRATOS_LOTACOES_TRIB" TRANSF
  LEFT JOIN WP_LOTACOES_TRIBUTARIAS TOM
    ON TOM.LOTACOES_TRIBUTARIAS_ID = TRANSF.LOTACOES_TRIBUTARIAS_ID
  LEFT JOIN WP_LOTACOES_TRIBUTARIAS_FILIAIS TOM_FIL
    ON TOM_FIL.LOTACOES_TRIBUTARIAS_ID = TOM.LOTACOES_TRIBUTARIAS_ID
  LEFT JOIN "G-FILIAIS" FIL
    ON FIL.CODIGO = TOM_FIL.FILIAIS_ID
  LEFT JOIN "WP-PESSOAL_CONTRATOS" CONT
    ON CONT.PESSOAL_CONTRATOS_ID = TRANSF.PESSOAL_CONTRATOS_ID
  LEFT JOIN "WP-PESSOAL" FUNC
    ON FUNC.PESSOAL_ID = CONT.PESSOAL_ID
  LEFT JOIN "G-EMPRESAS" EMP
    ON FUNC.EMPRESA_ID = EMP.CODIGO
 ORDER BY 1, 2, 3;