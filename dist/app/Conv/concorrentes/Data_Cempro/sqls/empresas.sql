SELECT "G-EMPRESAS".CODIGO_EXTERNO,
"G-EMPRESAS".NOME,
"G-EMPRESAS".NOME_FANTASIA,
"G-EMPRESAS".CNPJ,
"G-EMPRESAS".CPF,
"G-EMPRESAS".CEI,
(SELECT MAX("G-FILIAIS".TIPO_CAEPF) FROM "G-FILIAIS" WHERE "G-FILIAIS".EMPRESA_ID = "G-EMPRESAS".CODIGO) as TIPO_CAEPF,
COALESCE("G-EMPRESAS".NUMERO_CAEPF, (SELECT MAX("G-FILIAIS".CNPJ) FROM "G-FILIAIS" WHERE "G-FILIAIS".EMPRESA_ID = "G-EMPRESAS".CODIGO) )AS NUMERO_CAEPF,
"G-EMPRESAS".INSCRICAOESTADUAL,
"G-EMPRESAS".INSCRICAOMUNICIPAL,
"G-EMPRESAS".INSCRICAOSUFRAMA,
"G-EMPRESAS".TIPO_LOGRADOURO,
"G-EMPRESAS".ENDERECO,
"G-EMPRESAS".ENDERECO_COMPLEMENTO,
"G-EMPRESAS".ENDERECO_NUMERO,
(SELECT "G-MUNICIPIOS".DESCRICAO FROM "G-MUNICIPIOS" WHERE "G-EMPRESAS".MUNICIPIOS_ID = "G-MUNICIPIOS".MUNICIPIOS_ID) AS CIDADE,
(SELECT "G-MUNICIPIOS".UF FROM "G-MUNICIPIOS" WHERE "G-EMPRESAS".MUNICIPIOS_ID = "G-MUNICIPIOS".MUNICIPIOS_ID) AS ESTADO,
(SELECT "G-MUNICIPIOS".CODIGO_IBGE FROM "G-MUNICIPIOS" WHERE "G-EMPRESAS".MUNICIPIOS_ID = "G-MUNICIPIOS".MUNICIPIOS_ID) AS CODIGO_IBGE,
"G-EMPRESAS".CEP,
"G-EMPRESAS".BAIRRO,
"G-EMPRESAS".HOMEPAGE,
"G-EMPRESAS".EMAIL,
"G-EMPRESAS".TELEFONE_DDD,
"G-EMPRESAS".TELEFONE,
"G-EMPRESAS".FAX,
"G-EMPRESAS".REGISTROJUNTA,
"G-EMPRESAS".DATAREGISTROJUNTA,
(SELECT MIN("G-EMPRESAS_FILIAIS".DATA_INICIO_ATIVIDADE) FROM "G-EMPRESAS_FILIAIS" WHERE "G-EMPRESAS_FILIAIS".EMPRESA_ID = "G-EMPRESAS".CODIGO ) as DATA_INICIO_ATIVIDADE,
(SELECT MIN("G-EMPRESAS_FILIAIS".NATUREZA_JURIDICA) FROM "G-EMPRESAS_FILIAIS" WHERE "G-EMPRESAS_FILIAIS".EMPRESA_ID = "G-EMPRESAS".CODIGO) as NATUREZA_JURIDICA,
"G-EMPRESAS".CNAEFISCAL,
"G-EMPRESAS".CAE,
"G-EMPRESAS".CNAE,
"G-EMPRESAS".CODIGO_ATIVIDADE,
"G-EMPRESAS".CODIGO_CONTABILISTA,
(SELECT "G-CONTABILISTAS".CPF FROM "G-CONTABILISTAS" WHERE "G-EMPRESAS".RESPONSAVEL_ID = "G-CONTABILISTAS".CODIGO) AS RESP_CPF,
(SELECT "G-CONTABILISTAS".NOME FROM "G-CONTABILISTAS" WHERE "G-EMPRESAS".RESPONSAVEL_ID = "G-CONTABILISTAS".CODIGO) AS RESP_NOME,
(SELECT "G-CONTABILISTAS".ENDERECO FROM "G-CONTABILISTAS" WHERE "G-EMPRESAS".RESPONSAVEL_ID = "G-CONTABILISTAS".CODIGO) AS RESP_ENDERECO,
(SELECT "G-CONTABILISTAS".ENDERECO_NUMERO FROM "G-CONTABILISTAS" WHERE "G-EMPRESAS".RESPONSAVEL_ID = "G-CONTABILISTAS".CODIGO) AS RESP_NUMERO,
(SELECT "G-CONTABILISTAS".ENDERECO_COMPLEMENTO FROM "G-CONTABILISTAS" WHERE "G-EMPRESAS".RESPONSAVEL_ID = "G-CONTABILISTAS".CODIGO) AS RESP_COMPLEMENTO,
(SELECT "G-CONTABILISTAS".CEP FROM "G-CONTABILISTAS" WHERE "G-EMPRESAS".RESPONSAVEL_ID = "G-CONTABILISTAS".CODIGO) AS RESP_CEP,
(SELECT "G-CONTABILISTAS".BAIRRO FROM "G-CONTABILISTAS" WHERE "G-EMPRESAS".RESPONSAVEL_ID = "G-CONTABILISTAS".CODIGO) AS RESP_BAIRRO,
(SELECT "G-MUNICIPIOS".DESCRICAO FROM "G-MUNICIPIOS", "G-CONTABILISTAS" WHERE "G-CONTABILISTAS".MUNICIPIOS_ID = "G-MUNICIPIOS".MUNICIPIOS_ID AND "G-EMPRESAS".RESPONSAVEL_ID = "G-CONTABILISTAS".CODIGO) AS RESP_CIDADE,
(SELECT "G-MUNICIPIOS".UF FROM "G-MUNICIPIOS", "G-CONTABILISTAS" WHERE "G-CONTABILISTAS".MUNICIPIOS_ID = "G-MUNICIPIOS".MUNICIPIOS_ID AND "G-EMPRESAS".RESPONSAVEL_ID = "G-CONTABILISTAS".CODIGO) AS RESP_ESTADO,
(SELECT "G-MUNICIPIOS".CODIGO_IBGE FROM "G-MUNICIPIOS", "G-CONTABILISTAS" WHERE "G-CONTABILISTAS".MUNICIPIOS_ID = "G-MUNICIPIOS".MUNICIPIOS_ID AND "G-EMPRESAS".RESPONSAVEL_ID = "G-CONTABILISTAS".CODIGO) AS RESP_CODIGO_IBGE,
(SELECT "G-CONTABILISTAS".TELEFONE_DDD FROM "G-CONTABILISTAS" WHERE "G-EMPRESAS".RESPONSAVEL_ID = "G-CONTABILISTAS".CODIGO) AS RESP_DDD,
(SELECT "G-CONTABILISTAS".TELEFONE FROM "G-CONTABILISTAS" WHERE "G-EMPRESAS".RESPONSAVEL_ID = "G-CONTABILISTAS".CODIGO) AS RESP_FONE,
(SELECT "G-CONTABILISTAS".CARGO FROM "G-CONTABILISTAS" WHERE "G-EMPRESAS".RESPONSAVEL_ID = "G-CONTABILISTAS".CODIGO) AS RESP_CARGO,
(SELECT "G-CONTABILISTAS".E_MAIL FROM "G-CONTABILISTAS" WHERE "G-EMPRESAS".RESPONSAVEL_ID = "G-CONTABILISTAS".CODIGO) AS RESP_EMAIL,
(SELECT "G-CONTABILISTAS".RG_NUMERO FROM "G-CONTABILISTAS" WHERE "G-EMPRESAS".RESPONSAVEL_ID = "G-CONTABILISTAS".CODIGO) AS RESP_RG,
(SELECT "G-CONTABILISTAS".RG_ORGAO_EXP FROM "G-CONTABILISTAS" WHERE "G-EMPRESAS".RESPONSAVEL_ID = "G-CONTABILISTAS".CODIGO) AS RESP_RG_ORGAO_EXP,
(SELECT "G-CONTABILISTAS".RG_UF FROM "G-CONTABILISTAS" WHERE "G-EMPRESAS".RESPONSAVEL_ID = "G-CONTABILISTAS".CODIGO) AS RESP_RG_UF,
"G-EMPRESAS".CODIGO
FROM "G-EMPRESAS"
ORDER BY "G-EMPRESAS".CODIGO_EXTERNO