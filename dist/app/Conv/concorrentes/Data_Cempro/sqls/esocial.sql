SELECT (SELECT "G-EMPRESAS".CODIGO_EXTERNO FROM "G-EMPRESAS" WHERE "G-EMPRESAS".CODIGO = WP_ESOCIAL_EVENTOS.EMPRESA_ID) AS CODI_EMP,
	   '' AS CODIGO,
	   NUMERO_RECIBO,
	   '' AS CODIGO_ESOCIAL,
	   NUMERO_EVENTO AS TIPO_EVENTO,
	   '' AS DATA_EVENTO
  FROM WP_ESOCIAL_EVENTOS LEFT JOIN WP_ESOCIAL_LOTES_EMPRESAS ON WP_ESOCIAL_EVENTOS.EMPRESA_ID = WP_ESOCIAL_LOTES_EMPRESAS.EMPRESA_ID 
						        AND WP_ESOCIAL_EVENTOS.ESOCIAL_EVENTOS_ID = WP_ESOCIAL_LOTES_EMPRESAS.ESOCIAL_EVENTOS_ID
 WHERE STATUS_COMUNICACAO = '201'
   AND NUMERO_EVENTO in ('1000')
 
UNION 
 
SELECT (SELECT "G-EMPRESAS".CODIGO_EXTERNO FROM "G-EMPRESAS" WHERE "G-EMPRESAS".CODIGO = WP_ESOCIAL_EVENTOS.EMPRESA_ID) AS CODI_EMP,
		WP_CARGOS.CARGOS_ID as CODIGO,
		WP_ESOCIAL_EVENTOS.NUMERO_RECIBO,
		WP_CARGOS.CODIGO AS CODIGO_ESOCIAL,
		WP_ESOCIAL_EVENTOS.NUMERO_EVENTO AS TIPO_EVENTO,
	   '' AS DATA_EVENTO
  FROM  WP_ESOCIAL_EVENTOS	LEFT JOIN WP_ESOCIAL_LOTES_EMPRESAS ON WP_ESOCIAL_EVENTOS.EMPRESA_ID = WP_ESOCIAL_LOTES_EMPRESAS.EMPRESA_ID 
								  AND WP_ESOCIAL_EVENTOS.ESOCIAL_EVENTOS_ID = WP_ESOCIAL_LOTES_EMPRESAS.ESOCIAL_EVENTOS_ID
							LEFT JOIN WP_ESOCIAL_LOTES_CARGOS   ON WP_ESOCIAL_EVENTOS.ESOCIAL_EVENTOS_ID = WP_ESOCIAL_LOTES_CARGOS.ESOCIAL_EVENTOS_ID
							LEFT JOIN WP_CARGOS ON WP_CARGOS.CARGOS_ID = WP_ESOCIAL_LOTES_CARGOS.CARGOS_ID
						  		  AND WP_CARGOS.EMPRESA_ID = WP_ESOCIAL_EVENTOS.EMPRESA_ID
 WHERE STATUS_COMUNICACAO = '201'
   AND NUMERO_EVENTO in ('1030')
 
UNION 
 
SELECT (SELECT "G-EMPRESAS".CODIGO_EXTERNO
          FROM "G-EMPRESAS"
         WHERE "G-EMPRESAS".CODIGO = WP_ESOCIAL_EVENTOS.EMPRESA_ID) AS CODI_EMP,
       "WP-PESSOAL".CODIGO,
       WP_ESOCIAL_EVENTOS.NUMERO_RECIBO,
       "WP-PESSOAL".CPF_NRO || '_' || "WP-PESSOAL_CONTRATOS".REGISTRO AS CODIGO_ESOCIAL,
       WP_ESOCIAL_EVENTOS.NUMERO_EVENTO AS TIPO_EVENTO,
       '' AS DATA_EVENTO
  FROM WP_ESOCIAL_EVENTOS
  LEFT JOIN WP_ESOCIAL_LOTES_EMPRESAS
    ON WP_ESOCIAL_EVENTOS.EMPRESA_ID = WP_ESOCIAL_LOTES_EMPRESAS.EMPRESA_ID 
   AND WP_ESOCIAL_EVENTOS.ESOCIAL_EVENTOS_ID = WP_ESOCIAL_LOTES_EMPRESAS.ESOCIAL_EVENTOS_ID
  LEFT JOIN "WP-PESSOAL"
    ON "WP-PESSOAL".PESSOAL_ID = WP_ESOCIAL_EVENTOS.PESSOAL_ID 
   AND "WP-PESSOAL".EMPRESA_ID = WP_ESOCIAL_EVENTOS.EMPRESA_ID
  LEFT JOIN "WP-PESSOAL_CONTRATOS"
    ON "WP-PESSOAL_CONTRATOS".PESSOAL_ID = WP_ESOCIAL_EVENTOS.PESSOAL_ID
   AND "WP-PESSOAL_CONTRATOS".PESSOAL_CONTRATOS_ID = WP_ESOCIAL_EVENTOS.PESSOAL_CONTRATOS_ID
 WHERE STATUS_COMUNICACAO in('201','202')
   AND NUMERO_EVENTO in ('2200','2300')
   
 UNION 
 
SELECT (SELECT "G-EMPRESAS".CODIGO_EXTERNO
          FROM "G-EMPRESAS"
         WHERE "G-EMPRESAS".CODIGO = WP_ESOCIAL_EVENTOS.EMPRESA_ID) AS CODI_EMP,
       "WP-PESSOAL".CODIGO,
       WP_ESOCIAL_EVENTOS.NUMERO_RECIBO,
       "WP-PESSOAL".CPF_NRO || '_' || COALESCE("WP-PESSOAL_CONTRATOS".REGISTRO, "WP-PESSOAL".CODIGO) AS CODIGO_ESOCIAL,
       WP_ESOCIAL_EVENTOS.NUMERO_EVENTO AS TIPO_EVENTO,
       WP_ESOCIAL_EVENTOS.DATA_CONTROLE_RETIFICACAO AS DATA_EVENTO
  FROM WP_ESOCIAL_EVENTOS
  LEFT JOIN WP_ESOCIAL_LOTES_EMPRESAS
    ON WP_ESOCIAL_EVENTOS.EMPRESA_ID = WP_ESOCIAL_LOTES_EMPRESAS.EMPRESA_ID 
   AND WP_ESOCIAL_EVENTOS.ESOCIAL_EVENTOS_ID = WP_ESOCIAL_LOTES_EMPRESAS.ESOCIAL_EVENTOS_ID
  LEFT JOIN "WP-PESSOAL"
    ON "WP-PESSOAL".PESSOAL_ID = WP_ESOCIAL_EVENTOS.PESSOAL_ID 
   AND "WP-PESSOAL".EMPRESA_ID = WP_ESOCIAL_EVENTOS.EMPRESA_ID
  LEFT JOIN "WP-PESSOAL_CONTRATOS"
    ON "WP-PESSOAL_CONTRATOS".PESSOAL_ID = WP_ESOCIAL_EVENTOS.PESSOAL_ID
   AND "WP-PESSOAL_CONTRATOS".PESSOAL_CONTRATOS_ID = WP_ESOCIAL_EVENTOS.PESSOAL_CONTRATOS_ID
 WHERE STATUS_COMUNICACAO in('201','202')
   AND NUMERO_EVENTO in ('2205','2206')
   
 ORDER BY 1, 5, 2, 3