SELECT emp.idfuncionario,
emp.cdchamada,
emp.nmfuncionario,
emp.nmendereco,
emp.nrendereco,
emp.nmcomplemento,
emp.nmbairro,
emp.nmcidade,
emp.cduf,
emp.nrcep,
emp.nrddd,
emp.nrtelefone,
emp.nrcelular,
emp.dtnascimento,
emp.tpestadocivil,
emp.tpsexo,
emp.nmnacionalidade,
emp.nranochegada,
emp.tpinstrucao,
emp.tpinstrucaorais,
emp.dtvctoexperiencia,
emp.dtprorrogacaoexperiencia,
emp.dtadmissao,
emp.dttransferencia,
emp.tpcausatransferencia,
emp.dtdemissao,
emp.tpcausademissao,
emp.stavisoindenizado,
emp.stterminocontrato,
emp.tpvinculo,
emp.dtvctoatestado,
emp.iddepartamento,
emp.idfuncao,
emp.vlsalariobase,
emp.tpformapgto,
emp.nrminpordia,
emp.stprimtrabcaged,
emp.tpreintegracao,
emp.nrlivroficharegistro,
emp.tplivroficharegistro,
emp.nrfolhalivroficharegistro,
emp.dsobservacaorecibo,
emp.idagencia,
emp.nrcontacorrente,
emp.idbanco,
emp.cdcamaracompensacao,
emp.tpcontribuicaosindical,
emp.cdretencaoirrf,
emp.tpfaixainss,
emp.stadiantamento,
emp.aladiantamento,
emp.alvaletransporte,
emp.idsindicatogrcs,
emp.nridentidade,
emp.nmorgaoexpedidor,
emp.dtexpedicao,
emp.tpidentifpispasep,
emp.cdufexpedicao,
emp.nrpispasep,
emp.dtpis,
emp.nrcpf,
emp.nrctps,
emp.nrseriectps,
emp.cdufctps,
emp.nrcertificadoreservista,
emp.nrserie,
emp.nrcategoriamilitar,
emp.nrtituloeleitor,
emp.nrzonaeleitoral,
emp.nrsecaoeleitoral,
emp.nrcarteirahabilitacao,
emp.dtvctohabilitacao,
emp.tphabilitacao,
emp.dtvalcarteiraidentest,
emp.tpvistoestrangeiro,
emp.dtvalidadecarttrabest,
emp.nrcontafgts,
emp.cdufcontafgts,
emp.stmudouenderecofgts,
emp.dtopcaofgts,
emp.vlsaldofgts,
emp.dsobservacao,
emp.idhorario,
emp.dsfoto,
emp.nmmae,
emp.nmpai,
emp.vllimitecredito,
emp.nrcartaoponto,
emp.dtavisoprevio,
emp.stavisoprevio,
emp.tpocorrencia,
emp.tpcategoria,
emp.tpcartaosalario,
emp.nmagenciabkfolha,
emp.nrcepagenciabkfolha,
emp.cddocbkfolha,
emp.nrbancobkfolha,
emp.stfgtsmesanterior,
emp.tpfuncaposentado,
emp.tpcorraca,
emp.stdeficiente,
emp.streabilitado,
emp.strestantecontrato,
emp.qtdiastrabalhados,
emp.qtdiassalariofamilia,
emp.qtdiasfaltasproporcionais,
emp.qtdiasfaltas,
emp.qtfaltasperiodoaquisitivo,
emp.usuarioswmail,
emp.stsituacaolegal,
emp.cdocupacaoprincipal,
emp.cdnaturezaocupacao,
emp.cdufnascimento,
emp.nmmunnascimento,
emp.idbancopis,
emp.idagenciapis,
emp.nrdecretonaturalizado,
emp.qtavosperdidos,
emp.qtdiastrabnaopagos,
emp.stgerarais,
emp.dtvenctoaprendizagem,
emp.tranfpoutraemp,
emp.dscausademissao,
emp.stindalvara,
emp.nmcurto,
emp.tipobeneficioticket,
emp.dtestabilidade,
emp.stimprimeetiqueta,
emp.stimprimefolhaponto,
emp.nrcartaoticket,
emp.dtentrada,
emp.dsinformacoes,
emp.tppagamentorais,
emp.nrci,
emp.tipodeficiencia,
emp.dtinicialprocesso,
emp.dtfinalprocesso,
emp.nrprocesso,
emp.nrvaraprocesso,
emp.nranoprocesso,
emp.dtalteracaocad,
emp.dtultrescisao,
emp.cdmotivorct,
emp.tpcontrato,
emp.motivo_estabilidade,
emp.prorrogacao_tempo_determindado,
emp.alpensaofgts,
emp.tipo_conta,
emp.tipo_certidao_civil,
emp.data_certidao_civil,
emp.termo_matricula_certidao_civil,
emp.livro_certidao_civil,
emp.folha_certidao_civil,
emp.cartorio_certidao_civil,
emp.uf_certidao_civil,
emp.municipio_certidao_civil,
emp.quantidade_dias_ferias,
emp.tipo_identidade,
emp.inscricao_orgao_classe,
emp.emissor_orgao_classe,
emp.data_expedicao_orgao_classe,
emp.data_validade_orgao_classe,
emp.orgao_emissor_cnh,
emp.data_expedicao_cnh,
emp.tipo_logradouro,
emp.residencia_propria,
emp.utilizou_recursos_fgts,
emp.data_chegada,
emp.casado_com_brasileiro,
emp.filho_com_brasileiro,
emp.data_naturalizacao,
emp.pais_nascimento_id,
emp.pais_residencia_id,
emp.municipio_nascimento_ibge_codigo,
emp.municipio_residencia_ibge_codigo,
emp.codigo_postal,
emp.tipo_admissao,
emp.indicativo_admissao,
emp.cnpj_vinculo_anterior,
emp.matricula_vinculo_anterior,
emp.data_inicio_vinculo_anterior,
emp.observacao_transferencia,
emp.admissao_especial_caged,
emp.aviso_trabalhado_fixo_30_dias,
emp.uf_emissor_cnh,
emp.data_primeira_cnh,
emp.tipo_condicao_trabalhador_estrangeiro,
emp.tipo_jornada_trabalho,
emp.tipo_contratacao_temporaria,
emp.tipo_provimento,
emp.numero_recibo_admissao_preliminar,
emp.banco_adicional_id,
emp.agencia_adicional_id,
emp.numero_conta_corrente_adicional,
emp.tipo_conta_adicional,
emp.deficiencia_fisica,
emp.deficiencia_auditiva,
emp.deficiencia_visual,
emp.deficiencia_mental,
emp.deficiencia_intelectual,
emp.tipo_cumprimento_aviso,
emp.rescisao_sabado_compensado,
emp.categoria_trabalhador_esocial,
emp.sem_horario_fixo,
emp.nao_atualiza_salario,
emp.mensagem_escala_id,
emp.tipo_transportador,
emp.cota_deficiente,
emp.temporario_justificativa_legal,
emp.temporario_tipo_inclusao,
emp.matricula_esocial,
emp.salario_variavel_descricao,
emp.regime_previdenciario,
emp.lei_anistia,
emp.remuneracoes_pagas_juizo,
emp.transferencia_esocial_causa,
emp.reintegracao_tipo,
emp.natureza_atividade_trabalhador,
emp.cheque_pagamento,
emp.cheque_banco_id,
emp.caged_regime_de_tempo_parcial,
emp.indicador_aviso_previo,
emp.cnpj_empresa_sucessora,
emp.observacao_esocial,
emp.forma_pagamento_id,
emp.orgao_classe_uf,
emp.horas_semanais,
emp.jornada_tipo_descricao,
emp.controlar_no_gerente_esocial,
emp.reintegracao_processo_numero,
emp.reintegracao_data_efeito_financeiro,
emp.reintegracao_data_retorno,
emp.dados_contrato_determinado,
emp.possui_clausula_assecuratoria,
emp.esocial_identificado_no_ret,
emp.inativo_folha,
emp.tempo_residencia,
emp.horario_noturno,
emp.tipo_jornada_esocial,
emp.reintegracao_avos_13_pagos,
emp.curso_cetpp,
emp.pontuacao_cnh,
emp.data_consulta_cnh,
emp.observacao_cnh,
emp.sem_matricula_esocial,
emp.cargo_funcao_acumulavel,
emp.temporario_estab_nrinscricao,
emp.processo_trabalhista_demissao,
emp.processo_trabalhista_2200,
emp.contratacao_por_empresa_cotista,
emp.nrhorames,
emp.inscricao_entidade,
emp.tipo_chave_pix,
emp.chave_pix,
emp.nmsocial,
emp.indicativo_nif,
emp.nif,
emp.forma_tributacao,
emp.qtdiasindenizados,
CASE
    WHEN TO_DATE(emp.dtexpedicaoctps::TEXT, 'YYYY-MM-DD') IS NULL THEN DATE '1900-01-01'
	WHEN TO_DATE(emp.dtexpedicaoctps::TEXT, 'YYYY-MM-DD') < DATE '1900-01-01' THEN DATE '1900-01-01'
	WHEN TO_DATE(emp.dtexpedicaoctps::TEXT, 'YYYY-MM-DD') > DATE '9999-12-31' THEN DATE '1900-01-01'
	ELSE TO_DATE(emp.dtexpedicaoctps::TEXT, 'YYYY-MM-DD')
END AS dtexpedicaoctps,
transf.empresa_origem_id,
transf.funcionario_origem_id,
transf.data_transferencia
FROM wdp.f{codi_emp} AS emp
LEFT JOIN wdp.historico_transferencia_funcionario AS transf
ON emp.idfuncionario = transf.funcionario_destino_id
AND transf.empresa_destino_id = cast('{codi_emp}' AS integer)
ORDER BY 2