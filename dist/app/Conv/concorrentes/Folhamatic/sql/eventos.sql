SELECT DISTINCT 
       '{empresa}' AS CODEMP,
	   EVENTOS.COD AS CODEVEN,
	   EVENTOS.DESCRICAO,
	   EVENTOS.ROTINA,
	   (SELECT 'S' FROM GENFOLHA.MEDIAS13 WHERE MEDIAS13.codeven = EVENTOS.cod LIMIT 1) AS MED_13,
	   (SELECT 'S' FROM GENFOLHA.MEDIASFER WHERE MEDIASFER.codeven = EVENTOS.cod LIMIT 1) AS MED_FER
FROM GENFOLHA.EVENTOS AS EVENTOS
WHERE EXISTS (SELECT 1 
              FROM f{empresa}.HOLERITH AS H 
			  WHERE H.CODEVEN = EVENTOS.COD 
				AND H.ANOMES ~ '^[0-9]+$' 
				AND CAST(H.ANOMES AS INTEGER) > CAST((EXTRACT(YEAR FROM CURRENT_DATE) - 2) || '01' AS INTEGER))
ORDER BY 1, 2