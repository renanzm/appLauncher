WITH COLABORADOR_CONTRATO_ATUAL AS (
	SELECT SUB.ID_COLABORADOR,
	       MAX(SUB.DATA_ALTERACAO) AS DATA_ALTERACAO_ATUAL
	FROM COLABORADOR_CONTRATO AS SUB	
	GROUP BY 1
)
SELECT func.COD_EMP,
		func.TIPO,
		func.COD_FUN,
		func.NOME,
		func.ENDERECO,
		func.NUMERO,
		func.COMPLEMENTO,
		func.BAIRRO,
		func.UF,
		func.CEP,
		func.COD_CBO,
		func.COD_CIDADE,
		func.DDD_FONE,
		func.FONE1,
		func.FONE2,
		func.DDD_FAX,
		func.FAX1,
		func.SITE,
		func.EMAIL,
		func.FUNCAO,
		func.DATA_NASCIMENTO,
		func.DATA_ADMISSAO_REAL,
		func.CTPS_UF,
		func.CHAPA,
		func.PIS,
		func.DATA_OPCAO,
		func.CONTA_FGTS,
		func.CONTA_FGTS_UF,
		func.OCORRENCIA,
		func.PIS_DATA,
		func.OUTROS_VINCULOS,
		func.DATA_DEMISSAO,
		func.MOTIVO_DEMISSAO,
		func.DATA_APOSENTADORIA,
		func.TIPO_APOSENTADORIA,
		func.INSCR_INSS,
		colc.ID_CATEGORIA AS CATEGORIA,
		func.CPF,
		colc.IND_TP_SALARIO AS TIPO_SALARIO,
		func.CTPS_NUMERO,
		func.CTPS_SERIE,
		func.CTPS_VALIDADE,
		func.CTPS_DATA,
		func.COD_PAG_GPS,
		func.NOME_MAE,
		func.NOME_PAI,
		func.SEXO,
		func.ESTADO_CIVIL,
		func.RACA_COR,
		func.DEFICIENTE,
		func.NACIONALIDADE,
		func.ANO_CHEGADA,
		func.INSTRUCAO,
		func.VINCULO_RAIS,
		func.NATURALIDADE,
		func.NATURALIDADE_UF,
		func.CIPA,
		func.RG_NUM,
		func.RG_ORGAO,
		func.RG_UF,
		func.RG_DATA,
		func.RG_VALIDADE,
		func.VISTO,
		func.CR_NUMERO,
		func.CR_REGIAO,
		func.TIPO_ADM,
		func.AGENCIA,
		func.CONTA,
		func.CESTA_BASICA,
		func.CESTA_DESCONTO,
		func.VR_VALOR,
		func.VR_TIPO,
		func.VR_DESCONTO,
		func.VT_TIPO,
		func.ADICIONAL_SF,
		func.DSR_AUTOMATICO,
		func.DSR_SALARIO,
		func.DSR_ADC_NOT,
		func.DSR_ADC_PER,
		func.DSR_ADC_INS,
		func.SINDICAL_ANUAL,
		func.DSR_ADC_CXA,
		func.EXPERIENCIA_INI,
		func.EXPERIENCIA_FIM,
		func.PRORROGACAO_EXP_INI,
		func.PRORROGACAO_EXP_FIM,
		func.ADC_INS_ALIQUOTA,
		func.ADC_PER_ALIQUOTA,
		func.ADC_NOT_ALIQUOTA,
		func.ADC_NOT_HORAS,
		func.DATA_AVISO_PREVIO,
		colc.JORN_HORAS_MENSAIS AS HORAS_MENSAIS,
		colc.JORN_HORAS_SEMANA AS HORAS_SEMANAIS,
		colc.JORN_HORAS_DIARIA AS HORAS_DIARIAS,
		func.SOCIO_RESPONSAVEL,
		func.OUTRO_VINC1,
		func.OUTRO_VINC2,
		func.OUTRO_VINC3,
		func.DESCONTO_INSS,
		func.MUDA_CLASSE,
		func.ALIQ_SERV,
		func.DEDUCAO_GPS_EMP,
		func.INICIO_RECTRI,
		func.COD_SIND,
		func.TIPO_SIND,
		func.COD_BANCO,
		func.COD_CUSTO,
		func.COD_GORJETA,
		colc.ID_JORNADA AS COD_HORARIO,
		func.PENSAO,
		func.ALIQ_VT,
		func.COD_CBO02,
		func.CNPJ,
		func.TITULOELEITOR,
		func.HABILITACAO,
		func.RESERVISTA,
		func.CATEGORIA_HABILIT,
		func.FOTO,
		func.VR_SABADO,
		func.RAZAO_CC,
		func.DIAS_EXP,
		func.DIAS_PRORROG,
		func.CURSO,
		func.INSTITUICAO,
		func.COD_OP_PLANO,
		func.VLR_PLANO,
		func.TITULO_ZONA,
		func.TITULO_SECAO,
		func.CERTIDAOCIVIL_CARTORIO,
		func.DATA_CHEGADA,
		func.CERTIDAOCIVIL_TIPO,
		func.CERTIDAOCIVIL_EMISSAO,
		func.CERTIDAOCIVIL_TERMO,
		func.CERTIDAOCIVIL_LIVRO,
		func.CERTIDAOCIVIL_FOLHA,
		func.CERTIDAOCIVIL_UF,
		func.CERTIDAOCIVIL_CODCIDADE,
		func.COD_FEBRABAN,
		func.ESOCIAL_QUALIFICACAO,
		func.ESOCIAL_ULT_QUALIFICACAO,
		func.ESOCIAL_ESTABILIDADE,
		func.ESOCIAL_EST_DTINI,
		func.ESOCIAL_EST_DTFIM,
		func.ESOCIAL_EST_OBS,
		func.ESOCIAL_S2100,
		func.ESOCIAL_S2100_ENVIO,
		func.RECEB_SD,
		func.SOCIO_SCP,
		func.DIARISTA,
		func.FGTSDIARISTA,
		func.DATA_PROJECAO,
		func.MOTORISTA,
		func.ESOCIAL_S2190,
		func.ESOCIAL_S2200,
		func.ESOCIAL_S2205,
		func.ESOCIAL_S2206,
		func.RURAL,
		func.DATA_DEMISSAO_PREVISAO,
		func.OBSERVACAO_AVISO,
		func.TIPO_AVISO,
		func.OPCAO_AVISO,
		func.DATA_AVISO_CANC,
		func.OBSERVACAO_AVISO_CANC,
		func.MOTIVO_AVISO_CANC,
		func.COTA_DEFIC,
		func.ESTR_DT_CHEGADA,
		func.ESTR_CLF_COND,
		func.ESTR_CASAD_COM_BRA,
		func.ESTR_FILHOS_BRA,
		func.ESTR_RNE,
		func.ESTR_ORG_UF_RNE,
		func.ESTR_DT_EXP_RNE,
		func.TESTEMUNHA_1_NOME,
		func.TESTEMUNHA_2_NOME,
		func.TESTEMUNHA_1_CPF,
		func.TESTEMUNHA_2_CPF,
		func.LOCAIS_TRABALHO,
		func.CANCELAMENTO_SERVICO,
		func.PRAZO_PAGAMENTO,
		func.LOCAL_PAGAMENTO,
		func.INF_EST_NAT_ESTAGIO,
		func.INF_EST_NIV_ESTAGIO,
		func.INF_EST_AREA_ATUACAO,
		func.INF_EST_NR_APOL,
		func.INF_EST_VLR_BOLSA,
		func.INF_EST_DT_PREV_TERM,
		func.INF_EST_INST_ENS_CNPJ,
		func.INF_EST_INST_ENS_NM_RAZAO,
		func.INF_EST_INST_ENS_DSC_LOGRAD,
		func.INF_EST_INST_ENS_NR_LOGRAD,
		func.INF_EST_INST_ENS_BAIRRO,
		func.INF_EST_INST_ENS_CEP,
		func.INF_EST_INST_ENS_COD_MUNIC,
		func.INF_EST_INST_ENS_UF,
		func.INF_EST_AGE_INTEG_CNPJ,
		func.INF_EST_AGE_INTEG_NM_RAZAO,
		func.INF_EST_AGE_INTEG_DSC_LOGRAD,
		func.INF_EST_AGE_INTEG_NR_LOGRAD,
		func.INF_EST_AGE_INTEG_BAIRRO,
		func.INF_EST_AGE_INTEG_CEP,
		func.INF_EST_AGE_INTEG_COD_MUNIC,
		func.INF_EST_AGE_INTEG_UF,
		func.INF_EST_SUPV_EST_CPF_SUPV,
		func.INF_EST_SUPV_EST_NM_SUPV,
		func.DSC_SAL_VAR,
		func.NM_SOCIAL,
		func.TP_LOGRAD,
		func.EXT_PAIS_RESID,
		func.EXT_DSC_LOGRAD,
		func.EXT_NR_LOGRAD,
		func.EXT_COMPL,
		func.EXT_BAIRRO,
		func.EXT_NM_CID,
		func.EXT_COD_POSTAL,
		func.ESOCIAL_PAIS_NASCTO,
		func.ESOCIAL_PAIS_NAC,
		func.CNH_DTPRIMEIRO,
		func.CNH_DTEXPEDICAO,
		func.CNH_DTVALIDADE,
		func.CNH_UF,
		func.CR_DTEXPEDICAO,
		func.CR_DTVALIDADE,
		func.CR_UF,
		func.RIC_NUMERO,
		func.RIC_EMISSOR,
		func.RIC_DTEXPEDICAO,
		func.RIC_UF,
		func.ID_CAT_HAB,
		func.COD_EMP_ADMITIDO,
		func.TIPO_ADMISSAO,
		func.MATRICULA,
		func.DATA_ALTERACAO,
		func.DATA_TRANSFERENCIA,
		func.COD_EMP_ATIVO,
		func.TIPO_JORNADA_TRAB,
		func.INF_CEL_TIPOADM,
		func.INF_CEL_CNPJ_EMPANT,
		func.INF_CEL_MATRICULAANT,
		func.INF_CEL_DTTRANSFERENCIA,
		func.CODIGO_OPCIONAL,
		func.ID_TPREINT,
		func.NR_PROC_REINT,
		func.NR_LEI_REINT,
		func.DATA_RETORNO_REINT,
		func.DATA_EFEITO_REINT,
		func.IND_PGTO_JUIZO_REINT,
		func.IND_CUMPR_AVIS_PREV,
		func.DATA_ADMISSAO,
		func.TRB_TEMP_HIP_LEGAL,
		func.TRB_TEMP_JUST_HIP,
		func.TRB_TEMP_JUST_PRORR,
		func.TRB_TEMP_TIPO_INC,
		func.TRB_TEMP_TRAB_SUBST_CPF,
		func.TRB_TEMP_EMP_CONTR_TP_INSC,
		func.TRB_TEMP_EMP_CONTR_NR_INSC,
		func.TRB_TEMP_EMP_VINC_TP_INSC,
		func.TRB_TEMP_EMP_VINC_NR_INSC,
		func.TRB_TEMP_LOCAL_TRAB_TP_LOGRAD,
		func.TRB_TEMP_LOCAL_TRAB_DSC_LOGRAD,
		func.TRB_TEMP_LOCAL_TRAB_NR_LOGRAD,
		func.TRB_TEMP_LOCAL_TRAB_COMPL,
		func.TRB_TEMP_LOCAL_TRAB_BAIRRO,
		func.TRB_TEMP_LOCAL_TRAB_CEP,
		func.TRB_TEMP_LOCAL_TRAB_COD_MUNIC,
		func.TRB_TEMP_LOCAL_TRAB_UF,
		func.OUTRO_VINC_IND_MV,
		func.OUTRO_VINC_TP_INSC1,
		func.OUTRO_VINC_NR_INSC1,
		func.OUTRO_VINC_DSC_EMP1,
		func.OUTRO_VINC_COD_CATEG1,
		func.OUTRO_VINC_TP_INSC2,
		func.OUTRO_VINC_NR_INSC2,
		func.OUTRO_VINC_DSC_EMP2,
		func.OUTRO_VINC_COD_CATEG2,
		func.OUTRO_VINC_TP_INSC3,
		func.OUTRO_VINC_NR_INSC3,
		func.OUTRO_VINC_DSC_EMP3,
		func.OUTRO_VINC_COD_CATEG3,
		func.DTALTERDADOSPESSOAIS,
		func.ID_STATUS,
		func.ID_STATUS2206,
		func.DTALTERDADOSCONTRAT,
		func.DSR_INTEGRAL,
		func.REINT_EMP,
		func.REINT_FUN,
		func.REINT_TIPO,
		func.SV_TP_INSC_ANT,
		func.SV_DOCUMENTO_ANT,
		func.SV_MATRICULA_ANT,
		func.SV_DATA_TRANSF,
		func.SV_OBSERVACAO,
		func.INDSIMPLES,
		func.OBSERVACAO_S2205,
		func.OBSERVACAO_S2206,
		func.SINCRONIZA,
		func.ASSINATURA,
		func.ESTR_TEMPO_RESIDENCIA,
		func.ID_COLABORADOR_PRE,
		func.ID_USUARIO,
		func.ID_ESL_DESLIGAMEMTO_TSV,
		func.IND_USA_MATRICULA,
		func.IND_AVISO_DESCONTO,
		func.IND_MULTA_CONTRATO,
		func.DS_ID_CATEGORIA,
		func.DS_IND_INSCRICAO,
		func.DS_DOCUMENTO,
		func.DS_DATA_ADMISSAO,
		func.DS_MATRICULA,
		func.DS_IND_REGTRAB,
		func.DS_IND_REGPREV,
		func.IND_ESL_TRANSMITIR,
		func.IND_USA_IR_SIMPLIF,
		func.IND_DOCUMENTO_SV,
		func.DOCUMENTO_SV,
		func.IND_ESTAGIARIO,
		func.IND_DIRSIND,
		func.PERC_CAPITAL,
		func.SINCRONIZA_DEPENDENTE,
		cat.ID_ESL_CATEGORIA
FROM FUNCIONARIO func
LEFT JOIN COLABORADOR cola
  ON cola.ID_CONTRIBUINTE = func.COD_EMP
  AND cola.CODIGO_FUNCIONARIO = func.COD_FUN
  AND cola.TP_FUNCIONARIO = func.TIPO
LEFT JOIN COLABORADOR_CONTRATO_ATUAL colca
  ON colca.ID_COLABORADOR = cola.ID_COLABORADOR
LEFT JOIN COLABORADOR_CONTRATO colc
  ON colc.ID_COLABORADOR = cola.ID_COLABORADOR
  AND colca. DATA_ALTERACAO_ATUAL = colc.DATA_ALTERACAO
LEFT JOIN CATEGORIA cat
  ON cat.ID_CATEGORIA = colc.ID_CATEGORIA
ORDER BY 1, 2, 3