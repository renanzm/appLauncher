SELECT CEMP AS EMPRESA, AUTONOMOS.*
FROM AUTONOMOS
WHERE CEMP IS NOT NULL

UNION 

SELECT DISTINCT RPA.EMPR AS EMPRESA, AUTONOMOS.*
FROM RPA
INNER JOIN AUTONOMOS
ON RPA.AUTO = AUTONOMOS.CODI
WHERE AUTONOMOS.CEMP IS NULL AND 
	  AUTONOMOS.TRABNATUREZA IS NOT NULL AND
     (RPA.NUME = 1 OR RPA."DATA" = (SELECT MAX(SUB.DATA) FROM RPA AS SUB WHERE SUB.EMPR = RPA.EMPR AND SUB.AUTO = RPA.AUTO)) 
ORDER BY 1, 2