SELECT DISTINCT CODI,
NOME,
NOMEFULL,
ENDE,
NUME,
TIPO_ENDER,
COMP,
BAIR,
CIDA,
ESTA,
NCEP,
FONE,
FONE2,
SEXO,
NACI,
ANCH,
NASC,
ESCI,
NATU,
INST,
CARG,
NURG,
NCRM,
SGLCONF,
NCPF,
PISP,
HABI,
MILI,
ELEI,
ZONA,
CART,
LIVR,
FICH,
NCBO,
NCBON,
CONT,
ADMI,
SIND,
FUN1,
MFUN,
FUN2,
CON1,
MCON,
CON2,
OPCA,
CEBA,
VARE,
VRQT,
VRUN,
VAT1,
MVAT,
VAT2,
TVAT,
DTRA,
TSAB,
PHAB,
IHAB,
EXPE,
DUEM,
UPAI,
UPAF,
UPGI,
UPGF,
QHSE,
CONC,
BANC,
DPSE,
CODN,
DEMI,
AVIS,
CAUS,
SAQU,
HOMO,
CHE1,
CHE2,
QHAC,
CRSR,
PRSR,
NPAI,
NMAE,
VINC,
JRCS,
MRCS,
QHRM,
QH31,
CRHR,
PTCE,
STCE,
RECI,
SALB,
QTDE,
TREF,
BCAL,
DORE,
VORE,
SALD,
TROE,
CATE,
CPRO,
APGF,
NRAZ,
TCON,
RACA,
DEFI,
HORA,
ADIA,
ESTAT,
SERV,
DIA_AVI,
LADI,
RES_COMP,
TUTEIS,
EMI_RG,
EMI_CTPS,
CALINT,
MESINT,
MATRIC,
MATRSOCIAL,
FUNADC,
PS13,
CODJOR,
DFAL,
CTPS_NUM,
CTPS_SER,
CTPS_UF,
CTPS_SD,
SECELE,
CATCNH,
UFCNH,
VALCNH,
ORGEMRG,
ORGEMUF,
AGPIS,
DTAPIS,
CV_RG,
EMAIL,
PSAD,
SALCTR,
CTACOM,
CHRSMES,
DTAAPOS,
DEDICAC,
TIPOFUNC,
TELETRAB,
TRABINTE,
AMBCODIGO,
OPCRECSIN,
PARTPAT,
CNPJTRANS,
NUMEROCNV,
RECICNV,
VALCNV,
NUMRPF,
TPARCIAL,
INDADMI,
REGJOR,
ENVADMPRE,
PROTADMPRE,
REGISTERCONV,
FUNCIONARIOS.SR_RECNO,
FUNCAOACUMULAVEL,
DATAINGRESSOCARGO,
NUMPROCESSOADMISSAO,
(select SALMENSAL from FUNCIONARIOSSALARIOS where funcodigo = FUNCIONARIOS.CODI and mesbase = (select min(mesbase) from FUNCIONARIOSSALARIOS where funcodigo = FUNCIONARIOS.CODI)) SALARIO,
(select SALVALOR from FUNCIONARIOSSALARIOS where funcodigo = FUNCIONARIOS.CODI and mesbase = (select min(mesbase) from FUNCIONARIOSSALARIOS where funcodigo = FUNCIONARIOS.CODI)) SALARIO_HORISTA,
(select TIPOCONTRATO from FUNCIONARIOSSALARIOS where funcodigo = FUNCIONARIOS.CODI and mesbase = (select max(mesbase) from FUNCIONARIOSSALARIOS where funcodigo = FUNCIONARIOS.CODI)) TIPOCONTRATO,
OBRACOD,
FUNCOES.CODIGO AS I_CARGOS

FROM FUNCIONARIOS
LEFT JOIN ALOCACOES 
       ON SUBSTRING(FUNCIONARIOS.CODI from 1 for 3) = ALOCACOES.EMPCODIGO 
	  AND SUBSTRING(FUNCIONARIOS.CODI from 5 for 7) = ALOCACOES.FUNCODIGO 
	  AND ALOCACOES.MESBASEALOCADO = (SELECT MAX(AL.MESBASEALOCADO) 
	                                    FROM ALOCACOES as AL 
									   WHERE AL.EMPCODIGO = ALOCACOES.EMPCODIGO
									     AND AL.FUNCODIGO = ALOCACOES.FUNCODIGO)
LEFT JOIN FUNCOES 
       ON SUBSTRING(FUNCIONARIOS.CODI from 1 for 3) = FUNCOES.EMPRESA 
	  AND FUNCIONARIOS.CARG = FUNCOES.DESCRICAO
	  
ORDER BY 1