SELECT CODIGOEMPRESA,
       CODIGOFUNCCONTR,
       DATARESC,
       'Rescisão' AS TIPO
  FROM RESCISAO
UNION
SELECT CODIGOEMPRESA,
       CODIGOFUNCCONTR,
       DATADEM AS DATARESC,
       'Funcionários' AS TIPO
  FROM FUNCCONTRATO AS FUNCIONARIO
 WHERE NOT EXISTS (SELECT 1
                    FROM RESCISAO
                   WHERE RESCISAO.CODIGOEMPRESA = FUNCIONARIO.CODIGOEMPRESA
                     AND RESCISAO.CODIGOFUNCCONTR = FUNCIONARIO.CODIGOFUNCCONTR)
   AND FUNCIONARIO.DATADEM IS NOT NULL
 ORDER BY 1,2
