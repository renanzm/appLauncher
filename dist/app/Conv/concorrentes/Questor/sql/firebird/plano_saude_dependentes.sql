WITH MAX_PLANO AS (
	SELECT CODIGOEMPRESA,
	       CODIGOFUNCCONTR,
	       CODIGODEPEND,
	       MAX(DATAINICIAL) AS DATAINICIAL
    FROM FUNCPLANOSAUDEDEPEND
    GROUP BY 1, 2, 3
)
SELECT FUNCPLANOSAUDEDEPEND.*
FROM FUNCPLANOSAUDEDEPEND
INNER JOIN MAX_PLANO
   	ON FUNCPLANOSAUDEDEPEND.CODIGOEMPRESA = MAX_PLANO.CODIGOEMPRESA
   	AND FUNCPLANOSAUDEDEPEND.CODIGOFUNCCONTR = MAX_PLANO.CODIGOFUNCCONTR
   	AND FUNCPLANOSAUDEDEPEND.CODIGODEPEND = MAX_PLANO.CODIGODEPEND
   	AND FUNCPLANOSAUDEDEPEND.DATAINICIAL = MAX_PLANO.DATAINICIAL
ORDER BY 1, 2, 5