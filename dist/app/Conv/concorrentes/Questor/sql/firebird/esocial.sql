SELECT et.CODIGOEMPRESA,
       es.CODIGOESTAB AS VALOR,
       et.RECIBO,
       REPLACE(et.EVENTO, 'S-', '') AS EVENTO,
       '' AS "DATA"
  FROM ESOCIALTRANSACAO et
 INNER JOIN ESOCIALDADOSS1000 es
    ON et.CODIGOESOCIALTRANSACAO = es.CODIGOESOCIALTRANSACAO
 WHERE et.EVENTO IN ('S-1000')
   AND LEFT(et.RECIBO, 3) = '1.1'
UNION
SELECT et.CODIGOEMPRESA,
	   CASE
	      WHEN es.CODIGOESTAB = 0 THEN es.CODIGOOUTEMP
		  ELSE es.CODIGOESTAB
	   END AS VALOR,
       et.RECIBO,
       REPLACE(et.EVENTO, 'S-', '') AS EVENTO,
       '' AS "DATA"
  FROM ESOCIALTRANSACAO et
 INNER JOIN ESOCIALDADOSS1005 es
    ON et.CODIGOESOCIALTRANSACAO = es.CODIGOESOCIALTRANSACAO
 WHERE et.EVENTO IN ('S-1005')
   AND LEFT(et.RECIBO, 3) = '1.1'
UNION
SELECT et.CODIGOEMPRESA,
       es.CODIGOOUTEMP AS VALOR,
       et.RECIBO,
       REPLACE(et.EVENTO, 'S-', '') AS EVENTO,
       '' AS "DATA"
  FROM ESOCIALTRANSACAO et
 INNER JOIN ESOCIALDADOSS1020 es
    ON et.CODIGOESOCIALTRANSACAO = es.CODIGOESOCIALTRANSACAO
 WHERE et.EVENTO IN ('S-1020')
   AND LEFT(et.RECIBO, 3) = '1.1'
UNION
SELECT et.CODIGOEMPRESA,
       es.CODIGOCARGO AS VALOR,
       et.RECIBO,
       REPLACE(et.EVENTO, 'S-', '') AS EVENTO,
       '' AS "DATA"
  FROM ESOCIALTRANSACAO et
 INNER JOIN ESOCIALDADOSS1030 es
    ON et.CODIGOESOCIALTRANSACAO = es.CODIGOESOCIALTRANSACAO
 WHERE et.EVENTO IN ('S-1030')
   AND LEFT(et.RECIBO, 3) = '1.1'
UNION
SELECT et.CODIGOEMPRESA,
       es.CODIGOHORARIO AS VALOR,
       et.RECIBO,
       REPLACE(et.EVENTO, 'S-', '') AS EVENTO,
       '' AS "DATA"
  FROM ESOCIALTRANSACAO et
 INNER JOIN ESOCIALDADOSS1050 es
    ON et.CODIGOESOCIALTRANSACAO = es.CODIGOESOCIALTRANSACAO
 WHERE et.EVENTO IN ('S-1050')
   AND LEFT(et.RECIBO, 3) = '1.1'
UNION
SELECT et.CODIGOEMPRESA,
       es.CODIGOFUNCCONTR AS VALOR,
       et.RECIBO,
       REPLACE(et.EVENTO, 'S-', '') AS EVENTO,
       '' AS "DATA"
  FROM ESOCIALTRANSACAO et
 INNER JOIN ESOCIALDADOSS2200 es
    ON et.CODIGOESOCIALTRANSACAO = es.CODIGOESOCIALTRANSACAO
 WHERE et.EVENTO IN ('S-2200')
   AND LEFT(et.RECIBO, 3) = '1.1'
UNION
SELECT et.CODIGOEMPRESA,
       es.CODIGOFUNCCONTR AS VALOR,
       et.RECIBO,
       REPLACE(et.EVENTO, 'S-', '') AS EVENTO,
       '' AS "DATA" 
  FROM ESOCIALTRANSACAO et
 INNER JOIN ESOCIALDADOSS2300 es
    ON et.CODIGOESOCIALTRANSACAO = es.CODIGOESOCIALTRANSACAO
 WHERE et.EVENTO IN ('S-2300')
   AND LEFT(et.RECIBO, 3) = '1.1'
UNION
SELECT et.CODIGOEMPRESA,
       es.CODIGOFUNCCONTR AS VALOR,
       et.RECIBO,
       REPLACE(et.EVENTO, 'S-', '') AS EVENTO,
       DATA
  FROM ESOCIALTRANSACAO et
 INNER JOIN ESOCIALDADOSS2205 es
    ON et.CODIGOESOCIALTRANSACAO = es.CODIGOESOCIALTRANSACAO
 WHERE et.EVENTO IN ('S-2205')
   AND LEFT(et.RECIBO, 3) = '1.1'
UNION
SELECT et.CODIGOEMPRESA,
       es.CODIGOFUNCCONTR AS VALOR,
       et.RECIBO,
       REPLACE(et.EVENTO, 'S-', '') AS EVENTO,
       es.DATAINICIAL as DATA
  FROM ESOCIALTRANSACAO et
 INNER JOIN ESOCIALDADOSS2206 es
    ON et.CODIGOESOCIALTRANSACAO = es.CODIGOESOCIALTRANSACAO
 WHERE et.EVENTO IN ('S-2206')
   AND LEFT(et.RECIBO, 3) = '1.1'
UNION
SELECT et.CODIGOEMPRESA,
       es.CODIGOFUNCCONTR AS FUNC,
       et.RECIBO,
       REPLACE(et.EVENTO, 'S-', '') AS EVENTO,
       es.DATAAFAST AS DATAINICIO
  FROM ESOCIALTRANSACAO et
 INNER JOIN ESOCIALDADOSS2230 AS es
    ON et.CODIGOESOCIALTRANSACAO = es.CODIGOESOCIALTRANSACAO
 WHERE et.EVENTO IN ('S-2230')
   AND LEFT(et.RECIBO, 3) = '1.1'
ORDER BY 1, 4, 2