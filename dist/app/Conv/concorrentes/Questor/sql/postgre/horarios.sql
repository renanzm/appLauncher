SELECT DISTINCT
       fe.CODIGOEMPRESA,
       ed.CODIGOHORARIO,
       h.DESCRHORARIO,
       h.DATAINICIAL,
       h.TIPOHORARIO,
       h.TIPOINTERVAL,
       hde.SEQ,
       hde.HORAENTRADA ENTRADA,
       hde.HORASAIDA SAIDA_SAIDA_INTERVALO,
       (SELECT hda.HORAENTRADA
          FROM HORARIODETALHE hda
         WHERE hde.CODIGOHORARIO = hda.CODIGOHORARIO
           AND SEQ = 2) AS ENTRADA_INTERVALO,
       (SELECT hda.HORASAIDA
          FROM HORARIODETALHE hda
         WHERE hde.CODIGOHORARIO = hda.CODIGOHORARIO
           AND SEQ = 2) AS SAIDA,
		(SELECT hda.HORAENTRADA
          FROM HORARIODETALHE hda
         WHERE hde.CODIGOHORARIO = hda.CODIGOHORARIO
           AND SEQ = 3) AS ENTRADA_INTERVALO_AUX,
       (SELECT hda.HORASAIDA
          FROM HORARIODETALHE hda
         WHERE hde.CODIGOHORARIO = hda.CODIGOHORARIO
           AND SEQ = 3) AS SAIDA_AUX
  FROM FUNCESCALA fe
  LEFT JOIN ESCALADETALHE ed
    ON ed.CODIGOESCALA = fe.CODIGOESCALA
  LEFT JOIN ESCALA e
    ON ed.CODIGOESCALA = e.CODIGOESCALA
  LEFT JOIN HORARIO h
    ON ed.CODIGOHORARIO = h.CODIGOHORARIO
  LEFT JOIN HORARIODETALHE hde
    ON hde.CODIGOHORARIO = h.CODIGOHORARIO
 ORDER BY 1, 2, hde.SEQ