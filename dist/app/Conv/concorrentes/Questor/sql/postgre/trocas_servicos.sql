SELECT fun_ser.CODIGOEMPRESA,
       fun_ser.CODIGOFUNCCONTR,
       fun_ser.DATAINICIAL,
       fun_ser.CODIGOOUTEMP,
       fl.CODIGOESTAB AS "LOCAL"
  FROM FUNCOUTRAEMP fun_ser
  LEFT JOIN FUNCLOCAL fl
    ON fl.CODIGOEMPRESA = fun_ser.CODIGOEMPRESA
   AND fl.CODIGOFUNCCONTR = fun_ser.CODIGOFUNCCONTR
   AND fl.DATATRANSF = (SELECT MAX(DATATRANSF)
                          FROM FuncLocal fl2
                         WHERE fl2.CODIGOEMPRESA = fl.CODIGOEMPRESA
                           AND fl2.CODIGOFUNCCONTR = fl.CODIGOFUNCCONTR)
  WHERE fun_ser.CODIGOOUTEMP IS NOT NULL
  ORDER BY CODIGOEMPRESA,
           CODIGOFUNCCONTR,
           DATAINICIAL