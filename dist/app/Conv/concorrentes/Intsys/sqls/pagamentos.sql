WITH MAX_DARF AS (
	SELECT EMPRE_DARF,
	       MAX(COMPE_DARF) AS COMPE_DARF
	FROM TABFIDARF
	GROUP BY 1
)
SELECT DISTINCT
       TABFIDARF.EMPRE_DARF,
       TABFIDARF.DTAP1_DARF,
       TABFIDARF.DTAP2_DARF
FROM TABFIDARF
INNER JOIN MAX_DARF
	ON TABFIDARF.EMPRE_DARF = MAX_DARF.EMPRE_DARF
	AND TABFIDARF.COMPE_DARF = MAX_DARF.COMPE_DARF
ORDER BY 1, 2