SELECT EMPRE_FUNC,
	CODIG_FUNC,
	NOMEF_FUNC,
	REGIM_FUNC,
	DTADM_FUNC,
	(SELECT MIN(CARGO_ASAL) FROM TABFPASAL WHERE TABFPASAL.EMPRE_ASAL = TABFPFUNC.EMPRE_FUNC AND
											TABFPASAL.FUNCI_ASAL = TABFPFUNC.CODIG_FUNC AND
											TABFPASAL.DATAA_ASAL = (SELECT MIN(ALT.DATAA_ASAL)
																   FROM TABFPASAL AS ALT
																   WHERE TABFPASAL.EMPRE_ASAL = ALT.EMPRE_ASAL AND
																		 TABFPASAL.FUNCI_ASAL = ALT.FUNCI_ASAL)) AS CARGO_INICIAL,
	CARGO_FUNC,
	(SELECT DESCR_CARG FROM TABFPCARG WHERE TABFPCARG.CODIG_CARG = TABFPFUNC.CARGO_FUNC) AS DESC_CARGO,
	(SELECT NOCBO_CARG FROM TABFPCARG WHERE TABFPCARG.CODIG_CARG = TABFPFUNC.CARGO_FUNC) AS CBO2002,
	SALAR_FUNC,
	(SELECT MIN(SALAR_ASAL) FROM TABFPASAL WHERE TABFPASAL.EMPRE_ASAL = TABFPFUNC.EMPRE_FUNC AND
											TABFPASAL.FUNCI_ASAL = TABFPFUNC.CODIG_FUNC AND
											TABFPASAL.DATAA_ASAL = (SELECT MIN(ALT.DATAA_ASAL)
																   FROM TABFPASAL AS ALT
																   WHERE TABFPASAL.EMPRE_ASAL = ALT.EMPRE_ASAL AND
																		 TABFPASAL.FUNCI_ASAL = ALT.FUNCI_ASAL)) AS SALARIO_INICIAL,

	PRAIS_FUNC,
	HORAR_FUNC,
	HORME_FUNC,
	(SELECT MIN(HORSE_ASAL) FROM TABFPASAL WHERE TABFPASAL.EMPRE_ASAL = TABFPFUNC.EMPRE_FUNC AND
											TABFPASAL.FUNCI_ASAL = TABFPFUNC.CODIG_FUNC AND
											TABFPASAL.DATAA_ASAL = (SELECT MIN(ALT.DATAA_ASAL)
																   FROM TABFPASAL AS ALT
																   WHERE TABFPASAL.EMPRE_ASAL = ALT.EMPRE_ASAL AND
																		 TABFPASAL.FUNCI_ASAL = ALT.FUNCI_ASAL)) AS HORSE_ASAL,
	CONSI_FUNC,
	SINDI_FUNC,
	LOCAL_FUNC,
	CUSTO_FUNC,
	CONDU_FUNC,
	EXPE1_FUNC,
	EXPE2_FUNC,
	DEPIR_FUNC,
	DEPSF_FUNC,
	TPEND_FUNC,
	ENDER_FUNC,
	NUMER_FUNC,
	COMPL_FUNC,
	BAIRR_FUNC,
	(SELECT DESCR_MUNI FROM TABGRMUNI WHERE TABGRMUNI.CODIG_MUNI = TABFPFUNC.MUNIC_FUNC) AS CIDADE,
	(SELECT ESTAD_MUNI FROM TABGRMUNI WHERE TABGRMUNI.CODIG_MUNI = TABFPFUNC.MUNIC_FUNC) AS ESTADO,
	NOCEP_FUNC,
	NODDD_FUNC,
	NOTEL_FUNC,
	DTNAS_FUNC,
	(SELECT DESCR_MUNI FROM TABGRMUNI WHERE TABGRMUNI.CODIG_MUNI = TABFPFUNC.LCNAS_FUNC) AS CIDADE_NASCIMENTO,
	(SELECT ESTAD_MUNI FROM TABGRMUNI WHERE TABGRMUNI.CODIG_MUNI = TABFPFUNC.LCNAS_FUNC) AS ESTADO_NASCIMENTO,
	NACIO_FUNC,
	CIVIL_FUNC,
	RACAF_FUNC,
	DEFIC_FUNC,
	GRAUI_FUNC,
	SEXOF_FUNC,
	NUMCP_FUNC,
	SERCP_FUNC,
	ESTCP_FUNC,
	NOCPF_FUNC,
	NOPIS_FUNC,
	BAPIS_FUNC,
	AGPIS_FUNC,
	DTPIS_FUNC,
	NORGF_FUNC,
	(SELECT replace(ORGRG_FUN2,'[]','') FROM TABFPFUN2 WHERE TABFPFUN2.EMPRE_FUN2 = TABFPFUNC.EMPRE_FUNC AND
											TABFPFUN2.CODIG_FUN2 = TABFPFUNC.CODIG_FUNC) AS ORGAO_RG,
	(SELECT NOCNH_FUN2 FROM TABFPFUN2 WHERE TABFPFUN2.EMPRE_FUN2 = TABFPFUNC.EMPRE_FUNC AND
											TABFPFUN2.CODIG_FUN2 = TABFPFUNC.CODIG_FUNC) AS CARTEIRA_MOTORISTA,
	(SELECT CTCNH_FUN2 FROM TABFPFUN2 WHERE TABFPFUN2.EMPRE_FUN2 = TABFPFUNC.EMPRE_FUNC AND
											TABFPFUN2.CODIG_FUN2 = TABFPFUNC.CODIG_FUNC) AS CAT_MOTORISTA,
	(SELECT DTCNH_FUN2 FROM TABFPFUN2 WHERE TABFPFUN2.EMPRE_FUN2 = TABFPFUNC.EMPRE_FUNC AND
											TABFPFUN2.CODIG_FUN2 = TABFPFUNC.CODIG_FUNC) AS DATA_MOTORISTA,
	REPLACE((SELECT EMAIL_FUN2 FROM TABFPFUN2 WHERE TABFPFUN2.EMPRE_FUN2 = TABFPFUNC.EMPRE_FUNC AND
													TABFPFUN2.CODIG_FUN2 = TABFPFUNC.CODIG_FUNC), '\n', '') AS EMAIL,
	NORES_FUNC,
	CTRES_FUNC,
	TITUL_FUNC,
	TPFGT_FUNC,
	DTFGT_FUNC,
	CTFGT_FUNC,
	OCORR_FUNC,
	CATEG_FUNC,
	SITUA_FUNC,
	VINCU_FUNC,
	TACAG_FUNC,
	TRAIS_FUNC,
	FMPGT_FUNC,
	BANCO_FUNC,
	AGENC_FUNC,
	CONTA_FUNC,
	TIPCC_FUNC,
	REGIS_FUNC,
	PONTO_FUNC,
	CHAPE_FUNC,
	DTEXA_FUNC,
	ALVAR_FUNC,
	DTPER_FUNC,
	DTNRG_FUNC,
	DTCTP_FUNC,
	DTTRA_FUNC,
	PTBCO_FUNC,
	PTEXT_FUNC,
	CRACH_FUNC,
	ZONAF_FUNC,
	SECAO_FUNC,
	(case when (SELECT MAX(AQUI2_FERI)
	    FROM TABFPFERI
	    WHERE TABFPFERI.EMPRE_FERI = TABFPFUNC.EMPRE_FUNC
	    AND TABFPFERI.FUNCI_FERI = TABFPFUNC.CODIG_FUNC and gozo1_feri is not null) is null
	    then dateadd(day, -1, DTADM_FUNC)
	    else (SELECT MAX(AQUI2_FERI)
	    FROM TABFPFERI
	    WHERE TABFPFERI.EMPRE_FERI = TABFPFUNC.EMPRE_FUNC
	    AND TABFPFERI.FUNCI_FERI = TABFPFUNC.CODIG_FUNC and gozo1_feri is not null)  end ) AS VENC_FERIAS,
	(SELECT MAX(dateadd (1 day TO DTRES_RESC)) FROM TABFPRESC WHERE TABFPRESC.EMPRE_RESC = TABFPFUNC.EMPRE_FUNC AND
											TABFPRESC.FUNCI_RESC = TABFPFUNC.CODIG_FUNC
											AND TIPOR_RESC = 0) AS DT_DEMISSAO,
	HORAR_FUNC as HORAR_FUNC_1,
	MATRI_FUN3,
	CATEG_FUN3,
	NMMAE_FUN3,
	NMPAI_FUN3,
	LOTAC_FUN3,
	(SELECT NOCGC_EMPR FROM TABGREMPR WHERE CODIG_EMPR = EMPAN_FUN2) as EMPAN_FUN2,
	FUNAN_FUN2
FROM TABFPFUNC left join TABFPFUN3 on (TABFPFUNC.EMPRE_FUNC = TABFPFUN3.EMPRE_FUN3 and TABFPFUNC.CODIG_FUNC = TABFPFUN3.CODIG_FUN3)
			   left join TABFPFUN2 on (TABFPFUNC.EMPRE_FUNC = TABFPFUN2.EMPRE_FUN2 and TABFPFUNC.CODIG_FUNC = TABFPFUN2.CODIG_FUN2)                      
ORDER BY 1,2
