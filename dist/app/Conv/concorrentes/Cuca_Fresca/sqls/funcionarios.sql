SELECT f.cod_empresa,
	   f.cod_funcionario,
	   f.tipo,
	   f.tiposalario,
	   f.regfls,
	   f.livron,
	   f.nomefuncionario,
	   f.sexo,
	   f.carttrabalho,
	   f.serie,
	   f.ufct,
	   f.dataexpedicaoct,
	   f.contratotrabalho,
	   f.tipotrabalho,
	   f.prazo,
	   f.dataprorrogacao,
	   f.datatermexperiencia,
	   f.dataultexmedperiod,
	   f.ninscinddomestico,
	   f.dataadmissao,
	   f.dataterminoultimaconcessaoferias,
	   f.tipoadmissao,
	   f.rais,
	   f.caged,
	   f.dataavisoprevio,
	   f.datademissao,
	   f.demrais,
	   f.demcaged,
	   f.demfgts,
	   f.causa,
	   f.codsindicato,
	   f.piscadastrado,
	   f.datacadastropis,
	   f.codbanco,
	   f.agencia,
	   f.codadmregfgts,
	   f.dataopcao,
	   f.codigofgtsempreg,
	   f.cpfcic,
	   f.cedidentid,
	   f.emissor,
	   f.ufemissor,
	   f.cnachabilitacao,
	   f.creservista,
	   f.seriecreservista,
	   f.categreservista,
	   f.titeleitor,
	   f.zona,
	   f.codestadocivil,
	   f.nomeconjugue,
	   f.datanascimento,
	   f.codmunibge,
	   f.codnacionalidade,
	   f.estrangeirocedid,
	   f.emissorrgestrangeiro,
	   f.ufemissorrgestrangeiro,
	   f.dataexpedicaorgestrangeiro,
	   f.anochegada,
	   f.pai,
	   f.mae,
	   f.endereco,
	   f.cep,
	   f.bairrodistrito,
	   f.codigomunicipioibge,
	   f.fone,
	   f.dataconfirmacaogravidez,
	   f.dataparto,
	   f.dataregistrocandidaturacipa,
	   f.dataeleicaocipa,
	   f.eleitocipa,
	   f.datafinalmandatocipa,
	   f.dataregistrocandidaturasind,
	   f.dataeleicaosind,
	   f.eleitosind,
	   f.datafinalmandatosind,
	   f.datatermestabcipa,
	   f.dataalistamento,
	   f.datadispensa,
	   f.databaixa,
	   f.dataaposentadoria,
	   f.assistencial,
	   f.confederativa,
	   f.dataprevnascimento,
	   f.abortolegal,
	   f.dataalteracaosalario,
	   f.tiposangue,
	   f.obscracha,
	   f.nomedafotodofuncionario,
	   f.categoriahabilitacao,
	   f.dataexamehabilitacao,
	   f.codsaquefgts,
	   f.dataalteracaoendereco,
	   f.dataalteracao403,
	   f.antigacarttrabalho,
	   f.antigaserie,
	   f.dataalteracao404,
	   f.antigonomeempregado,
	   f.dataalteracao405,
	   f.antigopiscadastro,
	   f.dataalteracao408,
	   f.antigadataadmissao,
	   f.dataalteracao428,
	   f.antigadatanascimento,
	   f.dataalteracao427,
	   f.antigocbo,
	   f.tipoavisoprevio,
	   f.valormultarescisoria,
	   f.saldofgts,
	   f.multajurorescisao,
	   f.tipopagtoconindiv,
	   f.dataopcaocontrindiv,
	   f.multajuromesantrescisao,
	   f.recolheufgtsmesanter,
	   f.multarecolhimentorescisao,
	   f.causarescisao,
	   f.datemissaoidentidade,
	   f.atrasopagtorescisao,
	   f.raca,
	   f.datapagtorescisao,
	   f.deficientefisico,
	   f.horasprorrogadas,
	   f.horaprorroginicio,
	   f.horaprorrogintervalo,
	   f.horaprorrogvolta,
	   f.horaprorrogsaida,
	   f.horaprorroginiciosabado,
	   f.horaprorrogsaidasabado,
	   f.prorragarateprorrogacao,
	   f.salarioprorrogacao,
	   f.horasseginiciocompensacao,
	   f.compensacaotexto1,
	   f.compensacaotexto2,
	   f.compensacaotexto3,
	   f.horassegsaidacompensacao,
	   f.horassegdescansocompensacao,
	   f.horasteriniciocompensacao,
	   f.horastersaidacompensacao,
	   f.horasterdescansocompensacao,
	   f.horassabiniciocompensacao,
	   f.horassabsaidacompensacao,
	   f.horassabdescansocompensacao,
	   f.prorrogaratecompensacao,
	   f.testemunha1,
	   f.testemunha2,
	   f.endtestemunha1,
	   f.endtestemunha2,
	   f.diassuspenso,
	   f.datainiciosuspensao,
	   f.datafimsuspensao,
	   f.cpfresponsavel,
	   f.nomeresponsavel,
	   f.codigobanco,
	   f.contapagamento,
	   f.datarecolheugps,
	   f.deficiente,
	   f.alvara,
	   f.datatransferenciafuncionario,
	   f.estagiario,
	   f.verbasrescisorias,
	   f.verbasrescisorias_complementar,
	   f.qtdemesestrabalhados,
	   f.periodo_rais,
	   f.confederativa_pagar,
	   f.assistencial_pagar,
	   f.codigosetor,
	   f.codigoempregadoponto,
	   f.naodescontainss,
	   f.tipocontrato,
	   f.dataaposentadoriacomvinculo,
	   f.bloquearenviobanco,
	   f.sindical,
	   f.sindicalnaopagar,
	   f.conectividade,
	   f.comdispensa,
	   f.regprofissional,
	   f.reposicaovaga,
	   f.dtapgtoconectividade,
	   f.celular,
	   f.cartaosalario,
	   f.localparahomologacao,
	   f.dataparahomologacao,
	   f.horaparahomologacao,
	   f.funcionariocompensousabadosemanaafastamento,
	   f.comprovounovoempregoduranteavisoprevio,
	   f.titulocontrato,
	   f.codigosat,
	   f.jorntrabcumpridaintegralmentesemafastamento,
	   f.causaafasthomolognet,
	   f.clausulaassecuratoriacontrato,
	   f.salariomesantrescisaopago,
	   f.pensao,
	   f.pensaofgts,
	   f.cnpjemptrans,
	   f.cnpjemptransorigem,
	   f.tipoconta,
	   f.email,
	   f.enviaemail,
	   f.codoperacaoconta,
	   f.tipocertidao,
	   f.dataemissaocertidao,
	   f.nummatriculacertidao,
	   f.nlivro,
	   f.nfolha,
	   f.cartorio,
	   f.codmunicipiocertidao,
	   f.numpassaporte,
	   f.emissorpassaporte,
	   f.ufpassaporte,
	   f.dataemissaopassaporte,
	   f.datavalidadepassaporte,
	   f.paisemissaopassaporte,
	   f.secao,
	   f.numportarianaturalizacao,
	   f.datanaturalizacao,
	   f.numeroric,
	   f.emissorric,
	   f.codmunicipioric,
	   f.dataexpedicaoric,
	   f.caixapostal,
	   f.cepcaixapostal,
	   f.homolognetdifirmesrescisao,
	   fc.matricula,
	   fc.reintegr_tipo,
	   fc.reintegr_dataretorno,
	   fc.reintegr_dataefeito,
	   (SELECT tcf.id_trabalhadores_categoria FROM dpcuca.tbcatfuncionario AS tcf WHERE f.cod_empresa = tcf.codigoempresa AND f.cod_funcionario = tcf.codigoempregado ORDER BY tcf.id_tbcatfuncionario desc LIMIT 1),
	   (SELECT MAX(terminoaquisitivo) FROM dpcuca.ferias WHERE ferias.codigoempresa = f.cod_empresa AND ferias.codigoempregado = f.cod_funcionario AND ferias.iniciogozo IS NOT NULL) AS ultimo_aquisitivo
FROM dpcuca.funcion AS f
INNER JOIN dpcuca.funcion_compl AS fc ON ((f.cod_empresa = fc.codigoempresa) AND (f.cod_funcionario = fc.codigoempregado))
ORDER BY f.cod_empresa, f.cod_funcionario