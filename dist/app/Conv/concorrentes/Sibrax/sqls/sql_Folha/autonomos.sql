WITH LISTAGEM_RPA AS (
	SELECT EMPRESA,
	       CI,
	       MAX(CONTROLEID) AS CONTROLEID
	FROM LANCAMENTORPA
	GROUP BY 1, 2
)
SELECT LANCAMENTORPA.*,
       AUTONOMOS.*
FROM LISTAGEM_RPA
INNER JOIN LANCAMENTORPA
	ON LISTAGEM_RPA.EMPRESA = LANCAMENTORPA.EMPRESA
	AND LISTAGEM_RPA.CI = LANCAMENTORPA.CI
	AND LISTAGEM_RPA.CONTROLEID = LANCAMENTORPA.CONTROLEID
INNER JOIN AUTONOMOS
	ON LANCAMENTORPA.CI = AUTONOMOS.CI
ORDER BY LANCAMENTORPA.EMPRESA, LANCAMENTORPA.CI