SELECT TE.BDCODEMP,
	   TE.BDCODMATRIZ,
	   TE.BDCNPJEMP,
	   TE.BDDATAINIATIVEMP,
	   TE.BDAPELIDO,
       TER.BDREFEMP,
	   TER.BDCODCID,
	   TER.BDCODNATJUR,
	   TER.BDCODCNAE,
	   TER.BDNOMEMP,
	   TER.BDNOMREDUZEMP,
	   TER.BDENDEMP,
	   TER.BDNUMEMP,
	   TER.BDBAIEMP,
	   TER.BDCOMPLEMP,
	   TER.BDCEPEMP,
	   TER.BDDDDEMP,
	   TER.BDFONEEMP,
	   TER.BDEMAILEMP,
	   TER.BDLOGREMP,
	   TER.BDIEEMP,
	   TER.BDIMEMP,
	   TER.BDCODCONT,
	   VRHF_BASE_TEMPGPS.BDCODEMP,
	   VRHF_BASE_TEMPGPS.BDREFEMP,
	   VRHF_BASE_TEMPGPS.BDCODFPASTERC,
	   VRHF_BASE_TEMPGPS.BDCODREC,
	   VRHF_BASE_TEMPGPS.BDCNAERATEMP,
	   VRHF_BASE_TEMPGPS.BDAUTEMP,
	   VRHF_BASE_TEMPGPS.BDSIMPLESGPS,
	   VRHF_BASE_TEMPGPS.BDFAP,
	   VRHF_BASE_TEMPGPS.BDPERTERC,
	   VRHF_BASE_TEMPGPS.BDRAT
FROM TEMPRESAS AS TE
INNER JOIN TEMPRESAS_REF AS TER
ON (TE.BDCODEMP = TER.BDCODEMP)
INNER JOIN VRHF_BASE_TEMPGPS
ON (TE.BDCODEMP = VRHF_BASE_TEMPGPS.BDCODEMP)
WHERE TER.BDREFEMP = (SELECT MAX(TEMPRESAS_REF.BDREFEMP) FROM TEMPRESAS_REF WHERE TEMPRESAS_REF.BDCODEMP = TE.BDCODEMP)
AND VRHF_BASE_TEMPGPS.BDREFEMP = (SELECT MAX(VRHF_BASE_TEMPGPS.BDREFEMP) FROM VRHF_BASE_TEMPGPS WHERE VRHF_BASE_TEMPGPS.BDCODEMP = TE.BDCODEMP)
ORDER BY TE.BDCODEMP