SELECT VRHF_BASE_TEMPVINC.BDCODEMP,
	   VRH_BASE_TQH.BDCODPQUA,
	   VRH_BASE_TQH.BDCODQH,
	   VRH_BASE_TQH.BDDESCQH
FROM VRH_BASE_TQH
INNER JOIN VRHF_BASE_TEMPVINC
ON (VRH_BASE_TQH.BDCODPQUA = VRHF_BASE_TEMPVINC.BDCODPQUA)
WHERE VRHF_BASE_TEMPVINC.BDREFEMP = (SELECT MAX(T.BDREFEMP)
                                       FROM VRHF_BASE_TEMPVINC as T
                                      WHERE VRHF_BASE_TEMPVINC.BDCODPQUA = T.BDCODPQUA
                                        AND VRHF_BASE_TEMPVINC.BDCODEMP = T.BDCODEMP)
and exists(SELECT 1
             FROM VRH_EMP_TCOL_VINCDIA
            where VRH_EMP_TCOL_VINCDIA.BDCODEMP = VRHF_BASE_TEMPVINC.BDCODEMP
              and VRH_EMP_TCOL_VINCDIA.BDCODPQUA = VRH_BASE_TQH.BDCODPQUA
              and VRH_EMP_TCOL_VINCDIA.BDCODQH = VRH_BASE_TQH.BDCODQH)
ORDER BY VRHF_BASE_TEMPVINC.BDCODEMP, VRH_BASE_TQH.BDCODPQUA, VRH_BASE_TQH.BDCODQH