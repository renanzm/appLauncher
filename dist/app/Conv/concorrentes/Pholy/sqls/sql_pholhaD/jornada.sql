SELECT TABJOR AS CODEMP,
       CODFRE,
       DESCRI,
       DESHR1,
       TIPFRE,
       CDJOR1,
       CDJOR2,
       CDJOR3,
       CDJOR4,
       CDJOR5,
       CDJOR6,
       CDJOR7
FROM PHTFRE
WHERE TABJOR != '0000'

UNION ALL

SELECT PHTEMP.CODEMP AS CODEMP,
       CODFRE,
       DESCRI,
       DESHR1,
       TIPFRE,
       CDJOR1,
       CDJOR2,
       CDJOR3,
       CDJOR4,
       CDJOR5,
       CDJOR6,
       CDJOR7
FROM PHTFRE,
     PHTEMP
WHERE TABJOR != '0000'
  AND LPAD(TABJOR,4,0) = LPAD(PHTEMP.CODMAT,4,0)
  AND NOT EXISTS(SELECT 1
                   FROM PHTFRE AS E2
                  WHERE LPAD(E2.TABJOR,4,0) = LPAD(PHTEMP.CODEMP,4,0))

GROUP BY 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12
ORDER BY 1, 2