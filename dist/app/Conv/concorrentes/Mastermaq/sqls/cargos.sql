SELECT
(SELECT FLH_REGISTRO.IDOWNER FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOCARGO.IDREGISTRO) AS IDOWNER,
(SELECT FLH_REGISTRO.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOCARGO.IDREGISTRO) AS IDREGISTRO,
FLH_MOVIMENTOCARGO.DATAINICIO,
FLH_MOVIMENTOCARGO.IDCARGO,
IDPESSOAEMPRESA,
FLH_MOVIMENTOFILIAL.DATAFIM,
FLH_CARGO.IDCARGO,
CODIGOCARGO,
DESCRICAOCARGO,
(SELECT CODIGOCBO FROM NG_DOMINIO.DBO.DOM_CBO WHERE DOM_CBO.IDCBO = FLH_CARGO.IDCBO) AS CBO
FROM NG_FOLHA.DBO.FLH_MOVIMENTOCARGO

LEFT JOIN NG_FOLHA.DBO.FLH_CARGO
ON FLH_MOVIMENTOCARGO.IDCARGO = FLH_CARGO.IDCARGO


LEFT JOIN NG_FOLHA.DBO.FLH_MOVIMENTOFILIAL 
ON (SELECT FLH_REGISTRO.IDOWNER FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOCARGO.IDREGISTRO) = 
(SELECT FLH_REGISTRO.IDOWNER FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOFILIAL.IDREGISTRO) AND
(SELECT FLH_REGISTRO.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOCARGO.IDREGISTRO) = 
(SELECT FLH_REGISTRO.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOFILIAL.IDREGISTRO)

ORDER BY 1,2,3