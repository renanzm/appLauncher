SELECT DISTINCT 
    NG.DBO.BPM_DADOSSOCIO.IDOWNER,
    NG.DBO.BPM_DADOSSOCIO.[IDDADOSSOCIO],
    NG.DBO.BPM_DADOSSOCIO.[IDPESSOA],
    BPM_PESSOA.NOMEPESSOA,
    NG.DBO.BPM_DADOSPESSOAFISICA.CPF,
	ENDERECO_RESIDENCIAL.LOGRADOURO AS RES_LOGRADOURO,
	ENDERECO_RESIDENCIAL.NUMEROENDERECO AS RES_NUMEROENDERECO,
	ENDERECO_RESIDENCIAL.COMPLEMENTO AS RES_COMPLEMENTO,
	ENDERECO_RESIDENCIAL.BAIRRO AS RES_BAIRRO,
	ENDERECO_RESIDENCIAL.CEP AS RES_CEP,
	ENDERECO_RESIDENCIAL.CAIXAPOSTAL AS RES_CAIXAPOSTAL,
    DOM_MUNICIPIO.CODIGOIBGE AS RES_CODIGOIBGE,
    DOM_MUNICIPIO.NOMEMUNICIPIO AS RES_CIDADE,
    DOM_UF.ABREVIATURAUF AS RES_ESTADO,
	(SELECT CONT1.DESCRICAOTIPOCONTATO
   FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT1
  WHERE CONT1.IDTIPOCONTATO = 1
    AND CONT1.IDPESSOA = ENDERECO_RESIDENCIAL.IDPESSOA
	AND CONT1.IDPESSOATIPOCONTATO = (SELECT MAX(CONT2.IDPESSOATIPOCONTATO)
                               FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT2
                              WHERE CONT2.IDTIPOCONTATO = CONT1.IDTIPOCONTATO
                                AND CONT2.IDPESSOA = CONT1.IDPESSOA)) AS RES_TELEFONE1
FROM 
    NG.DBO.BPM_DADOSSOCIO
INNER JOIN 
    [NG].[DBO].[BPM_DADOSRESPONSAVELFOLHA]
    ON NG.DBO.BPM_DADOSSOCIO.[IDPESSOA] = [NG].[DBO].[BPM_DADOSRESPONSAVELFOLHA].[IDPESSOA]
INNER JOIN 
    [NG].[DBO].[BPM_DADOSRESPONSAVELFOLHAEMPRESA]
    ON [NG].[DBO].[BPM_DADOSRESPONSAVELFOLHA].[IDDADOSRESPONSAVELFOLHA] = [NG].[DBO].[BPM_DADOSRESPONSAVELFOLHAEMPRESA].[IDDADOSRESPONSAVELFOLHA]
INNER JOIN 
    NG.DBO.BPM_PESSOA
    ON NG.DBO.BPM_DADOSSOCIO.IDPESSOA = BPM_PESSOA.IDPESSOA
INNER JOIN 
    NG.DBO.BPM_DADOSPESSOAFISICA
    ON NG.DBO.BPM_DADOSSOCIO.IDPESSOA = BPM_DADOSPESSOAFISICA.IDPESSOA
LEFT JOIN 
    NG.DBO.BPM_PESSOAENDERECO AS ENDERECO_RESIDENCIAL
    ON NG.DBO.BPM_DADOSSOCIO.IDPESSOA = ENDERECO_RESIDENCIAL.IDPESSOA 
    AND ENDERECO_RESIDENCIAL.IDTIPOENDERECO = 1
LEFT JOIN 
    NG_DOMINIO.DBO.DOM_MUNICIPIO
    ON ENDERECO_RESIDENCIAL.IDMUNICIPIO = DOM_MUNICIPIO.IDMUNICIPIO
LEFT JOIN 
    NG_DOMINIO.DBO.DOM_UF
    ON DOM_MUNICIPIO.IDUF = DOM_UF.IDUF
WHERE 
    NG.DBO.BPM_DADOSSOCIO.[INDRESPONSAVELMINISTERIOFAZENDA] = 1
ORDER BY 
    1, 2, 3;