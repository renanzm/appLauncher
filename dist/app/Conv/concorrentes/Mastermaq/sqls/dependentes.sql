SELECT
BPM_DADOSDEPENDENTE.IDOWNER AS IDOWNER,
(SELECT T.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO AS T WHERE T.IDOWNER = BPM_DADOSDEPENDENTE.IDOWNER  AND T.IDREGISTRO = FLH_REGISTRODEPENDENTE.IDREGISTRO) AS IDREGISTRO,
FLH_REGISTRODEPENDENTE.IDREGISTRODEPENDENTE,
FLH_MOVIMENTOFILIAL.IDPESSOAEMPRESA,
FLH_MOVIMENTOFILIAL.DATAFIM,
BPM_PESSOA.NOMEPESSOA,
BPM_DADOSPESSOAFISICA.DATANASCIMENTO,
(SELECT DOM_MUNICIPIO.CODIGOIBGE FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE BPM_DADOSPESSOAFISICA.IDMUNICIPIONATURALIDADE = DOM_MUNICIPIO.IDMUNICIPIO) AS LOCALNASCTOIBGE,
(SELECT DOM_MUNICIPIO.NOMEMUNICIPIO FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE BPM_DADOSPESSOAFISICA.IDMUNICIPIONATURALIDADE = DOM_MUNICIPIO.IDMUNICIPIO) AS CIDADENASCIMENTO,
(SELECT DOM_UF.ABREVIATURAUF FROM NG_DOMINIO.DBO.DOM_UF WHERE (SELECT DOM_MUNICIPIO.IDUF FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE BPM_DADOSPESSOAFISICA.IDMUNICIPIONATURALIDADE = DOM_MUNICIPIO.IDMUNICIPIO) = DOM_UF.IDUF) AS UFNASCIMENTO,BPM_DADOSPESSOAFISICA.CPF,
BPM_DADOSDEPENDENTEIRRF.IDTIPODEPENDENCIAIRRF,
BPM_DADOSDEPENDENTESALARIOFAMILIA.NOMECARTORIO,
BPM_DADOSDEPENDENTESALARIOFAMILIA.NUMEROREGISTRO,
BPM_DADOSDEPENDENTESALARIOFAMILIA.NUMEROLIVRO,
BPM_DADOSDEPENDENTESALARIOFAMILIA.NUMEROFOLHA,
BPM_DADOSDEPENDENTESALARIOFAMILIA.DATAENTREGACERTIDAO,
BPM_DADOSDEPENDENTE.INDDEPENDENTESALARIOFAMILIA,
BPM_DADOSDEPENDENTE.INDDEPENDENTEIRRF,
BPM_DADOSDEPENDENTEIRRF.DATAFIM AS DATAFIMIRRF,
BPM_DADOSDEPENDENTESALARIOFAMILIA.DATAFIM AS DATAFIMFAMILIA,
( SELECT MAX(A.DATAENTREGUE) FROM NG.DBO.BPM_DADOSDEPENDENTESALARIOFAMILIAMOTIVO AS A WHERE A.IDDADOSDEPENDENTE = FLH_REGISTRODEPENDENTE.IDDADOSDEPENDENTE AND A.IDTIPOMOTIVO = 1) AS DATA_VACINACAO,
BPM_DADOSDEPENDENTE.IDRELACAODEPENDENCIAESOCIAL
 
FROM NG_FOLHA.DBO.FLH_REGISTRODEPENDENTE

LEFT JOIN NG.DBO.BPM_DADOSDEPENDENTE AS DADOSDEP
ON DADOSDEP.IDDADOSDEPENDENTE = NG_FOLHA.DBO.FLH_REGISTRODEPENDENTE.IDDADOSDEPENDENTE

LEFT JOIN NG_FOLHA.DBO.FLH_MOVIMENTOFILIAL 
ON (SELECT FLH_REGISTRO.IDOWNER FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOFILIAL.IDREGISTRO) = DADOSDEP.IDOWNER
AND (SELECT T.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO AS T WHERE T.IDOWNER = DADOSDEP.IDOWNER  AND T.IDREGISTRO = FLH_REGISTRODEPENDENTE.IDREGISTRO) = 
(SELECT FLH_REGISTRO.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOFILIAL.IDREGISTRO)

LEFT OUTER JOIN NG.DBO.BPM_DADOSDEPENDENTEIRRF
ON BPM_DADOSDEPENDENTEIRRF.IDDADOSDEPENDENTE = FLH_REGISTRODEPENDENTE.IDDADOSDEPENDENTE

LEFT OUTER JOIN NG.DBO.BPM_DADOSDEPENDENTESALARIOFAMILIA
ON BPM_DADOSDEPENDENTESALARIOFAMILIA.IDDADOSDEPENDENTE = FLH_REGISTRODEPENDENTE.IDDADOSDEPENDENTE,
NG.DBO.BPM_DADOSDEPENDENTE,
NG.DBO.BPM_DADOSPESSOAFISICA, 
NG.DBO.BPM_PESSOA

WHERE FLH_REGISTRODEPENDENTE.IDDADOSDEPENDENTE = BPM_DADOSDEPENDENTE.IDDADOSDEPENDENTE
AND BPM_DADOSDEPENDENTE.IDPESSOA = BPM_DADOSPESSOAFISICA.IDPESSOA
AND BPM_DADOSDEPENDENTE.IDPESSOA = BPM_PESSOA.IDPESSOA

ORDER BY 1,2,3