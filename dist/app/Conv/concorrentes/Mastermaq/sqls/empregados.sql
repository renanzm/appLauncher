SELECT
FLH_REGISTRO.idregistro,
FLH_REGISTRO.IDOWNER,
FLH_REGISTRO.CODIGOREGISTRO,
BPM_PESSOA.IDPESSOA,
BPM_PESSOA.NOMEPESSOA,
BPM_DADOSPESSOAFISICA.APELIDO,
FLH_REGISTRO.DATADEMISSAO,
FLH_REGISTRO.DATAADMISSAO,
FLH_REGISTRO.DATAOPCAOFGTS,
FLH_REGISTRO.IDTIPOADMISSAO,
(SELECT MAX(CODIGOTIPOADMISSAOCAGED) FROM NG_DOMINIO.DBO.DOM_TIPOADMISSAOCAGED WHERE DOM_TIPOADMISSAOCAGED.IDTIPOADMISSAOCAGED = FLH_REGISTRO.IDTIPOADMISSAOCAGED) AS TIPOADMISSAOCAGED,
FLH_REGISTRO.IDTIPOCONTRATACAO,
FLH_REGISTRO.NUMEROMATRICULA,
FLH_REGISTRO.NUMERODIASCONTRATOEXPERIENCIA,
FLH_REGISTRO.NUMERODIASPRORROGACAOCONTRATOEXPERIENCIA,
FLH_REGISTRO.NUMEROCONTAFGTS,
FLH_REGISTRO.NUMERODVCONTAFGTS,
FLH_REGISTRO.INDALVARAJUDICIAL,
FLH_REGISTRO.NUMEROREGISTRO,
FLH_REGISTRO.IDDADOSPESSOA,
FLH_REGISTRO.IDTIPOFUNCIONARIO,
(SELECT MAX(CODIGOSEFIPCATEGORIA) FROM NG_DOMINIO.DBO.DOM_SEFIPCATEGORIA WHERE DOM_SEFIPCATEGORIA.IDSEFIPCATEGORIA = FLH_REGISTRO.IDCATEGORIASEFIP) AS CATEGORIA_SEFIP,
FLH_REGISTRO.DATAULTIMOEXAMEMEDICO,
FLH_REGISTRO.NUMEROMESESINTERVALOEXAMEMEDICO,
(SELECT MAX(CODIGOTIPOVINCULOEMPREGATICIO) FROM NG_DOMINIO.DBO.DOM_TIPOVINCULOEMPREGATICIO WHERE DOM_TIPOVINCULOEMPREGATICIO.IDTIPOVINCULOEMPREGATICIO = FLH_REGISTRO.IDVINCULOEMPREGATICIO) AS VINCULOEMPREGATICIO,
FLH_REGISTRO.INDCOMISSIONISTA,
(SELECT MAX(CODIGOTIPOSALARIO)
   FROM NG_DOMINIO.DBO.DOM_TIPOSALARIO
  WHERE DOM_TIPOSALARIO.IDTIPOSALARIO = (SELECT MAX(TIP1.IDTIPOSALARIO)
									       FROM NG_FOLHA.DBO.FLH_MOVIMENTOSALARIO AS TIP1
								     	  WHERE TIP1.IDREGISTRO = FLH_REGISTRO.IDREGISTRO
									    	AND TIP1.DATAINICIO = (SELECT MAX(TIP2.DATAINICIO)
															    	 FROM NG_FOLHA.DBO.FLH_MOVIMENTOSALARIO AS TIP2
															    	WHERE TIP1.IDREGISTRO = TIP2.IDREGISTRO))) AS IDTIPOSALARIO,
(SELECT MAX(CODIGOSEFIPOCORRENCIA)
   FROM NG_DOMINIO.DBO.DOM_SEFIPOCORRENCIA
  WHERE DOM_SEFIPOCORRENCIA.IDSEFIPOCORRENCIA = (SELECT MAX (SEF1.IDSEFIPOCORRENCIA)
                                                   FROM NG_FOLHA.DBO.FLH_MOVIMENTOSEFIPOCORRENCIA AS SEF1
                                                  WHERE SEF1.IDREGISTRO = FLH_REGISTRO.IDREGISTRO
                                                    AND SEF1.DATAINICIO = (SELECT MAX(SEF2.DATAINICIO)
	                                                                         FROM NG_FOLHA.DBO.FLH_MOVIMENTOSEFIPOCORRENCIA AS SEF2
							                                                WHERE SEF1.IDREGISTRO = SEF2.IDREGISTRO))) AS IDSEFIPOCORRENCIA,
FLH_REGISTRO.DATAULTIMACONTRIBUICAOSINDICAL,
FLH_REGISTRO.INDSINDICALIZADO,
FLH_REGISTRO.DATATRANSFERENCIA,
FLH_REGISTRO.INDTIPOINCLUSAO,
FLH_REGISTRO.INDMOTIVOCONTRATACAO,
FLH_REGISTRO.JUSTIFICATIVACONTRATACAO,
FLH_REGISTRO.JUSTIFICATIVAPRORROGACAO,
(SELECT MAX(QUADRO1.HORAMES)
   FROM NG_PONTO.DBO.PTO_QUADROHORARIO AS QUADRO1
  WHERE QUADRO1.IDQUADROHORARIO = (SELECT MAX(MOVHOR1.IDQUADROHORARIO)
                                     FROM NG_PONTO.DBO.PTO_MOVIMENTOQUADROHORARIO AS MOVHOR1
                                    WHERE MOVHOR1.IDREGISTRO = FLH_REGISTRO.IDREGISTRO
									  AND MOVHOR1.DATAINICIO = (SELECT MAX(MOVHOR2.DATAINICIO)
										                          FROM NG_PONTO.DBO.PTO_MOVIMENTOQUADROHORARIO AS MOVHOR2
																 WHERE MOVHOR2.IDREGISTRO = MOVHOR1.IDREGISTRO))) AS HORAS_MES,
(SELECT MAX(QUADRO1.HORASEMANA)
   FROM NG_PONTO.DBO.PTO_QUADROHORARIO AS QUADRO1
  WHERE QUADRO1.IDQUADROHORARIO = (SELECT MAX(MOVHOR1.IDQUADROHORARIO)
                                     FROM NG_PONTO.DBO.PTO_MOVIMENTOQUADROHORARIO AS MOVHOR1
                                    WHERE MOVHOR1.IDREGISTRO = FLH_REGISTRO.IDREGISTRO
									  AND MOVHOR1.DATAINICIO = (SELECT MAX(MOVHOR2.DATAINICIO)
										                          FROM NG_PONTO.DBO.PTO_MOVIMENTOQUADROHORARIO AS MOVHOR2
																 WHERE MOVHOR2.IDREGISTRO = MOVHOR1.IDREGISTRO))) AS HORAS_SEMANA,
BPM_DADOSFUNCIONARIO.IDDADOSAGENCIA,
BPM_DADOSFUNCIONARIO.IDDADOSBANCO,
BPM_DADOSFUNCIONARIO.NUMEROCTPS,
BPM_DADOSFUNCIONARIO.SERIECTPS,
BPM_DADOSFUNCIONARIO.DATACTPS,
(SELECT DOM_UF.ABREVIATURAUF FROM NG_DOMINIO.DBO.DOM_UF WHERE DOM_UF.IDUF = BPM_DADOSFUNCIONARIO.IDUFCTPS) AS UFCTPS,
BPM_DADOSFUNCIONARIO.NUMCONTABANCARIA,
BPM_DADOSFUNCIONARIO.NUMDVCONTABANCARIA,
(SELECT CODIGOFORMAPAGAMENTO FROM NG_DOMINIO.DBO.DOM_FORMAPAGAMENTO WHERE DOM_FORMAPAGAMENTO.IDFORMAPAGAMENTO = BPM_DADOSFUNCIONARIO.IDFORMAPAGAMENTO) AS FORMAPAGAMENTO,
BPM_DADOSFUNCIONARIO.IDCODIGODIRF,
(SELECT DOM_TIPOLOGRADOURO.DESCRICAOTIPOLOGRADOURO FROM NG_DOMINIO.DBO.DOM_TIPOLOGRADOURO WHERE BPM_PESSOAENDERECO.IDTIPOLOGRADOURO = DOM_TIPOLOGRADOURO.IDTIPOLOGRADOURO) AS TIPOLOGRADOURO,
(SELECT DOM_TITULOLOGRADOURO.DESCRICAOTITULOLOGRADOURO FROM NG_DOMINIO.DBO.DOM_TITULOLOGRADOURO WHERE BPM_PESSOAENDERECO.IDTITULOLOGRADOURO = DOM_TITULOLOGRADOURO.IDTITULOLOGRADOURO) AS TITULOLOGRADOURO,
BPM_PESSOAENDERECO.LOGRADOURO,
BPM_PESSOAENDERECO.NUMEROENDERECO,
BPM_PESSOAENDERECO.COMPLEMENTO,
BPM_PESSOAENDERECO.BAIRRO,
(SELECT DOM_MUNICIPIO.CODIGOIBGE FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE BPM_PESSOAENDERECO.IDMUNICIPIO = DOM_MUNICIPIO.IDMUNICIPIO) AS CODIGOIBGE,
(SELECT DOM_MUNICIPIO.NOMEMUNICIPIO FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE BPM_PESSOAENDERECO.IDMUNICIPIO = DOM_MUNICIPIO.IDMUNICIPIO) AS CIDADE,
(SELECT DOM_UF.ABREVIATURAUF FROM NG_DOMINIO.DBO.DOM_UF WHERE (SELECT DOM_MUNICIPIO.IDUF FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE BPM_PESSOAENDERECO.IDMUNICIPIO = DOM_MUNICIPIO.IDMUNICIPIO) = DOM_UF.IDUF) AS ESTADO,
(SELECT FLH_ESO_REGISTROESTAGIARIO.IDDADOSINSTITUICAOENSINO 
   FROM NG_FOLHA.DBO.FLH_ESO_REGISTROESTAGIARIO 
  WHERE (SELECT FLH_ESO_REGISTROESTAGIARIO.IDREGISTRO 
           FROM NG_FOLHA.DBO.FLH_ESO_REGISTROESTAGIARIO
		  WHERE FLH_ESO_REGISTROESTAGIARIO.IDREGISTRO = FLH_REGISTRO.IDREGISTRO) = FLH_ESO_REGISTROESTAGIARIO.IDREGISTRO) AS I_INSTITUICAO_ENSINO,
(SELECT FLH_ESO_REGISTROESTAGIARIO.IDDADOSAGENTEINTEGRACAO 
   FROM NG_FOLHA.DBO.FLH_ESO_REGISTROESTAGIARIO 
  WHERE (SELECT FLH_ESO_REGISTROESTAGIARIO.IDREGISTRO 
           FROM NG_FOLHA.DBO.FLH_ESO_REGISTROESTAGIARIO
		  WHERE FLH_ESO_REGISTROESTAGIARIO.IDREGISTRO = FLH_REGISTRO.IDREGISTRO) = FLH_ESO_REGISTROESTAGIARIO.IDREGISTRO) AS I_AGENTE_INTEGRACAO,
(SELECT FLH_ESO_REGISTROESTAGIARIO.IDDADOSSUPERVISORESTAGIO 
   FROM NG_FOLHA.DBO.FLH_ESO_REGISTROESTAGIARIO
  WHERE (SELECT FLH_ESO_REGISTROESTAGIARIO.IDREGISTRO 
           FROM NG_FOLHA.DBO.FLH_ESO_REGISTROESTAGIARIO
		  WHERE FLH_ESO_REGISTROESTAGIARIO.IDREGISTRO = FLH_REGISTRO.IDREGISTRO) = FLH_ESO_REGISTROESTAGIARIO.IDREGISTRO) AS I_COORDENADOR_ESTAGIO,
BPM_PESSOAENDERECO.CEP,
BPM_PESSOAENDERECO.CAIXAPOSTAL,
(SELECT MAX(CONT1.DESCRICAOTIPOCONTATO)
   FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT1
  WHERE CONT1.IDTIPOCONTATO = 1
    AND CONT1.IDPESSOA = BPM_DADOSPESSOAFISICA.IDPESSOA
	AND CONT1.IDPESSOATIPOCONTATO = (SELECT MAX(CONT2.IDPESSOATIPOCONTATO)
                               FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT2
                              WHERE CONT2.IDTIPOCONTATO = CONT1.IDTIPOCONTATO
							    AND CONT2.IDPESSOATIPOCONTATO = CONT1.IDPESSOATIPOCONTATO
                                AND CONT2.IDPESSOA = CONT1.IDPESSOA)) AS TELEFONE1,
(SELECT MAX(CONT1.DESCRICAOTIPOCONTATO)
   FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT1
  WHERE CONT1.IDTIPOCONTATO = 2
    AND CONT1.IDPESSOA = BPM_DADOSPESSOAFISICA.IDPESSOA
	AND CONT1.IDPESSOATIPOCONTATO = (SELECT MAX(CONT2.IDPESSOATIPOCONTATO)
                               FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT2
                              WHERE CONT2.IDTIPOCONTATO = CONT1.IDTIPOCONTATO
							    AND CONT2.IDPESSOATIPOCONTATO = CONT1.IDPESSOATIPOCONTATO
                                AND CONT2.IDPESSOA = CONT1.IDPESSOA)) AS TELEFONE2,
(SELECT MAX(CONT1.DESCRICAOTIPOCONTATO)
   FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT1
  WHERE CONT1.IDTIPOCONTATO = 5
    AND CONT1.IDPESSOA = BPM_DADOSPESSOAFISICA.IDPESSOA
	AND CONT1.IDPESSOATIPOCONTATO = (SELECT MAX(CONT2.IDPESSOATIPOCONTATO)
                               FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT2
                              WHERE CONT2.IDTIPOCONTATO = CONT1.IDTIPOCONTATO
							    AND CONT2.IDPESSOATIPOCONTATO = CONT1.IDPESSOATIPOCONTATO
                                AND CONT2.IDPESSOA = CONT1.IDPESSOA)) AS CELULAR,
(SELECT MAX(CONT1.DESCRICAOTIPOCONTATO)
   FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT1
  WHERE CONT1.IDTIPOCONTATO = 3
    AND CONT1.INDCONTATOPRINCIPAL = 1
    AND CONT1.IDPESSOA = BPM_DADOSPESSOAFISICA.IDPESSOA
	AND CONT1.DATAHORALOG = (SELECT MAX(CONT2.DATAHORALOG)
                               FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT2
                              WHERE CONT2.IDTIPOCONTATO = CONT1.IDTIPOCONTATO
							    AND CONT2.IDPESSOATIPOCONTATO = CONT1.IDPESSOATIPOCONTATO
                                AND CONT2.IDPESSOA = BPM_DADOSPESSOAFISICA.IDPESSOA)) AS EMAIL_PRINCIPAL,
(SELECT MAX(CONT1.DESCRICAOTIPOCONTATO)
   FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT1
  WHERE CONT1.IDTIPOCONTATO = 3
    AND CONT1.INDCONTATOPRINCIPAL = 0
    AND CONT1.IDPESSOA = BPM_DADOSPESSOAFISICA.IDPESSOA
	AND CONT1.DATAHORALOG = (SELECT MAX(CONT2.DATAHORALOG)
                               FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT2
                              WHERE CONT2.IDTIPOCONTATO = CONT1.IDTIPOCONTATO
							    AND CONT2.IDPESSOATIPOCONTATO = CONT1.IDPESSOATIPOCONTATO
                                AND CONT2.IDPESSOA = BPM_DADOSPESSOAFISICA.IDPESSOA)) AS EMAIL_ALTERNATIVO,								
BPM_DADOSPESSOAFISICA.DATANASCIMENTO,
(SELECT DOM_MUNICIPIO.CODIGOIBGE FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE BPM_DADOSPESSOAFISICA.IDMUNICIPIONATURALIDADE = DOM_MUNICIPIO.IDMUNICIPIO) AS LOCALNASCTOIBGE,
(SELECT DOM_MUNICIPIO.NOMEMUNICIPIO FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE BPM_DADOSPESSOAFISICA.IDMUNICIPIONATURALIDADE = DOM_MUNICIPIO.IDMUNICIPIO) AS CIDADENASCIMENTO,
(SELECT DOM_UF.ABREVIATURAUF FROM NG_DOMINIO.DBO.DOM_UF WHERE (SELECT DOM_MUNICIPIO.IDUF FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE BPM_DADOSPESSOAFISICA.IDMUNICIPIONATURALIDADE = DOM_MUNICIPIO.IDMUNICIPIO) = DOM_UF.IDUF) AS UFNASCIMENTO,
(SELECT CODIGORACA FROM NG_DOMINIO.DBO.DOM_RACA WHERE DOM_RACA.IDRACA = BPM_DADOSPESSOAFISICA.IDRACA) AS RACA,
(SELECT CODIGOGRAUINSTRUCAO FROM NG_DOMINIO.DBO.DOM_GRAUINSTRUCAO WHERE DOM_GRAUINSTRUCAO.IDGRAUINSTRUCAO = BPM_DADOSPESSOAFISICA.IDGRAUINSTRUCAO) AS GRAUINSTRUCAO,
(SELECT CODIGOESTADOCIVIL FROM NG_DOMINIO.DBO.DOM_ESTADOCIVIL WHERE DOM_ESTADOCIVIL.IDESTADOCIVIL = BPM_DADOSPESSOAFISICA.IDESTADOCIVIL) AS ESTADOCIVIL,
BPM_DADOSPESSOAFISICA.CPF,
BPM_DADOSPESSOAFISICA.INSCRICAOINSS,
BPM_DADOSPESSOAFISICA.NUMERODOCUMENTOIDENTIDADE,
BPM_DADOSPESSOAFISICA.DATAEXPEDICAODOCUMENTOIDENTIDADE,
BPM_DADOSPESSOAFISICA.ORGAOEXPEDIDORDOCUMENTOIDENTIDADE,
BPM_DADOSPESSOAFISICA.INDSEXO,
BPM_DADOSPESSOAFISICA.TITULOELEITOR,
BPM_DADOSPESSOAFISICA.ZONAELEITORAL,
BPM_DADOSPESSOAFISICA.SECAOELEITORAL,
BPM_DADOSPESSOAFISICA.NUMERODOCUMENTOMILITAR,
(SELECT CODIGOCATEGORIADOCUMENTOMILITAR FROM NG_DOMINIO.DBO.DOM_CATEGORIADOCUMENTOMILITAR WHERE DOM_CATEGORIADOCUMENTOMILITAR.IDCATEGORIADOCUMENTOMILITAR = BPM_DADOSPESSOAFISICA.IDCATEGORIADOCUMENTOMILITAR) AS CATEGORIADOCUMENTOMILITAR,
BPM_DADOSPESSOAFISICA.DATAEMISSAOCNH,
BPM_DADOSPESSOAFISICA.NUMEROCNH,
(SELECT DESCRICAOCATEGORIAHABILITACAOCNH FROM NG_DOMINIO.DBO.DOM_CATEGORIAHABILITACAOCNH WHERE DOM_CATEGORIAHABILITACAOCNH.IDCATEGORIAHABILITACAOCNH = BPM_DADOSPESSOAFISICA.IDCATEGORIAHABILITACAOCNH) AS CATEGORIAHABILITACAOCNH,
BPM_DADOSPESSOAFISICA.VENCIMENTOCNH,
(SELECT DOM_UF.ABREVIATURAUF FROM NG_DOMINIO.DBO.DOM_UF WHERE DOM_UF.IDUF = BPM_DADOSPESSOAFISICA.IDUFCNH) AS UFCNH,
BPM_DADOSPESSOAFISICA.DATACHEGADA,
BPM_DADOSPESSOAFISICA.INDCONJUGEBRASILEIRO,
BPM_DADOSPESSOAFISICA.INDNATURALIZADO,
BPM_DADOSPESSOAFISICA.NUMERODECRETO,
BPM_DADOSPESSOAFISICA.TIPOVISTO,
BPM_DADOSPESSOAFISICA.NUMEROFILHOSBRASILEIROS,
BPM_DADOSPESSOAFISICA.REGISTROGERALESTRANGEIRO,
BPM_DADOSPESSOAFISICA.VALIDADEIDENTIDADE,
BPM_DADOSPESSOAFISICA.VALIDADECTPS,
BPM_DADOSPESSOAFISICA.IDPAISNACIONALIDADEESTRANGEIRO,
BPM_DADOSPESSOAFISICA.NOMEUFNACIONALIDADEESTRANGEIRO,
BPM_DADOSPESSOAFISICA.NOMEMUNICIPIONACIONALIDADEESTRANGEIRO,
(SELECT CODIGOTIPODEFICIENCIA FROM NG_DOMINIO.DBO.DOM_TIPODEFICIENCIA WHERE DOM_TIPODEFICIENCIA.IDTIPODEFICIENCIA = BPM_DADOSPESSOAFISICA.IDTIPODEFICIENCIA) AS TIPODEFICIENCIA,
BPM_DADOSPESSOAFISICA.IDTIPOINSCRICAO,
BPM_DADOSPESSOAFISICA.NUMEROINSCRICAO,
BPM_DADOSPESSOAFISICA.DATAINSCRICAO,
BPM_DADOSPESSOAFISICA.HABILITACAOPROFISSIONAL,
BPM_DADOSPESSOAFISICA.NUMEROREGISTROPROFISSIONAL,
BPM_DADOSPESSOAFISICA.ORGAOEXPEDIDORREGISTROPROFISSIONAL,
(SELECT MAX(NG_FOLHA.DBO.FLH_FERIAS.DATAFIMPERIODOAQUISITIVO)
   FROM NG_FOLHA.DBO.FLH_FERIAS
  WHERE FLH_FERIAS.DATAFIMPERIODOAQUISITIVO IS NOT NULL
    AND FLH_FERIAS.IDREGISTRO = FLH_REGISTRO.IDREGISTRO) AS PERIODO_AQUISITIVO,
(SELECT DATAINICIOATIVIDADE FROM NG_FOLHA.DBO.FLH_ESO_REGISTROTRABALHADORSEMVINCULOEMPREGO WHERE FLH_ESO_REGISTROTRABALHADORSEMVINCULOEMPREGO.IDREGISTRO = FLH_REGISTRO.IDREGISTRO) AS INICIO_CONTRATO,
(SELECT BPM_DADOSPESSOAJURIDICA.CNPJ FROM NG.DBO.BPM_DADOSPESSOAJURIDICA AS BPM_DADOSPESSOAJURIDICA WHERE BPM_DADOSPESSOAJURIDICA.IDPESSOA IN (SELECT SUBTABLE.IDOWNER FROM NG_FOLHA.DBO.FLH_REGISTRO AS SUBTABLE WHERE FLH_REGISTRO.IDREGISTROORIGEM = SUBTABLE.IDREGISTRO) AND FLH_REGISTRO.IDREGISTROORIGEM IS NOT NULL) AS CNPJORIGEM,
BPM_DADOSPESSOAFISICA.NUMEROREGISTROPROFISSIONAL,
BPM_DADOSPESSOAFISICA.ORGAOEXPEDIDORREGISTROPROFISSIONAL,
BPM_DADOSPESSOAFISICA.DATAEXPEDICAOREGISTROPROFISSIONAL,
BPM_DADOSPESSOAFISICA.DATAVALIDADEREGISTROPROFISSIONAL,
BPM_DADOSPESSOAFISICA.HABILITACAOPROFISSIONAL,
BPM_DADOSPESSOAFISICA.TIPOCERTIDAOCIVIL,
BPM_DADOSPESSOAFISICA.DATAEMISSAOCERTIDAOCIVIL,
BPM_DADOSPESSOAFISICA.TERMOMATRICULACERTIDAOCIVIL,
BPM_DADOSPESSOAFISICA.LIVROCERTIDAOCIVIL,
BPM_DADOSPESSOAFISICA.FOLHACERTIDAOCIVIL,
BPM_DADOSPESSOAFISICA.CARTORIOCERTIDAOCIVIL,
(SELECT DOM_UF.ABREVIATURAUF FROM NG_DOMINIO.DBO.DOM_UF WHERE DOM_UF.IDUF = BPM_DADOSPESSOAFISICA.IDUFCERTIDAOCIVIL) AS UFCERTVICIL,
(SELECT DOM_MUNICIPIO.NOMEMUNICIPIO FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE BPM_DADOSPESSOAFISICA.IDMUNICIPIOCERTIDAOCIVIL = DOM_MUNICIPIO.IDMUNICIPIO) AS CIDACERTCIVIL,
BPM_DADOSPESSOAFISICA.NUMEROPASSAPORTE,
BPM_DADOSPESSOAFISICA.ORGAOEMISSORPASSAPORTE,
BPM_DADOSPESSOAFISICA.DATAEMISSAOPASSAPORTE,
BPM_DADOSPESSOAFISICA.DATAVALIDADEPASSAPORTE,
BPM_DADOSPESSOAFISICA.IDPAISPASSAPORTE,
(SELECT DOM_UF.ABREVIATURAUF FROM NG_DOMINIO.DBO.DOM_UF WHERE DOM_UF.IDUF = BPM_DADOSPESSOAFISICA.IDUFPASSAPORTE) AS UFPASSAPORTE,
BPM_DADOSPESSOAFISICA.NUMERORIC,
(SELECT DOM_UF.ABREVIATURAUF FROM NG_DOMINIO.DBO.DOM_UF WHERE DOM_UF.IDUF = BPM_DADOSPESSOAFISICA.IDUFRIC) AS UFRIC,
(SELECT DOM_MUNICIPIO.NOMEMUNICIPIO FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE BPM_DADOSPESSOAFISICA.IDMUNICIPIORIC = DOM_MUNICIPIO.IDMUNICIPIO) AS CIDARIC,
BPM_DADOSPESSOAFISICA.ORGAOEMISSORRIC,
BPM_DADOSPESSOAFISICA.DATAEXPEDICAORIC,
FLH_REGISTRO.NUMEROMATRICULAESOCIAL,
FLH_MOVIMENTOFILIAL.IDPESSOAEMPRESA,
FLH_MOVIMENTOFILIAL.DATAFIM,
FLH_REGISTRO.DESCRICAOCOMPLEMENTOSALARIO,
(SELECT MAX(INFOTSVINICIO_CODCATEG)
FROM NG_ESOCIAL.DBO.ESO_S2300 AS S2300 
WHERE S2300.IDOWNER = FLH_REGISTRO.IDOWNER
AND S2300.TRABALHADOR_CPFTRAB = BPM_DADOSPESSOAFISICA.CPF) CATEGORIA_ESOCIAL,
SUB.codigoregistro as MATRICULA_ORIGEM

FROM NG_FOLHA.DBO.FLH_REGISTRO AS FLH_REGISTRO

LEFT JOIN NG_FOLHA.DBO.FLH_REGISTRO as SUB
ON SUB.idregistro = FLH_REGISTRO.idregistroorigem

LEFT JOIN  NG.DBO.BPM_DADOSFUNCIONARIO
ON BPM_DADOSFUNCIONARIO.IDPESSOA = FLH_REGISTRO.IDPESSOAREGISTRO
AND BPM_DADOSFUNCIONARIO.IDOWNER = FLH_REGISTRO.IDOWNER

LEFT JOIN NG.DBO.BPM_PESSOA
ON FLH_REGISTRO.IDPESSOAREGISTRO = BPM_PESSOA.IDPESSOA

LEFT JOIN NG.DBO.BPM_PESSOAENDERECO
ON FLH_REGISTRO.IDPESSOAREGISTRO = BPM_PESSOAENDERECO.IDPESSOA

LEFT JOIN NG.DBO.BPM_DADOSPESSOAFISICA
ON FLH_REGISTRO.IDPESSOAREGISTRO = BPM_DADOSPESSOAFISICA.IDPESSOA

LEFT JOIN NG_FOLHA.DBO.FLH_MOVIMENTOFILIAL
ON FLH_REGISTRO.IDOWNER = (SELECT FLH_REGISTRO.IDOWNER FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOFILIAL.IDREGISTRO)
AND FLH_REGISTRO.CODIGOREGISTRO = (SELECT FLH_REGISTRO.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOFILIAL.IDREGISTRO)
ORDER BY 1, 2