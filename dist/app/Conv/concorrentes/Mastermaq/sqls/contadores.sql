SELECT
BPM_DADOSCONTADOR.IDOWNER,
BPM_DADOSCONTADOR.IDDADOSCONTADOR,
BPM_DADOSCONTADOR.IDPESSOA,
(SELECT BPM_PESSOA.NOMEPESSOA FROM NG.DBO.BPM_PESSOA WHERE BPM_PESSOA.IDPESSOA = BPM_DADOSCONTADOR.IDPESSOA) AS NOME,
BPM_DADOSCONTADOR.CARGOCONTADOR,
BPM_DADOSCONTADOR.CRC,
(SELECT DOM_UF.ABREVIATURAUF FROM NG_DOMINIO.DBO.DOM_UF WHERE BPM_DADOSCONTADOR.UFCRC = NG_DOMINIO.DBO.DOM_UF.IDUF) AS UFCRC,
BPM_DADOSCONTADOR.INDDEFINITIVO,
BPM_DADOSCONTADOR.INDRESPONSAVEL,
BPM_DADOSCONTADOR.DATAVALIDADECRC,
BPM_DADOSCONTADOR.NUMEROSEQUENCIALCRC,
BPM_DADOSPESSOAFISICA.DATANASCIMENTO,
(SELECT DOM_MUNICIPIO.CODIGOIBGE FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE BPM_DADOSPESSOAFISICA.IDMUNICIPIONATURALIDADE = DOM_MUNICIPIO.IDMUNICIPIO) AS LOCALNASCTOIBGE,
(SELECT DOM_MUNICIPIO.NOMEMUNICIPIO FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE BPM_DADOSPESSOAFISICA.IDMUNICIPIONATURALIDADE = DOM_MUNICIPIO.IDMUNICIPIO) AS CIDADENASCIMENTO,
(SELECT DOM_UF.ABREVIATURAUF FROM NG_DOMINIO.DBO.DOM_UF WHERE (SELECT DOM_MUNICIPIO.IDUF FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE BPM_DADOSPESSOAFISICA.IDMUNICIPIONATURALIDADE = DOM_MUNICIPIO.IDMUNICIPIO) = DOM_UF.IDUF) AS UFNASCIMENTO,
BPM_DADOSPESSOAFISICA.IDRACA,
BPM_DADOSPESSOAFISICA.IDGRAUINSTRUCAO,
BPM_DADOSPESSOAFISICA.IDESTADOCIVIL,
BPM_DADOSPESSOAFISICA.CPF,
BPM_DADOSPESSOAFISICA.INSCRICAOINSS,
BPM_DADOSPESSOAFISICA.NUMERODOCUMENTOIDENTIDADE,
BPM_DADOSPESSOAFISICA.DATAEXPEDICAODOCUMENTOIDENTIDADE,
BPM_DADOSPESSOAFISICA.ORGAOEXPEDIDORDOCUMENTOIDENTIDADE,
BPM_DADOSPESSOAFISICA.INDSEXO,
BPM_DADOSPESSOAFISICA.TITULOELEITOR,
BPM_DADOSPESSOAFISICA.ZONAELEITORAL,
BPM_DADOSPESSOAFISICA.SECAOELEITORAL,
BPM_DADOSPESSOAFISICA.NUMERODOCUMENTOMILITAR,
(SELECT CODIGOCATEGORIADOCUMENTOMILITAR FROM NG_DOMINIO.DBO.DOM_CATEGORIADOCUMENTOMILITAR WHERE DOM_CATEGORIADOCUMENTOMILITAR.IDCATEGORIADOCUMENTOMILITAR = BPM_DADOSPESSOAFISICA.IDCATEGORIADOCUMENTOMILITAR) AS CATEGORIADOCUMENTOMILITAR,
BPM_DADOSPESSOAFISICA.DATAEMISSAOCNH,
BPM_DADOSPESSOAFISICA.NUMEROCNH,
(SELECT DESCRICAOCATEGORIAHABILITACAOCNH FROM NG_DOMINIO.DBO.DOM_CATEGORIAHABILITACAOCNH WHERE DOM_CATEGORIAHABILITACAOCNH.IDCATEGORIAHABILITACAOCNH = BPM_DADOSPESSOAFISICA.IDCATEGORIAHABILITACAOCNH) AS CATEGORIAHABILITACAOCNH,
BPM_DADOSPESSOAFISICA.VENCIMENTOCNH,
(SELECT DOM_UF.ABREVIATURAUF FROM NG_DOMINIO.DBO.DOM_UF WHERE DOM_UF.IDUF = BPM_DADOSPESSOAFISICA.IDUFCNH) AS UFCNH,
BPM_DADOSPESSOAFISICA.DATACHEGADA,
BPM_DADOSPESSOAFISICA.INDCONJUGEBRASILEIRO,
BPM_DADOSPESSOAFISICA.INDNATURALIZADO,
BPM_DADOSPESSOAFISICA.NUMERODECRETO,
BPM_DADOSPESSOAFISICA.TIPOVISTO,
BPM_DADOSPESSOAFISICA.NUMEROFILHOSBRASILEIROS,
BPM_DADOSPESSOAFISICA.REGISTROGERALESTRANGEIRO,
BPM_DADOSPESSOAFISICA.VALIDADEIDENTIDADE,
BPM_DADOSPESSOAFISICA.VALIDADECTPS,
BPM_DADOSPESSOAFISICA.IDPAISNACIONALIDADEESTRANGEIRO,
BPM_DADOSPESSOAFISICA.NOMEUFNACIONALIDADEESTRANGEIRO,
BPM_DADOSPESSOAFISICA.NOMEMUNICIPIONACIONALIDADEESTRANGEIRO,
BPM_DADOSPESSOAFISICA.IDTIPODEFICIENCIA,
BPM_DADOSPESSOAFISICA.IDTIPOINSCRICAO,
BPM_DADOSPESSOAFISICA.NUMEROINSCRICAO,
BPM_DADOSPESSOAFISICA.DATAINSCRICAO,
BPM_DADOSPESSOAFISICA.HABILITACAOPROFISSIONAL,
BPM_DADOSPESSOAFISICA.NUMEROREGISTROPROFISSIONAL,
BPM_DADOSPESSOAFISICA.ORGAOEXPEDIDORREGISTROPROFISSIONAL,
(SELECT DOM_TIPOLOGRADOURO.DESCRICAOTIPOLOGRADOURO FROM NG_DOMINIO.DBO.DOM_TIPOLOGRADOURO WHERE ENDERECO_RESIDENCIAL.IDTIPOLOGRADOURO = DOM_TIPOLOGRADOURO.IDTIPOLOGRADOURO) AS RES_TIPOLOGRADOURO,
(SELECT DOM_TITULOLOGRADOURO.DESCRICAOTITULOLOGRADOURO FROM NG_DOMINIO.DBO.DOM_TITULOLOGRADOURO WHERE ENDERECO_RESIDENCIAL.IDTITULOLOGRADOURO = DOM_TITULOLOGRADOURO.IDTITULOLOGRADOURO) AS RES_TITULOLOGRADOURO,
ENDERECO_RESIDENCIAL.LOGRADOURO AS RES_LOGRADOURO,
ENDERECO_RESIDENCIAL.NUMEROENDERECO AS RES_NUMEROENDERECO,
ENDERECO_RESIDENCIAL.COMPLEMENTO AS RES_COMPLEMENTO,
ENDERECO_RESIDENCIAL.BAIRRO AS RES_BAIRRO,
(SELECT DOM_MUNICIPIO.CODIGOIBGE FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE ENDERECO_RESIDENCIAL.IDMUNICIPIO = DOM_MUNICIPIO.IDMUNICIPIO) AS RES_CODIGOIBGE,
(SELECT DOM_MUNICIPIO.NOMEMUNICIPIO FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE ENDERECO_RESIDENCIAL.IDMUNICIPIO = DOM_MUNICIPIO.IDMUNICIPIO) AS RES_CIDADE,
(SELECT DOM_UF.ABREVIATURAUF FROM NG_DOMINIO.DBO.DOM_UF WHERE (SELECT DOM_MUNICIPIO.IDUF FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE ENDERECO_RESIDENCIAL.IDMUNICIPIO = DOM_MUNICIPIO.IDMUNICIPIO) = DOM_UF.IDUF) AS RES_ESTADO,
ENDERECO_RESIDENCIAL.CEP AS RES_CEP,
ENDERECO_RESIDENCIAL.CAIXAPOSTAL AS RES_CAIXAPOSTAL,
(SELECT CONT1.DESCRICAOTIPOCONTATO
   FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT1
  WHERE CONT1.IDTIPOCONTATO = 1
    AND CONT1.IDPESSOA = ENDERECO_RESIDENCIAL.IDPESSOA
	AND CONT1.IDPESSOATIPOCONTATO = (SELECT MAX(CONT2.IDPESSOATIPOCONTATO)
                               FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT2
                              WHERE CONT2.IDTIPOCONTATO = CONT1.IDTIPOCONTATO
                                AND CONT2.IDPESSOA = CONT1.IDPESSOA)) AS RES_TELEFONE1,
(SELECT CONT1.DESCRICAOTIPOCONTATO
   FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT1
  WHERE CONT1.IDTIPOCONTATO = 2
    AND CONT1.IDPESSOA = ENDERECO_RESIDENCIAL.IDPESSOA
	AND CONT1.IDPESSOATIPOCONTATO = (SELECT MAX(CONT2.IDPESSOATIPOCONTATO)
                               FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT2
                              WHERE CONT2.IDTIPOCONTATO = CONT1.IDTIPOCONTATO
                                AND CONT2.IDPESSOA = CONT1.IDPESSOA)) AS RES_TELEFONE2,
(SELECT CONT1.DESCRICAOTIPOCONTATO
   FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT1
  WHERE CONT1.IDTIPOCONTATO = 5
    AND CONT1.IDPESSOA = ENDERECO_RESIDENCIAL.IDPESSOA
	AND CONT1.IDPESSOATIPOCONTATO = (SELECT MAX(CONT2.IDPESSOATIPOCONTATO)
                               FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT2
                              WHERE CONT2.IDTIPOCONTATO = CONT1.IDTIPOCONTATO
                                AND CONT2.IDPESSOA = CONT1.IDPESSOA)) AS RES_CELULAR,
(SELECT CONT1.DESCRICAOTIPOCONTATO
   FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT1
  WHERE CONT1.IDTIPOCONTATO = 3
    AND CONT1.IDPESSOA = ENDERECO_RESIDENCIAL.IDPESSOA
	AND CONT1.IDPESSOATIPOCONTATO = (SELECT MAX(CONT2.IDPESSOATIPOCONTATO)
                               FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT2
                              WHERE CONT2.IDTIPOCONTATO = 1
                                AND CONT2.IDPESSOA = ENDERECO_RESIDENCIAL.IDPESSOA)) AS RES_EMAIL,
(SELECT DOM_TIPOLOGRADOURO.DESCRICAOTIPOLOGRADOURO FROM NG_DOMINIO.DBO.DOM_TIPOLOGRADOURO WHERE ENDERECO_COMERCIAL.IDTIPOLOGRADOURO = DOM_TIPOLOGRADOURO.IDTIPOLOGRADOURO) AS COM_TIPOLOGRADOURO,
(SELECT DOM_TITULOLOGRADOURO.DESCRICAOTITULOLOGRADOURO FROM NG_DOMINIO.DBO.DOM_TITULOLOGRADOURO WHERE ENDERECO_COMERCIAL.IDTITULOLOGRADOURO = DOM_TITULOLOGRADOURO.IDTITULOLOGRADOURO) AS COM_TITULOLOGRADOURO,
ENDERECO_COMERCIAL.LOGRADOURO AS COM_LOGRADOURO,
ENDERECO_COMERCIAL.NUMEROENDERECO AS COM_NUMEROENDERECO,
ENDERECO_COMERCIAL.COMPLEMENTO AS COM_COMPLEMENTO,
ENDERECO_COMERCIAL.BAIRRO AS COM_BAIRRO,
(SELECT DOM_MUNICIPIO.CODIGOIBGE FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE ENDERECO_COMERCIAL.IDMUNICIPIO = DOM_MUNICIPIO.IDMUNICIPIO) AS COM_CODIGOIBGE,
(SELECT DOM_MUNICIPIO.NOMEMUNICIPIO FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE ENDERECO_COMERCIAL.IDMUNICIPIO = DOM_MUNICIPIO.IDMUNICIPIO) AS COM_CIDADE,
(SELECT DOM_UF.ABREVIATURAUF FROM NG_DOMINIO.DBO.DOM_UF WHERE (SELECT DOM_MUNICIPIO.IDUF FROM NG_DOMINIO.DBO.DOM_MUNICIPIO WHERE ENDERECO_COMERCIAL.IDMUNICIPIO = DOM_MUNICIPIO.IDMUNICIPIO) = DOM_UF.IDUF) AS COM_ESTADO,
ENDERECO_COMERCIAL.CEP AS COM_CEP,
ENDERECO_COMERCIAL.CAIXAPOSTAL AS COM_CAIXAPOSTAL,
(SELECT CONT1.DESCRICAOTIPOCONTATO
   FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT1
  WHERE CONT1.IDTIPOCONTATO = 1
    AND CONT1.IDPESSOA = ENDERECO_COMERCIAL.IDPESSOA
	AND CONT1.IDPESSOATIPOCONTATO = (SELECT MAX(CONT2.IDPESSOATIPOCONTATO)
                               FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT2
                              WHERE CONT2.IDTIPOCONTATO = CONT1.IDTIPOCONTATO
                                AND CONT2.IDPESSOA = CONT1.IDPESSOA)) AS COM_TELEFONE1,
(SELECT CONT1.DESCRICAOTIPOCONTATO
   FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT1
  WHERE CONT1.IDTIPOCONTATO = 2
    AND CONT1.IDPESSOA = ENDERECO_COMERCIAL.IDPESSOA
	AND CONT1.IDPESSOATIPOCONTATO = (SELECT MAX(CONT2.IDPESSOATIPOCONTATO)
                               FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT2
                              WHERE CONT2.IDTIPOCONTATO = CONT1.IDTIPOCONTATO
                                AND CONT2.IDPESSOA = CONT1.IDPESSOA)) AS COM_TELEFONE2,
(SELECT CONT1.DESCRICAOTIPOCONTATO
   FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT1
  WHERE CONT1.IDTIPOCONTATO = 4
    AND CONT1.IDPESSOA = ENDERECO_COMERCIAL.IDPESSOA
	AND CONT1.IDPESSOATIPOCONTATO = (SELECT MAX(CONT2.IDPESSOATIPOCONTATO)
                               FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT2
                              WHERE CONT2.IDTIPOCONTATO = CONT1.IDTIPOCONTATO
                                AND CONT2.IDPESSOA = CONT1.IDPESSOA)) AS COM_FAX,
(SELECT CONT1.DESCRICAOTIPOCONTATO
   FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT1
  WHERE CONT1.IDTIPOCONTATO = 3
    AND CONT1.IDPESSOA = ENDERECO_COMERCIAL.IDPESSOA
	AND CONT1.IDPESSOATIPOCONTATO = (SELECT MAX(CONT2.IDPESSOATIPOCONTATO)
                               FROM NG.DBO.BPM_PESSOATIPOCONTATO AS CONT2
                              WHERE CONT2.IDTIPOCONTATO = 1
                                AND CONT2.IDPESSOA = ENDERECO_COMERCIAL.IDPESSOA)) AS COM_EMAIL
								
FROM NG.DBO.BPM_DADOSCONTADOR

LEFT OUTER JOIN NG.DBO.BPM_DADOSPESSOAFISICA
ON BPM_DADOSCONTADOR.IDPESSOA = BPM_DADOSPESSOAFISICA.IDPESSOA

LEFT OUTER JOIN NG.DBO.BPM_PESSOAENDERECO AS ENDERECO_RESIDENCIAL
ON BPM_DADOSCONTADOR.IDPESSOA = ENDERECO_RESIDENCIAL.IDPESSOA
AND ENDERECO_RESIDENCIAL.IDTIPOENDERECO = 1

LEFT OUTER JOIN NG.DBO.BPM_PESSOAENDERECO AS ENDERECO_COMERCIAL
ON BPM_DADOSCONTADOR.IDPESSOA = ENDERECO_COMERCIAL.IDPESSOA
AND ENDERECO_COMERCIAL.IDTIPOENDERECO = 2

ORDER BY 2