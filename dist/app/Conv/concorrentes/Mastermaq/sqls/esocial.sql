/* EVENTO 1000 */
    SELECT NG_FOLHA.DBO.FLH_ESO_S1000.IDPESSOAS1000 AS CODI_EMP, 
		   NULL AS CODIGO,
		   NG_ESOCIAL.DBO.ESO_S1000.NRRECIBO AS NUMERO_RECIBO,
		   NULL AS CODIGO_ESOCIAL,
		   '1000' AS TIPO_EVENTO,
		   NULL AS DATA,
		   NULL AS IDPESSOAEMPRESA,
		   NULL AS DATAFIM,
		   NULL AS INIAFAST,
		   NULL AS FIMAFAST
		   
      FROM NG_FOLHA.DBO.FLH_ESO_S1000 
INNER JOIN NG_ESOCIAL.DBO.ESO_S1000 
        ON NG_ESOCIAL.DBO.ESO_S1000.IDS1000 = NG_FOLHA.DBO.FLH_ESO_S1000.IDS1000
     WHERE IDSTATUSINTEGRACAO = 4 
	   AND IDTIPOAMBIENTE = 1
	   AND NG_ESOCIAL.DBO.ESO_S1000.NRRECIBO IS NOT NULL
	   
UNION 

/* EVENTO 1030 */
    SELECT NG_FOLHA.DBO.FLH_ESO_S1030.IDOWNER AS CODI_EMP,
	       NG_FOLHA.DBO.FLH_ESO_S1030.IDCARGO AS CODIGO,
	       NG_ESOCIAL.DBO.ESO_S1030.NRRECIBO AS NUMERO_RECIBO,
		   NG_ESOCIAL.DBO.ESO_S1030.IDECARGO_CODCARGO AS CODIGO_ESOCIAL,
		   '1030' AS TIPO_EVENTO,
		   NULL AS DATA,
		   NULL AS IDPESSOAEMPRESA,
		   NULL AS DATAFIM,
		   NULL AS INIAFAST,
		   NULL AS FIMAFAST

		   
      FROM NG_FOLHA.DBO.FLH_ESO_S1030 
INNER JOIN NG_ESOCIAL.DBO.ESO_S1030 
        ON NG_ESOCIAL.DBO.ESO_S1030.IDS1030 = NG_FOLHA.DBO.FLH_ESO_S1030.IDS1030
     WHERE IDSTATUSINTEGRACAO = 4 
	   AND IDTIPOAMBIENTE = 1
	   AND NG_ESOCIAL.DBO.ESO_S1030.NRRECIBO IS NOT NULL
	   
UNION

/* EVENTO 2200 */
      SELECT NG_FOLHA.DBO.FLH_ESO_S2200.IDOWNER AS CODI_EMP,
		   (SELECT T.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO AS T WHERE T.IDOWNER = FLH_ESO_S2200.IDOWNER  AND T.IDREGISTRO = FLH_ESO_S2200.IDREGISTRO)  AS CODIGO, 
		   NG_ESOCIAL.DBO.ESO_S2200.NRRECIBO AS NUMERO_RECIBO,
		   NG_ESOCIAL.DBO.ESO_S2200.VINCULO_MATRICULA AS CODIGO_ESOCIAL,
		   '2200' AS TIPO_EVENTO,
		   NULL AS DATA,		 
		   FLH_MOVIMENTOFILIAL.IDPESSOAEMPRESA,
		   FLH_MOVIMENTOFILIAL.DATAFIM,
		   NULL AS INIAFAST,
		   NULL AS FIMAFAST

		   
      FROM NG_FOLHA.DBO.FLH_ESO_S2200 
 LEFT JOIN NG_FOLHA.DBO.FLH_MOVIMENTOFILIAL 
		ON NG_FOLHA.DBO.FLH_ESO_S2200.IDOWNER = 
	(SELECT FLH_REGISTRO.IDOWNER FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOFILIAL.IDREGISTRO) AND
	(SELECT T.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO AS T WHERE T.IDOWNER = FLH_ESO_S2200.IDOWNER  AND T.IDREGISTRO = FLH_ESO_S2200.IDREGISTRO) = 
	(SELECT FLH_REGISTRO.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOFILIAL.IDREGISTRO)

INNER JOIN NG_ESOCIAL.DBO.ESO_S2200 
        ON NG_ESOCIAL.DBO.ESO_S2200.IDS2200 = NG_FOLHA.DBO.FLH_ESO_S2200.IDS2200
     WHERE IDTIPOAMBIENTE = 1
	   AND NG_ESOCIAL.DBO.ESO_S2200.NRRECIBO IS NOT NULL
	   
UNION

/* EVENTO 2205 */
      SELECT NG_FOLHA.DBO.FLH_ESO_S2205.IDOWNER AS CODI_EMP,
		   (SELECT T.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO AS T WHERE T.IDOWNER = FLH_ESO_S2205.IDOWNER  AND T.IDREGISTRO = FLH_ESO_S2205.IDREGISTRO)  AS CODIGO, 
		   NG_ESOCIAL.DBO.ESO_S2205.NRRECIBO AS NUMERO_RECIBO,
		   (SELECT MAX(E.NUMEROMATRICULAESOCIAL) FROM NG_FOLHA.DBO.FLH_REGISTRO AS E WHERE FLH_ESO_S2205.IDREGISTRO = E.IDREGISTRO AND FLH_ESO_S2205.IDOWNER = E.IDOWNER) AS CODIGO_ESOCIAL,
		   '2205' AS TIPO_EVENTO,
		   ALTERACAO_DTALTERACAO AS DATA,		 
		   FLH_MOVIMENTOFILIAL.IDPESSOAEMPRESA,
		   FLH_MOVIMENTOFILIAL.DATAFIM,
		   NULL AS INIAFAST,
		   NULL AS FIMAFAST
		   
      FROM NG_FOLHA.DBO.FLH_ESO_S2205 
 LEFT JOIN NG_FOLHA.DBO.FLH_MOVIMENTOFILIAL 
		ON NG_FOLHA.DBO.FLH_ESO_S2205.IDOWNER = 
   (SELECT FLH_REGISTRO.IDOWNER FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOFILIAL.IDREGISTRO) AND
   (SELECT T.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO AS T WHERE T.IDOWNER = FLH_ESO_S2205.IDOWNER  AND T.IDREGISTRO = FLH_ESO_S2205.IDREGISTRO) = 
   (SELECT FLH_REGISTRO.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOFILIAL.IDREGISTRO)

INNER JOIN NG_ESOCIAL.DBO.ESO_S2205 
        ON NG_ESOCIAL.DBO.ESO_S2205.IDS2205 = NG_FOLHA.DBO.FLH_ESO_S2205.IDS2205
     WHERE IDTIPOAMBIENTE = 1
	   AND NG_ESOCIAL.DBO.ESO_S2205.NRRECIBO IS NOT NULL
	   
UNION

/* EVENTO 2206 */
      SELECT NG_FOLHA.DBO.FLH_ESO_S2206.IDOWNER AS CODI_EMP,
		   (SELECT T.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO AS T WHERE T.IDOWNER = FLH_ESO_S2206.IDOWNER  AND T.IDREGISTRO = FLH_ESO_S2206.IDREGISTRO)  AS CODIGO, 
		   NG_ESOCIAL.DBO.ESO_S2206.NRRECIBO AS NUMERO_RECIBO,
		   NG_ESOCIAL.DBO.ESO_S2206.IDEVINCULO_MATRICULA AS CODIGO_ESOCIAL,
		   '2206' AS TIPO_EVENTO,
		   ALTCONTRATUAL_DTALTERACAO AS DATA,		 
		   FLH_MOVIMENTOFILIAL.IDPESSOAEMPRESA,
		   FLH_MOVIMENTOFILIAL.DATAFIM,
		   NULL AS INIAFAST,
		   NULL AS FIMAFAST

		   
      FROM NG_FOLHA.DBO.FLH_ESO_S2206 
 LEFT JOIN NG_FOLHA.DBO.FLH_MOVIMENTOFILIAL 
		ON NG_FOLHA.DBO.FLH_ESO_S2206.IDOWNER = 
   (SELECT FLH_REGISTRO.IDOWNER FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOFILIAL.IDREGISTRO) AND
   (SELECT T.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO AS T WHERE T.IDOWNER = FLH_ESO_S2206.IDOWNER  AND T.IDREGISTRO = FLH_ESO_S2206.IDREGISTRO) = 
   (SELECT FLH_REGISTRO.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOFILIAL.IDREGISTRO)

INNER JOIN NG_ESOCIAL.DBO.ESO_S2206 
        ON NG_ESOCIAL.DBO.ESO_S2206.IDS2206 = NG_FOLHA.DBO.FLH_ESO_S2206.IDS2206
     WHERE IDTIPOAMBIENTE = 1
	   AND NG_ESOCIAL.DBO.ESO_S2206.NRRECIBO IS NOT NULL
	   
UNION

/* EVENTO 2230 */
SELECT NG_FOLHA.DBO.FLH_ESO_S2230.IDOWNER AS CODI_EMP,
	      NG_FOLHA.DBO.FLH_REGISTRO.CODIGOREGISTRO AS CODIGO,
	      NG_ESOCIAL.DBO.ESO_S2230.NRRECIBO AS NUMERO_RECIBO,
	      NG_ESOCIAL.DBO.ESO_S2230.IDEVINCULO_MATRICULA AS CODIGO_ESOCIAL,
		   '2230' AS TIPO_EVENTO,
		  NULL AS DATA,
	      NG_FOLHA.DBO.FLH_MOVIMENTOFILIAL.IDPESSOAEMPRESA AS FILIAL,
	      NG_FOLHA.DBO.FLH_MOVIMENTOFILIAL.DATAFIM AS DATAFIM,
	      NG_ESOCIAL.DBO.ESO_S2230.INIAFASTAMENTO_DTINIAFAST AS INIAFAST,
	      NG_ESOCIAL.DBO.ESO_S2230.FIMAFASTAMENTO_DTTERMAFAST AS FIMAFAST
     FROM NG_FOLHA.DBO.FLH_ESO_S2230
LEFT JOIN NG_FOLHA.DBO.FLH_MOVIMENTOFILIAL 
       ON NG_FOLHA.DBO.FLH_ESO_S2230.IDOWNER = (SELECT FLH_REGISTRO.IDOWNER 
	                                              FROM NG_FOLHA.DBO.FLH_REGISTRO 
												 WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOFILIAL.IDREGISTRO) AND
                                               (SELECT NG_FOLHA.DBO.FLH_REGISTRO.CODIGOREGISTRO 
											      FROM NG_FOLHA.DBO.FLH_REGISTRO 
												 WHERE NG_FOLHA.DBO.FLH_REGISTRO.IDOWNER = FLH_ESO_S2230.IDOWNER AND
												       NG_FOLHA.DBO.FLH_REGISTRO.IDREGISTRO = FLH_ESO_S2230.IDFLHESOS2230) = (SELECT FLH_REGISTRO.CODIGOREGISTRO 
													                                                                            FROM NG_FOLHA.DBO.FLH_REGISTRO 
																															   WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOFILIAL.IDREGISTRO)

INNER JOIN NG_ESOCIAL.DBO.ESO_S2230 
        ON NG_ESOCIAL.DBO.ESO_S2230.IDS2230 = NG_FOLHA.DBO.FLH_ESO_S2230.IDS2230
INNER JOIN NG_FOLHA.DBO.FLH_MOVIMENTOAFASTAMENTO
        ON NG_FOLHA.DBO.FLH_MOVIMENTOAFASTAMENTO.IDMOVIMENTOAFASTAMENTO = NG_FOLHA.DBO.FLH_ESO_S2230.IDMOVIMENTOAFASTAMENTO
INNER JOIN NG_FOLHA.DBO.FLH_REGISTRO
        ON NG_FOLHA.DBO.FLH_REGISTRO.IDREGISTRO = NG_FOLHA.DBO.FLH_MOVIMENTOAFASTAMENTO.IDREGISTRO
     WHERE IDTIPOAMBIENTE = 1 AND ESO_S2230.NRRECIBO <> ''

UNION /*EVENTO 2300*/
SELECT NG_FOLHA.DBO.FLH_ESO_S2300.IDOWNER AS CODI_EMP,
		   (SELECT T.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO AS T WHERE T.IDOWNER = FLH_ESO_S2300.IDOWNER  AND T.IDREGISTRO = FLH_ESO_S2300.IDREGISTRO)  AS CODIGO, 
		   NG_ESOCIAL.DBO.ESO_S2300.NRRECIBO AS NUMERO_RECIBO,
		   NG_ESOCIAL.DBO.ESO_S2300.infoTSVInicio_matricula AS CODIGO_ESOCIAL,
		   '2300' AS TIPO_EVENTO,
		   NULL AS DATA,		 
		   FLH_MOVIMENTOFILIAL.IDPESSOAEMPRESA,
		   FLH_MOVIMENTOFILIAL.DATAFIM,
		   NULL AS INIAFAST,
		   NULL AS FIMAFAST

		   
      FROM NG_FOLHA.DBO.FLH_ESO_S2300 
 LEFT JOIN NG_FOLHA.DBO.FLH_MOVIMENTOFILIAL 
		ON NG_FOLHA.DBO.FLH_ESO_S2300.IDOWNER = 
	(SELECT FLH_REGISTRO.IDOWNER FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOFILIAL.IDREGISTRO) AND
	(SELECT T.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO AS T WHERE T.IDOWNER = FLH_ESO_S2300.IDOWNER  AND T.IDREGISTRO = FLH_ESO_S2300.IDREGISTRO) = 
	(SELECT FLH_REGISTRO.CODIGOREGISTRO FROM NG_FOLHA.DBO.FLH_REGISTRO WHERE FLH_REGISTRO.IDREGISTRO = FLH_MOVIMENTOFILIAL.IDREGISTRO)

INNER JOIN NG_ESOCIAL.DBO.ESO_S2300 
        ON NG_ESOCIAL.DBO.ESO_S2300.IDS2300 = NG_FOLHA.DBO.FLH_ESO_S2300.IDS2300
     WHERE IDTIPOAMBIENTE = 1
	   AND NG_ESOCIAL.DBO.ESO_S2300.NRRECIBO IS NOT NULL

ORDER BY 1,2