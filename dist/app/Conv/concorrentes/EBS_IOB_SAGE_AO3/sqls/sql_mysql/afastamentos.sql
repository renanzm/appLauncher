SELECT CD_EMPRESA,
       CD_FUNCIONARIO,
       DT_DESLIGAMENTO AS DATA_AFASTAMENTO,
       NULL AS DT_RETORNO,
       8 AS CD_AFASTAMENTO_ESOCIAL,
	   null as DURACAO_AFASTAMENTO,
        null as TIPO_AFASTAMENTO,
       'E' AS TIPO  /* EMPREGADOS */
  FROM RESCISAO
 WHERE DT_DESLIGAMENTO IS NOT NULL

UNION ALL

SELECT CD_EMPRESA,
       CD_DIRETOR AS CD_FUNCIONARIO,
       DATA_DESLIGAMENTO AS DATA_AFASTAMENTO,
       NULL AS DT_RETORNO,
       8 AS CD_AFASTAMENTO_ESOCIAL,
	   null as DURACAO_AFASTAMENTO,
        null as TIPO_AFASTAMENTO,
       'C' AS TIPO  /* CONTRIBUINTES */
  FROM DIRETOR
 WHERE SITUACAO = 'D'
   AND DATA_DESLIGAMENTO IS NOT NULL

UNION ALL

SELECT CD_EMPRESA,
       CD_AUTONOMO,
       DATA_DESLIGAMENTO AS DATA_AFASTAMENTO,
       NULL AS DT_RETORNO,
       8 AS CD_AFASTAMENTO_ESOCIAL,
	   null as DURACAO_AFASTAMENTO,
        null as TIPO_AFASTAMENTO,
       'A' AS TIPO  /* AUTONOMOS */
  FROM AUTONOMO
 WHERE DATA_DESLIGAMENTO IS NOT NULL

UNION ALL

SELECT CD_EMPRESA,
       CD_FUNCIONARIO,
       DT_MOVIMENTACAO AS DATA_AFASTAMENTO,
       DT_RETORNO,
       CD_AFASTAMENTO_ESOCIAL,
	   DURACAO_AFASTAMENTO,
        TIPO_AFASTAMENTO,
       'O' AS TIPO /* OUTROS AFASTAMENTOS*/
   FROM FUNMOVIMENTACAO
  
UNION ALL

SELECT CD_EMPRESA,
       CD_FUNCIONARIO,
       DT_MOVIMENTACAO AS DATA_AFASTAMENTO,
	   NULL AS DT_RETORNO,
       8 AS CD_AFASTAMENTO_ESOCIAL,
	   DURACAO_AFASTAMENTO,
        null as TIPO_AFASTAMENTO,
       'M' AS TIPO  /* MOVIMENTAÇÕES DE RESCISÃO */
  FROM FUNMOVIMENTACAO  
 WHERE TIPO_MOVIMENTACAO = 2

ORDER BY 1,2,5 desc,8 desc,3