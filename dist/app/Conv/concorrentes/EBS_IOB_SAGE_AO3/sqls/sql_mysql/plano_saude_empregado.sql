SELECT 
    PF.ENTERPRISE_ID,
    PF.CD_FUNCIONARIO,
    PF.CD_PLANO,
    PF.STATUS,
    MIN(
        CASE 
            WHEN LENGTH(PPF.MES) = 1 THEN STR_TO_DATE(CONCAT(PPF.ANO, '0', PPF.MES, '01'), '%Y%m%d')
            WHEN LENGTH(PPF.MES) = 2 THEN STR_TO_DATE(CONCAT(PPF.ANO, PPF.MES, '01'), '%Y%m%d')
        END
    ) AS DATA_INICIO
FROM 
    CRHPLANOSAUDEFUN PF
INNER JOIN 
    CRHPLANOSAUDEPROCFUN PPF
    ON PF.ENTERPRISE_ID = PPF.ENTERPRISE_ID
    AND PF.CD_FUNCIONARIO = PPF.CD_FUNCIONARIO
    AND PF.CD_PLANO = PPF.CD_PLANO
GROUP BY 
    PF.ENTERPRISE_ID,
    PF.CD_FUNCIONARIO,
    PF.CD_PLANO,
    PF.STATUS;
