SELECT EMP_CODIGO, FIL_ID_LOC, FIL_RECIBO, FIL_EVENTO, FIL_INIVAL, UPPER(FIL_SERVID) FIL_SERVID, UPPER(FIL_OPERAC) FIL_OPERAC, '' MATRICULA
FROM ESO_FIL 
WHERE FIL_RECIBO != '' 
AND FIL_EVENTO IN ('S-1000')
UNION
SELECT E.EMP_CODIGO, E.FIL_ID_LOC, E.FIL_RECIBO, E.FIL_EVENTO, E.FIL_INIVAL, UPPER(E.FIL_SERVID) FIL_SERVID, UPPER(E.FIL_OPERAC) FIL_OPERAC, P.PES_ESOMAT MATRICULA
FROM ESO_FIL E INNER JOIN FPG_PES P ON (E.EMP_CODIGO = P.EMP_CODIGO AND E.FIL_ID_LOC = P.PES_CODIGO)
WHERE FIL_RECIBO != '' 
AND FIL_EVENTO IN ('S-2200','S-2300','S-2205')