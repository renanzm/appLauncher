SELECT PESSOA.ID_PESSOA,
       PESSOA.CODIGO,
	   PESSOA_NOME.NOME,
	   PESSOA.INSCMF,
	   PESSOA.INSC_ESTADUAL,
	   PESSOA.INSC_MUNICIPAL,
	   NATUREZA_JURIDICA.CODIGO AS NATUREZA_JURIDICA,
	   REGISTROS.NUMERO AS INSC_JUNTA,
	   REGISTROS.DATA AS DATA_JUNTA,
	   REGISTROS.VALOR_CAPITAL,
	   CNAE.CODIGO AS CNAE,
	   PESSOA_CONTADOR.FK_CONTADOR,
	   PESSOA_GRUPO_TABELAS_GERAIS."DATA" AS INICIO_EMP,
	   TP_LOGRADOUROS.DESCRICAO AS TIPO_LOGRADOURO,
	   PESSOA_ENDERECO."LOGRADOURO",
	   PESSOA_ENDERECO."NUMERO",
	   PESSOA_ENDERECO.COMPLEMENTO,
	   PESSOA_ENDERECO."BAIRRO",
	   CIDADES.DESCRICAO AS CIDADE,
	   ESTADOS.SIGLA AS ESTADO,
	   CIDADES.CODIGO_IBGE,
	   PESSOA_ENDERECO."CEP",
	   (SELECT MIN(TELEFONE.NUMERO) FROM TELEFONE WHERE TELEFONE.FK_PESSOA = PESSOA.ID_PESSOA) AS TELEFONE,
	   (SELECT MIN(EMAIL.ENDERECO) FROM EMAIL WHERE EMAIL.FK_PESSOA = PESSOA.ID_PESSOA) AS EMAIL,
	   (SELECT MAX(PFPAS.CODIGO) FROM PFPAS WHERE PFPAS.ID_PFPAS = (SELECT MAX(PGPS.FK_FPAS)
	                                                                FROM PGPS
	                                                                WHERE PESSOA.ID_PESSOA = PGPS.FK_PESSOA AND PGPS.DATA = (SELECT MAX(SUB.DATA)
	                                                                														 FROM PGPS AS SUB
	                                                                														 WHERE SUB.FK_PESSOA = PESSOA_NOME.FK_PESSOA))) AS FPAS,
	   (SELECT MAX(PFPAS.PERCENTUAL) FROM PFPAS WHERE PFPAS.ID_PFPAS = (SELECT MAX(PGPS.FK_FPAS)
	   													                FROM PGPS
	   													                WHERE PESSOA.ID_PESSOA = PGPS.FK_PESSOA AND PGPS.DATA = (SELECT MAX(SUB.DATA)
	   													                                                                         FROM PGPS AS SUB
	   													                                                                         WHERE SUB.FK_PESSOA = PESSOA_NOME.FK_PESSOA))) AS INSS_EMPRESA,
	   PCODIGO_TERCEIROS.CODIGO AS CODIGO_TERCEIRO,
	   PCODIGO_TERCEIROS.PERCENTUAL AS PERCENTUAL_TERCEIRO
FROM PESSOA
INNER JOIN PESSOA_NOME
  	ON PESSOA.ID_PESSOA = PESSOA_NOME.FK_PESSOA
	AND PESSOA_NOME.DATA = (SELECT MAX(SUB.DATA) FROM PESSOA_NOME AS SUB WHERE SUB.FK_PESSOA = PESSOA_NOME.FK_PESSOA)
LEFT JOIN PESSOA_ENDERECO
	ON PESSOA.ID_PESSOA = PESSOA_ENDERECO.FK_PESSOA
	AND PESSOA_ENDERECO."DATA" = PESSOA_NOME."DATA"
LEFT JOIN TP_LOGRADOUROS
	ON PESSOA_ENDERECO.FK_TP_LOGRADOURO = TP_LOGRADOUROS.ID_TP_LOGRADOUROS
LEFT JOIN CIDADES
	ON PESSOA_ENDERECO.FK_CIDADE = CIDADES.ID_CIDADES
LEFT JOIN ESTADOS
	ON CIDADES.FK_ESTADO = ESTADOS.ID_ESTADOS
LEFT JOIN PESSOA_NATUREZA_JURIDICA
	ON PESSOA.ID_PESSOA = PESSOA_NATUREZA_JURIDICA.FK_PESSOA
	AND PESSOA_NATUREZA_JURIDICA."DATA" = PESSOA_NOME."DATA"
LEFT JOIN NATUREZA_JURIDICA
	ON NATUREZA_JURIDICA.ID_NATUREZA_JURIDICA = PESSOA_NATUREZA_JURIDICA.FK_NATUREZA_JURIDICA
LEFT JOIN REGISTROS
	ON REGISTROS.FK_PESSOA = PESSOA.ID_PESSOA
	AND REGISTROS."DATA" = PESSOA_NOME."DATA"
LEFT JOIN PESSOA_CNAE
	ON PESSOA_CNAE.FK_PESSOA = PESSOA.ID_PESSOA
	AND PESSOA_CNAE."DATA" = PESSOA_NOME."DATA"
LEFT JOIN CNAE
	ON PESSOA_CNAE.FK_CNAE = CNAE.ID_CNAE
LEFT JOIN PESSOA_GRUPO_TABELAS_GERAIS
  	ON PESSOA.ID_PESSOA = PESSOA_GRUPO_TABELAS_GERAIS.FK_PESSOA
	AND PESSOA_GRUPO_TABELAS_GERAIS."DATA" = PESSOA_NOME."DATA"
LEFT JOIN PESSOA_CONTADOR
  	ON PESSOA.ID_PESSOA = PESSOA_CONTADOR.FK_PESSOA
	AND PESSOA_CONTADOR."DATA" = PESSOA_NOME."DATA"
LEFT JOIN PESSOA_PESSOAL_HISTORICO
  	ON PESSOA.ID_PESSOA = PESSOA_PESSOAL_HISTORICO.FK_PESSOA
	AND PESSOA_PESSOAL_HISTORICO."DATA" = (SELECT MAX(SUB.DATA) FROM PESSOA_NOME AS SUB WHERE SUB.FK_PESSOA = PESSOA_NOME.FK_PESSOA)
LEFT JOIN PFPAS_CODIGO_TERCEIROS
	ON PFPAS_CODIGO_TERCEIROS.ID_PFPAS_CODIGO_TERCEIROS = PESSOA_PESSOAL_HISTORICO.FK_FPAS_CODIGO_TERCEIROS
LEFT JOIN PCODIGO_TERCEIROS
	ON PCODIGO_TERCEIROS.ID_PCODIGO_TERCEIROS = PFPAS_CODIGO_TERCEIROS.FK_CODIGO_TERCEIROS
ORDER BY 2