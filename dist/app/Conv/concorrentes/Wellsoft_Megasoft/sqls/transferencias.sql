SELECT TRANSF.INSCMF_SUCEDIDA AS FK_EMPRESA,
       DESTINO.ID_PFUNCIONARIO AS FK_EMPREGADO,
       TRANSF.DATA AS DATA_TRANSF,
       PESSOA.INSCMF AS EMPRESA_ORIGEM,
       ORIGEM.MATRICULA AS MATRICULA_ORIGEM
FROM PFUNCIONARIO_SITUACAO AS TRANSF
LEFT JOIN PFUNCIONARIO AS DESTINO
	ON TRANSF.INSCMF_SUCEDIDA = DESTINO.FK_PESSOA
	AND TRANSF.MATRICULA_SUCEDIDA = DESTINO.MATRICULA
LEFT JOIN PESSOA
  	ON PESSOA.ID_PESSOA = TRANSF.FK_PESSOA
LEFT JOIN PFUNCIONARIO AS ORIGEM
	ON TRANSF.FK_PESSOA = ORIGEM.FK_PESSOA
	AND TRANSF.FK_FUNCIONARIO = ORIGEM.ID_PFUNCIONARIO
WHERE TRANSF.TIPO_TRANSFERENCIA <> 0
ORDER BY 1, 2