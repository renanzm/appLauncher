SELECT PESSOA.ID_PESSOA AS EMPRESA,
	   '' AS CODIGO,
       PE_SOCIAL_LOG.NUMERO_RECIBO,
	   PE_SOCIAL_LOG.EVENTO,
	   PE_SOCIAL_LOG.CHAVE AS CODIGO_ESOCIAL
FROM PE_SOCIAL_LOG
INNER JOIN PESSOA
	ON PESSOA.INSCMF = PE_SOCIAL_LOG.FK_REGISTRO_TABELA
WHERE EVENTO = 'S-1000'
	AND NUMERO_RECIBO IS NOT NULL
	AND NUMERO_RECIBO <> ''
	AND NUMERO_RECIBO LIKE '1.1.%'

UNION ALL

SELECT PESSOA.ID_PESSOA AS EMPRESA,
	   PCARGO_FUNCAO.CODIGO AS CODIGO,
	   PE_SOCIAL_LOG.NUMERO_RECIBO,
	   PE_SOCIAL_LOG.EVENTO,
	   PE_SOCIAL_LOG.CHAVE AS CODIGO_ESOCIAL
FROM PE_SOCIAL_LOG
INNER JOIN PCARGO_FUNCAO
	ON PCARGO_FUNCAO.ID_PCARGO_FUNCAO = PE_SOCIAL_LOG.FK_REGISTRO_TABELA
INNER JOIN PESSOA
	ON PESSOA.INSCMF = PE_SOCIAL_LOG.FK_PESSOA
WHERE EVENTO = 'S-1030'
	AND NUMERO_RECIBO IS NOT NULL
	AND NUMERO_RECIBO <> ''
	AND NUMERO_RECIBO LIKE '1.1.%'

UNION ALL

SELECT PESSOA.ID_PESSOA as EMPRESA,
       PFUNCIONARIO.ID_PFUNCIONARIO AS CODIGO,
       PE_SOCIAL_LOG.NUMERO_RECIBO,
       PE_SOCIAL_LOG.EVENTO,
       PFUNCIONARIO.MATRICULA_E_SOCIAL AS CODIGO_ESOCIAL
FROM PE_SOCIAL_LOG
INNER JOIN PFUNCIONARIO
	ON PFUNCIONARIO.ID_PFUNCIONARIO = PE_SOCIAL_LOG.FK_REGISTRO_TABELA
INNER JOIN PESSOA
	ON PESSOA.ID_PESSOA = PFUNCIONARIO.FK_PESSOA
WHERE EVENTO = 'S-2200'
	AND NUMERO_RECIBO IS NOT NULL
	AND NUMERO_RECIBO <> ''
	AND NUMERO_RECIBO LIKE '1.1.%'

UNION ALL

SELECT PESSOA.ID_PESSOA AS EMPRESA,
       SOCIOS.ID_SOCIOS AS CODIGO,
       PE_SOCIAL_LOG.NUMERO_RECIBO,
       PE_SOCIAL_LOG.EVENTO,
       '' AS CODIGO_ESOCIAL
FROM PE_SOCIAL_LOG
INNER JOIN SOCIOS
	ON SOCIOS.ID_SOCIOS = PE_SOCIAL_LOG.FK_REGISTRO_TABELA
INNER JOIN PESSOA
	ON PESSOA.ID_PESSOA = SOCIOS.FK_PESSOA
WHERE EVENTO = 'S-2300'
	AND NUMERO_RECIBO IS NOT NULL
	AND NUMERO_RECIBO <> ''
	AND NUMERO_RECIBO LIKE '1.1.%'

ORDER BY 1, 4, 2