SELECT PFUNCIONARIO.FK_PESSOA,
       PFUNCIONARIO.ID_PFUNCIONARIO,
       PFUNCIONARIO.MATRICULA,
       PFUNCIONARIO.NOME,
       PFUNCIONARIO.DATA_ADMISSAO,
       PFUNCIONARIO.DATA_NASCIMENTO,
       PFUNCIONARIO.SEXO,
       PFUNCIONARIO.ESTADO_CIVIL,
       PFUNCIONARIO.RACA_COR,
       PFUNCIONARIO.INSTRUCAO,
       PFUNCIONARIO.NOME_MAE,
       PFUNCIONARIO.NOME_PAI,
       PFUNCIONARIO.NOME_CONJUGUE,
       PFUNCIONARIO.EMAIL,
       PFUNCIONARIO.TELEFONE,
       PFUNCIONARIO.CELULAR,
       PFUNCIONARIO.MATRICULA_E_SOCIAL,
	   TP_LOGRADOUROS.DESCRICAO AS TIPO_LOGRADOURO,
       PFUNCIONARIO_ENDERECO."LOGRADOURO",
       PFUNCIONARIO_ENDERECO.COMPLEMENTO,
       PFUNCIONARIO_ENDERECO."NUMERO" AS NUMERO_ENDERECO,
       PFUNCIONARIO_ENDERECO."BAIRRO",
       PFUNCIONARIO_ENDERECO.FK_CIDADE,
       PFUNCIONARIO_ENDERECO.CEP,
       PFUNCIONARIO.FK_CIDADE_NASCIMENTO,
       PNACIONALIDADE.CODIGO AS NACIONALIDADE,
       PFUNCIONARIO.DATA_CHEGADA_BRASIL,
       PFUNCIONARIO_ESTAGIO.INST_ENSINO_INSCMF,
       PFUNCIONARIO_ESTAGIO.INST_ENSINO_NOME,
       PFUNCIONARIO_ESTAGIO.AG_INTEGRA_INSCMF,
       PFUNCIONARIO_ESTAGIO.AG_INTEGRA_NOME,
       PFUNCIONARIO_ESTAGIO.SUPERVISOR_CPF,
       PFUNCIONARIO_ESTAGIO.SUPERVISOR_NOME,
       PFUNCIONARIO_ESTAGIO.AREA_ATUACAO,
       PFUNCIONARIO_ESTAGIO.NATUREZA,
       PFUNCIONARIO_ESTAGIO.NIVEL,
       PFUNCIONARIO_ESTAGIO.NUMERO_APOLICE,
       PFUNCIONARIO.VINCULO,
       PFUNCIONARIO.TIPO_ADMISSAO,
       PFUNCIONARIO.DATA_OPCAO,
       PFUNCIONARIO.CONTA_PGTO,
       PFUNCIONARIO.DG_CONTA_PGTO,
       PFUNCIONARIO.FK_BCO_AGE_PGTO,
       PFUNCIONARIO.CPF,
       PFUNCIONARIO.PIS,
       PFUNCIONARIO.DATA_PIS,
       PFUNCIONARIO.DATA_AQUISICAO,
       PFUNCIONARIO.DESC_C_SINDICAL,
       PFUNCIONARIO.CTPS,
       PFUNCIONARIO.SERIE_CTPS,
       EST_CTPS.SIGLA AS UF_CTPS,
       PFUNCIONARIO.CTPS_DATA_EMISSAO,
       PFUNCIONARIO.TITULO_ELEITOR,
       PFUNCIONARIO.ZONA_ELEITOR,
       PFUNCIONARIO.SESSAO_ELEITOR,
       PFUNCIONARIO.RG,
       RG_ORGAO_EMISSOR.SIGLA AS ORGAO_RG,
       PFUNCIONARIO.RG_DATA_EMISSAO,
       EST_RG.SIGLA AS UF_RG,
       PFUNCIONARIO.CERT_MILITAR,
       PFUNCIONARIO.CATEG_CERT_MILITAR,
       PFUNCIONARIO.NUMERO_CNH,
       EST_CNH.SIGLA AS UF_CNH,
       PFUNCIONARIO.DATA_PRIMEIRA_CNH,
       PFUNCIONARIO.DATA_EXPEDICAO_CNH,
       PFUNCIONARIO.DATA_VALIDADE_CNH,
       PFUNCIONARIO.CATEGORIA_CNH,
       PFUNCIONARIO.NUMERO_RIC_RNE,
       PFUNCIONARIO.RIC_RNE_DATA_EXPEDICAO,
       PFUNCIONARIO.DATA_FIM_CTT_EXPERIENCIA,
       PFUNCIONARIO.DATA_PRORROG_EXPERIENCIA
FROM PFUNCIONARIO
LEFT JOIN PFUNCIONARIO_ENDERECO
	ON PFUNCIONARIO_ENDERECO.FK_PESSOA = PFUNCIONARIO.FK_PESSOA
	AND PFUNCIONARIO_ENDERECO.FK_FUNCIONARIO = PFUNCIONARIO.ID_PFUNCIONARIO
	AND PFUNCIONARIO_ENDERECO."DATA" = (SELECT MAX(SUB.DATA)
	                                    FROM PFUNCIONARIO_ENDERECO AS SUB
	                                    WHERE SUB.FK_PESSOA = PFUNCIONARIO.FK_PESSOA
	                                    AND SUB.FK_FUNCIONARIO = PFUNCIONARIO.ID_PFUNCIONARIO)
LEFT JOIN TP_LOGRADOUROS
	ON PFUNCIONARIO_ENDERECO.FK_TP_LOGRADOURO = TP_LOGRADOUROS.ID_TP_LOGRADOUROS
LEFT JOIN PNACIONALIDADE
	ON PFUNCIONARIO.FK_NACIONALIDADE = PNACIONALIDADE.ID_PNACIONALIDADE
LEFT JOIN PFUNCIONARIO_ESTAGIO
	ON PFUNCIONARIO_ESTAGIO.FK_PESSOA = PFUNCIONARIO.FK_PESSOA
	AND PFUNCIONARIO_ESTAGIO.FK_PFUNCIONARIO = PFUNCIONARIO.ID_PFUNCIONARIO
LEFT JOIN RG_ORGAO_EMISSOR
	ON PFUNCIONARIO.FK_RG_ORGAO_EMISSOR = RG_ORGAO_EMISSOR.ID_RG_ORGAO_EMISSOR
LEFT JOIN ESTADOS EST_CTPS
	ON PFUNCIONARIO.FK_ESTADO_CTPS = EST_CTPS.ID_ESTADOS
LEFT JOIN ESTADOS EST_RG
	ON PFUNCIONARIO.FK_ESTADO_RG = EST_RG.ID_ESTADOS
LEFT JOIN ESTADOS EST_CNH
	ON PFUNCIONARIO.FK_UF_CNH = EST_CNH.ID_ESTADOS
ORDER BY 1, 3