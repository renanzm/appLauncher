SELECT PFUNC.CODCOLIGADA,
       PFUNC.CHAPA,
       PFUNC.NOME,
       PFUNC.CODSINDICATO,
       PFUNC.CODHORARIO,
       PFUNC.SALARIO,
       PFUNC.DTOPCAOFGTS,
       PFUNC.CONTAFGTS,
       PFUNC.CONTRIBSINDICAL,
       PFUNC.TIPOADMISSAO,
       PFUNC.DATADEMISSAO,
       PFUNC.PISPARAFGTS,
       PFUNC.PISPASEP,
       PFUNC.DTCADASTROPIS,
       PFUNC.CODBANCOFGTS,
       PFUNC.CODCATEGORIA,
       PFUNC.CLASSECONTRIB,
       PFUNC.DATAADMISSAO,
       PFUNC.CODFILIAL,
       PFUNC.TIPOADMISSAO,
       PFUNC.CONTAPAGAMENTO,
       PFUNC.MATRICULAESOCIAL,
       PFUNC.CODRECEBIMENTO,
       PFUNC.CODSITUACAO,
       PFUNC.DTDESLIGAMENTO,
       PFUNC.DTDESLIGAMENTOREINT,
       PFUNC.FIMPRAZOCONTR,
       PFUNC.DTVENCFERIAS,
       PFUNC.DTTRANSFERENCIA,
       PFUNC.CODCOLIGADAORIGEM,
       PFUNC.CHAPAORIGEM,
       PFUNC.CODBANCOPAGTO,
	   PFUNC.OPBANCARIA,
       PFUNC.CODAGENCIAPAGTO,
       PFUNC.CODBANCOPIS,
       PFUNC.VINCULORAIS,
       PFUNC.CODOCORRENCIA,
       PFUNC.JORNADAMENSAL,
       PFUNC.CODCATEGORIAESOCIAL,
       PPESSOA.DTNASCIMENTO,
       PPESSOA.ESTADOCIVIL,
       PPESSOA.SEXO,
       PPESSOA.NACIONALIDADE,
       PPESSOA.GRAUINSTRUCAO,
       PPESSOA.RUA,
	   PPESSOA.CODTIPORUA,
       PPESSOA.NUMERO,
       PPESSOA.COMPLEMENTO,
       PPESSOA.BAIRRO,
       PPESSOA.ESTADO,
       PPESSOA.CIDADE,
       PPESSOA.CEP,
       PPESSOA.PAIS,
       PPESSOA.CPF,
       PPESSOA.TELEFONE1,
       PPESSOA.CARTIDENTIDADE,
       PPESSOA.UFCARTIDENT,
       PPESSOA.ORGEMISSORIDENT,
       PPESSOA.DTEMISSAOIDENT,
       PPESSOA.TITULOELEITOR,
       PPESSOA.ZONATITELEITOR,
       PPESSOA.SECAOTITELEITOR,
       PPESSOA.CARTEIRATRAB,
       PPESSOA.SERIECARTTRAB,
       PPESSOA.UFCARTTRAB,
       PPESSOA.DTCARTTRAB,
       PPESSOA.CARTMOTORISTA,
       PPESSOA.TIPOCARTHABILIT,
       PPESSOA.DTVENCHABILIT,
       PPESSOA.CERTIFRESERV,
       PPESSOA.CATEGMILITAR,
       PPESSOA.NATURALIDADE,
       PPESSOA.ESTADONATAL,
       PPESSOA.DATACHEGADA,
       PPESSOA.EMAIL,
       PPESSOA.CORRACA,
       PPESSOA.DEFICIENTEFISICO,
       PPESSOA.TIPOSANG,
       PPESSOA.DATAPRIMEIRACNH,
       PPESSOA.TELEFONE2,
       PPESSOA.ORGEMISSORCNH,
       PPESSOA.DTEMISSAOCNH,
       PPESSOA.UFCNH,
       (SELECT MAX(PFDEPEND.NOME) 
        FROM PFDEPEND 
        WHERE PFUNC.CHAPA = PFDEPEND.CHAPA 
          AND PFDEPEND.GRAUPARENTESCO = '6' 
          AND PFUNC.CODCOLIGADA = PFDEPEND.CODCOLIGADA) AS PAI,
       (SELECT MAX(PFDEPEND.NOME) 
        FROM PFDEPEND 
        WHERE PFUNC.CHAPA = PFDEPEND.CHAPA 
          AND PFDEPEND.GRAUPARENTESCO = '7' 
          AND PFUNC.CODCOLIGADA = PFDEPEND.CODCOLIGADA) AS MAE,
       (SELECT MAX(PFDEPEND.NOME) 
        FROM PFDEPEND 
        WHERE PFUNC.CHAPA = PFDEPEND.CHAPA 
          AND PFDEPEND.GRAUPARENTESCO = '5' 
          AND PFUNC.CODCOLIGADA = PFDEPEND.CODCOLIGADA) AS CONJUGUE,
       PSECAO.CODIGO AS SERVICO,
       PFUNCAO.CODIGO AS CARGO,
       (SELECT MAX(GDEPTO.CODDEPARTAMENTO) 
        FROM GDEPTO 
        WHERE GDEPTO.CODDEPARTAMENTO = PSECAO.CODDEPTO 
          AND PSECAO.CODCOLIGADA = GDEPTO.CODCOLIGADA) AS DEPTO,
       (SELECT CODCCUSTO 
        FROM (SELECT PFMOVCC.CODCCUSTO 
              FROM PFMOVCC 
              WHERE PFMOVCC.CODCOLIGADA = PFUNC.CODCOLIGADA 
                AND PFMOVCC.CHAPA = PFUNC.CHAPA 
              ORDER BY PFMOVCC.ANOCOMP DESC, PFMOVCC.MESCOMP DESC, PFMOVCC.CODEVENTO DESC) 
        WHERE ROWNUM = 1) AS CCUSTO
FROM PFUNC
LEFT JOIN PSECAO
  ON PFUNC.CODSECAO = PSECAO.CODIGO
 AND PFUNC.CODCOLIGADA = PSECAO.CODCOLIGADA
LEFT JOIN PPESSOA
  ON PFUNC.CODPESSOA = PPESSOA.CODIGO
LEFT JOIN PFUNCAO
  ON PFUNC.CODCOLIGADA = PFUNCAO.CODCOLIGADA
 AND PFUNC.CODFUNCAO = PFUNCAO.CODIGO
ORDER BY PFUNC.CODCOLIGADA, PFUNC.CHAPA;