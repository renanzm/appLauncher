SELECT entidade.chv_enti,
       entidade.nome,
       socio.admissao,
       socio.chv_renti,
       socio.chv_socio,
       socio.cod_ass_sped,
       socio.demissao,
       socio.nit_pis,
       socio.participacao,
       socio.qualificacao,
       socio.seq_assinatura,
       socio.sped_qualif_benef,
       socio.sped_qualif_repr,
       socio.sped_qualificacao,
       socio.sped_tipo,
       socio.valor_capital,
       socio.participacao_votante,
       entidade.categoria,
       entidade.cnh,
       entidade.cnpjcpf,
       entidade.codigo,
       entidade.crt,
       entidade.data_abertura,
       entidade.data_nascimento,
       entidade.descricaoadicional,
       entidade.digito,
       entidade.emissor_rg,
       entidade.fantasia,
       entidade.indiedest,
       entidade.inscsuframa,
       entidade.nomemae,
       entidade.nomepai,
       entidade.rg,
       entidade.rural,
       entidade.site,
       entidade.tipofavorecido,
       entidade.uf_rg,
       entidade.nit,
	   endereco.bairro,
       endereco.cep,       
       endereco.codigoibge,
       endereco.complemento,
       endereco.logradouro,
       endereco.municipio,
       endereco.numero,
       endereco.tipo,
       endereco.tipo_logradouro,
       endereco.uf,
       endereco.tipo_logradouro_item,
       endereco.pais,
       (select max(f.prefixo)  from public.telefone as f where f.chv_enti = entidade.chv_enti ) as ddd,
       (select max(f.telefone) from public.telefone as f where f.chv_enti = entidade.chv_enti ) as telefone
 
  FROM public.socio left outer join public.entidade
                                    on socio.chv_socio like '%'||entidade.chv_enti||'%'
					left outer join public.endereco
                                    on endereco.chv_enti = entidade.chv_enti			
 where entidade.nome is not null
 order by entidade.nome