DECLARE @retorno nvarchar(500)
DECLARE @query NVARCHAR(max)

SET @retorno = (Select top 1 TABLE_SCHEMA from INFORMATION_SCHEMA.TABLES)
set @query = concat('SELECT 
    empresa.numemp,
	empresa.codfil,
	empresa.razsoc,
	empresa.nomfil,
	empresa.atvfil,
	empresa.cplfil,
	empresa.tiplgr,
	empresa.endfil,
	empresa.endnum,
	empresa.codpai,
	empresa.codest,
	empresa.codcid,
	cidades.nomcid,
	cidades.estcid,
	empresa.codbai,
	bairros.nombai,
	empresa.codcep,
	empresa.tipfil,
	empresa.recfgt,
	empresa.cenfgt,
	empresa.catfgt,
	empresa.cdrfgt,
	empresa.natest,
	empresa.tipins,
    CASE 
        WHEN LEN(empresa.numcgc) < 11 THEN REPLICATE(''0'', 11 - LEN(empresa.numcgc)) 
        ELSE '''' 
    END + RTRIM(empresa.numcgc) AS numcgc,
	empresa.inscei,
	empresa.empfgt,
	empresa.insest,
	empresa.atiirf,
	empresa.atirai,
	empresa.banfgt,
	empresa.agefgt,
	empresa.codban,
	empresa.codage,
	empresa.conban,
	empresa.digban,
	empresa.motcgc,
	empresa.protra,
	empresa.famtra,
	empresa.filctb,
	empresa.iniatv,
	empresa.encatv,
	empresa.mudend,
	empresa.mudcgc,
	empresa.ultfic,
	empresa.tabfed,
	empresa.tabfen,
	empresa.ferofd,
	empresa.ferofn,
	empresa.banpis,
	empresa.acvpis,
	empresa.aalpis,
	empresa.motenc,
	empresa.cgcant,
	empresa.regdrt,
	empresa.numtel,
	empresa.numfax,
	empresa.autext,
	empresa.fechex,
	empresa.limhex,
	empresa.empcra,
	empresa.viacra,
	empresa.emppro,
	empresa.viapro,
	empresa.graris,
	empresa.emppcm,
	empresa.tipres,
	empresa.cadres,
	empresa.empfpd,
	empresa.codoem,
	empresa.emafil,
	empresa.codsvr,
	empresa.persen,
	empresa.junhor,
	empresa.encprv,
	empresa.parpat,
	empresa.datcna,
	empresa.emplau,
	empresa.tiplau,
	empresa.cadlau,
	empresa.emprrh,
	empresa.tiprrh,
	empresa.cadrrh,
	empresa.sitorc,
	empresa.codidn,
	empresa.dataex,
	empresa.tpctba,
	empresa.nomcom,
	empresa.empppp,
	empresa.tipppp,
	empresa.cadppp,
	empresa.cgccsi,
	empresa.filsin,
	empresa.ctlfic,
	empresa.ctlfil,
	empresa.cnapre,
	empresa.gerces,
	empresa.jusexa,
	empresa.juscat,
	empresa.jusass,
    REPLACE(REPLACE(empresa.jusger, CHAR(13), ''''), CHAR(10), '''') AS jusger,
	empresa.dddtel,
	empresa.dditel,
	empresa.dddfax,
	empresa.ddifax,
	empresa.numseg,
	empresa.insmun,
	empresa.tabeve,
	empresa.banhor,
	empresa.banfix,
	empresa.mesper,
	empresa.inivig,
	empresa.fimvig,
	empresa.blqadm,
	empresa.cgcbdc,
	empresa.cpfbdc,
	empresa.lotbdc,
	empresa.logbdc,
	empresa.senbdc,
	empresa.numcno,
	empresa.ncaepf,
	empresa.tiplot,
	empresa.cnafis,
	empresa.tipcae,
	empresa.pgmdsr,
	empresa.insmun,
	emp.eschor
FROM ', @retorno, '.R030FIL empresa
LEFT OUTER JOIN ', @retorno, '.R074CID cidades ON empresa.codcid = cidades.codcid
LEFT OUTER JOIN ', @retorno, '.R074BAI bairros ON empresa.codcid = bairros.codcid AND empresa.codbai = bairros.codbai
LEFT OUTER JOIN ', @retorno, '.R030EMP emp ON emp.numemp = empresa.numemp
ORDER BY empresa.NUMEMP, empresa.CODFIL;')
exec(@query)