SELECT HES.*,
	(SELECT max(EST.ENDLOGRADOURO) FROM EST WHERE HES.EST_CODIGO = EST.CODIGO AND HES.EMP_CODIGO = EST.EMP_CODIGO) AS ENDLOGRADOURO,
	(SELECT max(EST.ENDNUMERO) FROM EST WHERE HES.EST_CODIGO = EST.CODIGO AND HES.EMP_CODIGO = EST.EMP_CODIGO) AS ENDNUMERO,
	(SELECT max(EST.ENDCOMPLEMENTO) FROM EST WHERE HES.EST_CODIGO = EST.CODIGO AND HES.EMP_CODIGO = EST.EMP_CODIGO) AS ENDCOMPLEMENTO,
	(SELECT max(EST.BAIRRO) FROM EST WHERE HES.EST_CODIGO = EST.CODIGO AND HES.EMP_CODIGO = EST.EMP_CODIGO) AS BAIRRO,
	(SELECT max(EST.CEP) FROM EST WHERE HES.EST_CODIGO = EST.CODIGO AND HES.EMP_CODIGO = EST.EMP_CODIGO) AS CEP,
	(SELECT max(EST.MUN_UFD_SIGLA) FROM EST WHERE HES.EST_CODIGO = EST.CODIGO AND HES.EMP_CODIGO = EST.EMP_CODIGO) AS MUN_UFD_SIGLA,
	(SELECT max(MUN.NOME) FROM MUN inner join EST on MUN.CODIGO = EST.MUN_CODIGO AND MUN.UFD_SIGLA = EST.MUN_UFD_SIGLA and HES.EMP_CODIGO = EST.EMP_CODIGO) AS CIDADE,
	(SELECT max(EST.DDD) FROM EST WHERE HES.EST_CODIGO = EST.CODIGO AND HES.EMP_CODIGO = EST.EMP_CODIGO) AS DDD,
	(SELECT max(EST.FONE) FROM EST WHERE HES.EST_CODIGO = EST.CODIGO AND HES.EMP_CODIGO = EST.EMP_CODIGO) AS FONE
FROM HES
ORDER BY HES.EMP_CODIGO, HES.EST_Codigo, HES.DATA