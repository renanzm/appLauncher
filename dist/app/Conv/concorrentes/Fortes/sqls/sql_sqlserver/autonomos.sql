SELECT AUT.EMP_CODIGO,
	AUT.CODIGO,
	AUT.NOME,
	AUT.CATEGORIA,
	AUT.CPF,
	AUT.INSCRINSS,
	AUT.IM,
	AUT.IDENTIDADENUMERO,
	AUT.IDENTIDADEORGAOEXPEDIDOR,
	AUT.CBO_CODIGO,
	AUT.ALIQISS,
	AUT.IRRFDEPENDENTES,
	AUT.IRRFOUTRASDEDUCOES,
	AUT.EXPAGENOCIV,
	AUT.ENDLOGRADOURO,
	AUT.ENDNUMERO,
	AUT.ENDCOMPLEMENTO,
	AUT.BAIRRO,
	AUT.CEP,
	AUT.MUN_UFD_SIGLA,
	AUT.MUN_CODIGO,
	(SELECT max(MUN.NOME) FROM MUN WHERE MUN.CODIGO = AUT.MUN_Codigo) AS END_CIDADE,
	AUT.AGE_BAN_CODIGO,
	AUT.AGE_CODIGO,
	AUT.CONTACORRENTENUMERO,
	AUT.CONTACORRENTE,
	AUT.CONTASALARIO,
	AUT.OUTROSDESC,
	AUT.TRANSPORTADORPASSAGEIROS,
	AUT.TITULOELEITOR,
	AUT.DTNASCIMENTO,
	AUT.CATEGORIAESOCIAL,
	AUT.QUALIFICADO,
	(SELECT MIN(PAT.DTPAGAMENTO) FROM PAT WHERE PAT.EMP_CODIGO = AUT.EMP_CODIGO AND PAT.AUT_CODIGO = AUT.CODIGO AND PAT.DTPAGAMENTO <= (SELECT MIN(PAT.DTPAGAMENTO) FROM PAT WHERE PAT.EMP_CODIGO = AUT.EMP_CODIGO AND PAT.AUT_CODIGO = AUT.CODIGO)) AS ADMISSAO,
	(SELECT MAX(PAT.EST_CODIGO) FROM PAT WHERE PAT.EMP_CODIGO = AUT.EMP_CODIGO AND PAT.AUT_CODIGO = AUT.CODIGO AND PAT.DTPAGAMENTO >= (SELECT MAX(PAT.DTPAGAMENTO) FROM PAT WHERE PAT.EMP_CODIGO = AUT.EMP_CODIGO AND PAT.AUT_CODIGO = AUT.CODIGO)) AS EST_CODIGO,
	(SELECT MAX(PAT.TOM_CODIGO) FROM PAT WHERE PAT.EMP_CODIGO = AUT.EMP_CODIGO AND PAT.AUT_CODIGO = AUT.CODIGO AND PAT.DTPAGAMENTO >= (SELECT MAX(PAT.DTPAGAMENTO) FROM PAT WHERE PAT.EMP_CODIGO = AUT.EMP_CODIGO AND PAT.AUT_CODIGO = AUT.CODIGO)) AS TOM_CODIGO,
	(SELECT MAX(PAT.LOT_CODIGO) FROM PAT WHERE PAT.EMP_CODIGO = AUT.EMP_CODIGO AND PAT.AUT_CODIGO = AUT.CODIGO AND PAT.DTPAGAMENTO >= (SELECT MAX(PAT.DTPAGAMENTO) FROM PAT WHERE PAT.EMP_CODIGO = AUT.EMP_CODIGO AND PAT.AUT_CODIGO = AUT.CODIGO)) AS LOT_CODIGO,
	(SELECT MAX(PAT.VALORSERVICO) FROM PAT WHERE PAT.EMP_CODIGO = AUT.EMP_CODIGO AND PAT.AUT_CODIGO = AUT.CODIGO AND PAT.DTPAGAMENTO >= (SELECT MAX(PAT.DTPAGAMENTO) FROM PAT WHERE PAT.EMP_CODIGO = AUT.EMP_CODIGO AND PAT.AUT_CODIGO = AUT.CODIGO)) AS SALARIO
FROM AUT
ORDER BY AUT.EMP_CODIGO, AUT.CODIGO