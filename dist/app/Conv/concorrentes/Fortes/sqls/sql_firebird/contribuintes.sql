SELECT EPR.EMP_CODIGO,
	EPR.CODIGO,
	EPR.NOME,
	EPR.CPF,
	EPR.CI,
	EPR.IND_CODIGO_SALARIO,
	EPR.IND_QTDE,
	EPR.SALTIPO,
	EPR.VALORBRUTO,
	CASE EPR.SALTIPO 
	WHEN 'I' THEN COALESCE((SELECT VID.valor FROM VID WHERE VID.IND_CODIGO = EPR.IND_CODIGO_SALARIO AND VID.DATA = (SELECT MAX(V.DATA) FROM VID V WHERE V.IND_CODIGO = VID.IND_CODIGO  AND V.DATA <= EPR.DTRECEBIMENTO)),0)
	ELSE EPR.VALORBRUTO END AS SALARIO,
	EPR.DTRECEBIMENTO,
	EPR.EXPAGENOCIV,
	EPR.EST_CODIGO,
	EPR.CBO_CODIGO,
	EPR.ENDLOGRADOURO,
	EPR.ENDNUMERO,
	EPR.ENDCOMPLEMENTO,
	EPR.BAIRRO,
	EPR.CEP,
	EPR.MUN_UFD_SIGLA,
	EPR.MUN_CODIGO,
	(SELECT max(MUN.NOME) FROM MUN WHERE MUN.CODIGO = EPR.MUN_Codigo) AS END_CIDADE,
	EPR.DIA,
	EPR.MES,
	EPR.OUTROSVALORESINSS,
	EPR.PENSAO,
	EPR.DEPENDENTES,
	EPR.OUTRAS,
	EPR.CATEGORIA,
	EPR.DTNASCIMENTO,
	EPR.FGTSDTOPCAO,
	EPR.CALCULAPAGAMENTOS,
	EPR.TOM_CODIGO,
	EPR.AGE_BAN_CODIGO,
	EPR.AGE_CODIGO,
	EPR.CONTACORRENTENUMERO,
	EPR.CONTACORRENTE,
	EPR.CONTASALARIO,
	EPR.LOT_CODIGO,
	EPR.ANOMESDESLIGAMENTO,
	EPR.CES_CODIGO,
	EPR.TITULOELEITOR,
	EPR.OUTROSDESCONTOS,
	EPR.OUTROSPROVENTOS
FROM EPR
WHERE EPR.CPF NOT IN (SELECT EPG.CPF FROM EPG WHERE EPG.NOME = EPR.NOME AND EPG.EMP_CODIGO = EPR.EMP_CODIGO)
ORDER BY EPR.EMP_CODIGO, CODIGO